<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Mr. Kin&#39;s Blog</title>
  <icon>https://mister-kin.github.io/images-public/favicon/logo.svg</icon>
  <subtitle>计算机知识分享/软件应用讲解</subtitle>
  <link href="https://mister-kin.github.io/atom.xml" rel="self"/>
  
  <link href="https://mister-kin.github.io/"/>
  <updated>2025-12-15T06:13:36.000Z</updated>
  <id>https://mister-kin.github.io/</id>
  
  <author>
    <name>Mr. Kin</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>虚幻引擎总结</title>
    <link href="https://mister-kin.github.io/code/ue/"/>
    <id>https://mister-kin.github.io/code/ue/</id>
    <published>2025-12-14T19:03:18.000Z</published>
    <updated>2025-12-15T06:13:36.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="环境配置">1 &nbsp&nbsp<a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h1><h2 id="为虚幻引擎设置VS-Code">1.1 &nbsp&nbsp<a href="#为虚幻引擎设置VS-Code" class="headerlink" title="为虚幻引擎设置VS Code"></a>为虚幻引擎设置VS Code</h2><ol><li>安装<a href="https://code.visualstudio.com/Download">VSCode</a>并安装<a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.cpptools-extension-pack">C&#x2F;C++扩展包</a>和<a href="https://marketplace.visualstudio.com/items?itemName=ms-dotnettools.csharp">C#扩展</a>。</li><li>安装及配置<a href="https://visualstudio.microsoft.com/zh-hans/downloads/">Microsoft Visual C++ (MSVC)编译器工具集</a>。详细参阅「<a href="/code/vscode/#MSVC-CL%E7%BC%96%E8%AF%91%E5%99%A8%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E7%8E%AF%E5%A2%83%E8%AE%BE%E7%BD%AE">MSVC-CL编译器的安装和环境设置</a>」。</li><li>打开虚幻编辑器新建一个项目（项目名仅使用英文，别用中文，否则编译报错）</li><li>生成VS Code工作区：首次默认生成的是Visual Studio项目<code>.sln</code>，生成VSCode工作区之后，可以删除sln。<ul><li>方式一：打开虚幻编辑器（Unreal Editor）-&gt;工具（Tools）-&gt;刷新Visual Studio Code项目（Refresh Visual Studio Code Project）。</li><li>方式二：在Windows和Mac上，右键点击项目的.uproject文件并点击生成项目文件（Generate Project Files）。项目根目录会生成一个.code-workspace文件。</li><li>方式三：在命令行中，运行<code>GenerateProjectFiles.bat -vscode</code>。添加<code>-vscode</code>参数将创建<code>.vscode</code>工作区而不是Visual Studio <code>.sln</code>。使用此方法，则不需要更改默认源代码编辑器。</li></ul></li><li>VS Code设置为UE的默认IDE：打开虚幻编辑器（Unreal Editor）并转至编辑（Edit）-&gt;编辑器偏好设置（Editor Preferences）-&gt;通用（General）-&gt;源代码（Source Code）-&gt;源代码编辑器（Source Code Editor）-&gt;Visual Studio Code。重启编辑器，使更改生效。</li></ol><h2 id="为VS-Code设置IntelliSense、编译和启动项目">1.2 &nbsp&nbsp<a href="#为VS-Code设置IntelliSense、编译和启动项目" class="headerlink" title="为VS Code设置IntelliSense、编译和启动项目"></a>为VS Code设置IntelliSense、编译和启动项目</h2><p>编辑<code>.vscode/c_cpp_properties.json</code>，IntelliSense将提供代码提示，包括上下文相关的自动完成功能。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;configurations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CustomGame Editor Win64 Development&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;intelliSenseMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;msvc-x64&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;compileCommands&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;cStandard&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c17&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;cppStandard&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c++17&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="comment">// 添加如下incluePath路径</span></span><br><span class="line"><span class="attr">&quot;includePath&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"><span class="string">&quot;$&#123;workspaceFolder&#125;\\Intermediate\\**&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;$&#123;workspaceFolder&#125;\\Plugins\\**&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;$&#123;workspaceFolder&#125;\\Source\\**&quot;</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;defines&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"><span class="string">&quot;UNICODE&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;_UNICODE&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;__UNREAL__&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;UBT_COMPILED_PLATFORM=Windows&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;WITH_ENGINE=1&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;WITH_UNREAL_DEVELOPER_TOOLS=1&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;WITH_APPLICATION_CORE=1&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;WITH_COREUOBJECT=1&quot;</span></span><br><span class="line"><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;version&quot;</span><span class="punctuation">:</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>从VSCode编译启动项目：</p><ol><li>点击播放按钮选项卡或按<code>CTRL+SHIFT+D</code>，打开<code>运行和调试（Run and Debug）面板</code>。</li><li>点击面板顶部<code>运行和调试（RUN AND DEBUG）</code>旁边的下拉菜单，选择项目的开发编辑器（Development Editor）配置。<ul><li>例如项目名为<code>Test</code>， 选择启动<code>Launch TestEditor (Development) (工作区)） </code></li></ul></li><li>点击播放（Play）按钮或按F5，开始在编辑器模式下编译项目。项目将编译，完成后将打开虚幻编辑器。确保此时尚未打开虚幻编辑器，否则会编程多开UE编辑器。</li></ol><h1 id="UE编辑器设置修改">2 &nbsp&nbsp<a href="#UE编辑器设置修改" class="headerlink" title="UE编辑器设置修改"></a>UE编辑器设置修改</h1><h2 id="编译着色器的线程数量">2.1 &nbsp&nbsp<a href="#编译着色器的线程数量" class="headerlink" title="编译着色器的线程数量"></a>编译着色器的线程数量</h2><p>修改<code>UE_5.7\Engine\Config\BaseEngine.ini</code>文件：这三项中取最小值</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; 以下假设CPU最大逻辑处理器数量为32</span></span><br><span class="line"><span class="attr">NumUnusedShaderCompilingThreads</span>=<span class="number">3</span> <span class="comment">; 未使用的着色器编译线程数量，即32-3=29，建议设置为0</span></span><br><span class="line"><span class="attr">ShaderCompilerCoreCountThreshold</span>=<span class="number">12</span> <span class="comment">; 着色器编译器核心数量阈值，即12，按实际需求设置</span></span><br><span class="line"><span class="attr">PercentageUnusedShaderCompilingThreads</span>=<span class="number">50</span> <span class="comment">; 未使用的着色器编译线程百分比，32*0.5=16，建议设置为0</span></span><br></pre></td></tr></table></figure><h1 id="参考文献">3 &nbsp&nbsp<a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p>[1] 为虚幻引擎设置VS Code[EB&#x2F;OL]. <a href="https://dev.epicgames.com/documentation/zh-cn/unreal-engine/setting-up-visual-studio-code-for-unreal-engine">https://dev.epicgames.com/documentation/zh-cn/unreal-engine/setting-up-visual-studio-code-for-unreal-engine</a>.</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h1 id=&quot;环境配置&quot;&gt;1 &amp;nbsp&amp;nbsp&lt;a href=&quot;#环境配置&quot; class=&quot;headerlink&quot; title=&quot;环境配置&quot;&gt;&lt;/a&gt;环境配置&lt;/h1&gt;&lt;h2 id=&quot;为虚幻引擎设置VS-Code&quot;&gt;1.1 &amp;nbsp&amp;nbsp&lt;a</summary>
        
      
    
    
    
    <category term="code" scheme="https://mister-kin.github.io/categories/code/"/>
    
    
    <category term="总结" scheme="https://mister-kin.github.io/tags/%E6%80%BB%E7%BB%93/"/>
    
    <category term="虚幻引擎" scheme="https://mister-kin.github.io/tags/%E8%99%9A%E5%B9%BB%E5%BC%95%E6%93%8E/"/>
    
    <category term="UE" scheme="https://mister-kin.github.io/tags/UE/"/>
    
    <category term="unreal engine" scheme="https://mister-kin.github.io/tags/unreal-engine/"/>
    
    <category term="游戏引擎" scheme="https://mister-kin.github.io/tags/%E6%B8%B8%E6%88%8F%E5%BC%95%E6%93%8E/"/>
    
    <category term="游戏开发" scheme="https://mister-kin.github.io/tags/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>前端（HTML/CSS/JavaScript/VUE等）</title>
    <link href="https://mister-kin.github.io/code/frontend/"/>
    <id>https://mister-kin.github.io/code/frontend/</id>
    <published>2025-12-11T23:18:21.000Z</published>
    <updated>2026-01-07T17:32:41.000Z</updated>
    
    <content type="html"><![CDATA[<ul><li>HTML实现页面结构，CSS实现装扮，JavaScript实现功能。</li><li>服务端渲染（SSR）典型代表：ASPX, PHP, Next.js</li><li>客户端渲染（CSR）典型代表：Vue, React</li></ul><h1 id="HTML">1 &nbsp&nbsp<a href="#HTML" class="headerlink" title="HTML"></a>HTML</h1><ul><li>超链接锚点：<code>xxx.html#xxx</code>，锚点可以写于<code>.html</code>后缀名之后</li></ul><h1 id="CSS">2 &nbsp&nbsp<a href="#CSS" class="headerlink" title="CSS"></a>CSS</h1><ul><li>类名含有空格（浏览器F12检查元素）时，一般是包含多个类名，空格字符在类型中无效，实际上呈现出来的是分隔符，不是空格。CSS类名选择器一般选择第一个即可。</li></ul><h2 id="伪类的content不能被选中">2.1 &nbsp&nbsp<a href="#伪类的content不能被选中" class="headerlink" title="伪类的content不能被选中"></a>伪类的content不能被选中</h2><p>伪类不是真正的DOM，无DOM相关的属性和方法。</p><p><code>::before</code>和<code>::after</code>伪类的说明：</p><ul><li>默认display: inline</li><li>必须设置content属性，否则一切都是无用功</li><li>默认user-select: none，就是::before和::after的内容无法被用户选中的</li></ul><h1 id="Nginx">3 &nbsp&nbsp<a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h1><h1 id="参考文献">4 &nbsp&nbsp<a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p>[1] CSS 魔法堂：一起玩透伪元素和 Content 属性[EB&#x2F;OL]. <a href="https://segmentfault.com/a/1190000016441049">https://segmentfault.com/a/1190000016441049</a>.</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;ul&gt;
&lt;li&gt;HTML实现页面结构，CSS实现装扮，JavaScript实现功能。&lt;/li&gt;
&lt;li&gt;服务端渲染（SSR）典型代表：ASPX, PHP, Next.js&lt;/li&gt;
&lt;li&gt;客户端渲染（CSR）典型代表：Vue, React&lt;/li&gt;
&lt;/ul&gt;
&lt;h1</summary>
        
      
    
    
    
    <category term="code" scheme="https://mister-kin.github.io/categories/code/"/>
    
    
    <category term="总结" scheme="https://mister-kin.github.io/tags/%E6%80%BB%E7%BB%93/"/>
    
    <category term="笔记" scheme="https://mister-kin.github.io/tags/%E7%AC%94%E8%AE%B0/"/>
    
    <category term="css" scheme="https://mister-kin.github.io/tags/css/"/>
    
  </entry>
  
  <entry>
    <title>飞牛fnOS | 飞牛影视刮削的文件命名技巧V2</title>
    <link href="https://mister-kin.github.io/post-articles/2025-12/video-scraping-renaming-for-fnos-v2/"/>
    <id>https://mister-kin.github.io/post-articles/2025-12/video-scraping-renaming-for-fnos-v2/</id>
    <published>2025-12-11T10:32:21.000Z</published>
    <updated>2025-12-11T11:37:30.000Z</updated>
    
    <content type="html"><![CDATA[<p>重新对飞牛影视的刮削数据功能进行探索后，我发现有必要对前段时间写的《<a href="/post-articles/2025-10/video-scraping-renaming-for-fnos">飞牛fnOS影视刮削的文件命名技巧</a>》一文进行修正。</p><p>此次更新主要修改动画番剧与<code>OVA/OAD</code>的命名规则及飞牛影视刮削数据源的内容，在此说明修订情况，并分享第二版文章，欢迎各位朋友阅读指正。</p><p><strong>同时重新解答第一版文章评论区的一个问题：进击的巨人的八个OAD的命名匹配规则，详细参阅文章末尾。</strong></p><h1 id="前言">1 &nbsp&nbsp<a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>飞牛影视的数据刮削功能整体上算是省心，尤其是针对电影这种单个文件之类的影视，即使不手动修正文件名也基本不影响刮削效果。</p><p>但针对动漫番剧及包含OVA特别篇这种多季多集的影视，刮削数据匹配逻辑上还是需要一定的命名技巧才行，否则识别结果匹配容易错乱。</p><h1 id="影视刮削的文件命名规则">2 &nbsp&nbsp<a href="#影视刮削的文件命名规则" class="headerlink" title="影视刮削的文件命名规则"></a>影视刮削的文件命名规则</h1><p><strong>以下规则不仅适用于飞牛影视，基础规则同样可应用于Emby、Jellyfin等媒体系统工具。</strong></p><h2 id="电影类型">2.1 &nbsp&nbsp<a href="#电影类型" class="headerlink" title="电影类型"></a>电影类型</h2><p>一般电影本身就是单个文件，文件命名规则：影视名称+年份。示例：<code>星际穿越Interstellar.2014.mkv</code>。</p><p>像这样保留原有的电影名称和对应年份时，即使遇到同名的电影，刮削也基本不会出现问题。</p><h2 id="动漫番剧和电视剧类型">2.2 &nbsp&nbsp<a href="#动漫番剧和电视剧类型" class="headerlink" title="动漫番剧和电视剧类型"></a>动漫番剧和电视剧类型</h2><p>动漫番剧和电视剧，这种可能存在多季多集的情况，推荐按<code>季</code>分别创建一个文件夹存放每一季的文件。</p><p>文件命名规则：影视名称+对应的每季每集。示例<code>夏目友人帐.S01.E01.mkv</code>或者<code>夏目友人帐.S01E01.mkv</code>。父文件夹命名为：<code>夏目友人帐.S01</code>。</p><p>我个人是喜欢使用<code>.</code>符号作为分隔符，方便快速阅览辨识。</p><h2 id="动漫番剧的特别篇">2.3 &nbsp&nbsp<a href="#动漫番剧的特别篇" class="headerlink" title="动漫番剧的特别篇"></a>动漫番剧的特别篇</h2><p>特别篇比较特殊，基本都是需要人工查询复核具体对应的集数。</p><p>为什么这么说呢？这里首先要理解飞牛影视刮削数据来源主要是TMDB，而TMDB网站对于特别篇的整理基本都是统一整合在一个季中，包括各类衍生短篇或者小视频。TMDB数据源将所有特别篇的一整季视为第零季，这点和IMDB数据源有所不同，IMDB数据源有时候会将特别篇作为某一季的最后一集顺延+1编号，例如<code>夏目友人帐</code>的OVA特别篇。</p><p>因此针对<code>SP</code>、<code>OVA</code>、<code>OAD</code>这类特别篇就没有一个泛用性的规则可言，只能根据番剧去TMDB网站查询数据确定具体剧集。</p><p>TMDB数据源网站：<code>https://www.themoviedb.org/</code></p><div class="flex-column"><img data-src="/images/post-articles/2025-12/video-scraping-renaming-for-fnos-v2/scraping-sources.webp">飞牛影视的刮削数据来源</div><div class="flex-row"><div class="flex-column"><img data-src="/images/post-articles/2025-12/video-scraping-renaming-for-fnos-v2/difference-of-tmdb.webp">TMDB数据源的《夏目友人帐 S5 OVA》</div><div class="flex-column"><img data-src="/images/post-articles/2025-12/video-scraping-renaming-for-fnos-v2/difference-of-imdb.webp">IMDB数据源的《夏目友人帐 S5 OVA》</div></div><p>下面以两种特别篇的情况作为示例讲解如何命名文件，示例截图均为飞牛影视自动刮削的结果，并无人工匹配动作干预。</p><h3 id="特别篇只有一集的情况">2.3.1 &nbsp&nbsp<a href="#特别篇只有一集的情况" class="headerlink" title="特别篇只有一集的情况"></a>特别篇只有一集的情况</h3><p>特别篇只有一集的话，这种情况处理很简单，直接在番剧名称后添加<code>S00.E01</code>后缀即可，即代表<code>第零季第一集</code>，示例<code>紫罗兰永恒花园.S00.E01.mp4</code>或者<code>紫罗兰永恒花园.S00.E01.OVA.一定会理解「爱」的真谛.mp4</code></p><p>对应的TMDB数据源页面链接：<code>https://www.themoviedb.org/tv/75214-violet-evergarden/season/0</code></p><div class="flex-column"><img data-src="/images/post-articles/2025-12/video-scraping-renaming-for-fnos-v2/voilet-sp-details.webp">紫罗兰永恒花园-特别篇详情</div><h3 id="特别篇存在多集的情况">2.3.2 &nbsp&nbsp<a href="#特别篇存在多集的情况" class="headerlink" title="特别篇存在多集的情况"></a>特别篇存在多集的情况</h3><p>特别篇存在多集的话，这种情况比较复杂，没有通用规则可以直接用于命名，就比如<code>OVA1</code>并不一定就是对应<code>S00.E01</code>，只能人工查看网站数据，根据对应的集数进行命名。建议同时创建一个<code>S00</code>名称的文件夹存放管理所有特别篇的媒体文件。</p><p>示例：《夏目友人帐》特别篇OVA。原则上仅需<code>S00.Exx</code>标识符即可，后面的中文注释添加与否，并不影响匹配结果。注意中文注释不要使用<code>第X季</code>字眼，避免干扰刮削识别。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">夏目友人帐.S00.E06.OVA1.和猫咪老师的第一次跑腿.mkv</span><br><span class="line">夏目友人帐.S00.E07.OVA2.曾几何时下雪之日.mkv</span><br><span class="line">夏目友人帐.S00.E08.OVA1.一夜酒杯.mkv</span><br><span class="line">夏目友人帐.S00.E09.OVA2.游戏之宴.mkv</span><br><span class="line">夏目友人帐.S00.E10.OVA1.铃响的残株.mkv</span><br><span class="line">夏目友人帐.S00.E11.OVA2.梦幻的碎片.mkv</span><br><span class="line">夏目友人帐.S00.E14.OVA.伸手可及的地方.mkv</span><br></pre></td></tr></table></figure><p>对应的TMDB数据源页面链接：<code>https://www.themoviedb.org/tv/69500-natsume-yuujinchou/season/0</code></p><div class="flex-column"><img data-src="/images/post-articles/2025-12/video-scraping-renaming-for-fnos-v2/natsume-sp-detail.webp">夏目友人帐-特别篇详情</div><h2 id="外挂字幕文件类型">2.4 &nbsp&nbsp<a href="#外挂字幕文件类型" class="headerlink" title="外挂字幕文件类型"></a>外挂字幕文件类型</h2><p>文件命名规则：字幕文件名保持与视频文件同名，最后加上分隔符和字幕语言类型标识符。以下简单介绍几种语言类型标识符：</p><ul><li>简体中文：<code>chs</code>或者<code>sc</code>，例：<code>夏目友人帐.S01.E01.chs.ass</code></li><li>繁体中文：<code>cht</code>或者<code>tc</code>，示例：<code>夏目友人帐.S01.E01.cht.ass</code></li><li>日文：<code>jpn</code>或者<code>ja</code>，示例：<code>夏目友人帐.S01.E01.jap.ass</code></li><li>简中日文双语：示例：<code>夏目友人帐.S01.E01.chs&amp;jpn.ass</code></li></ul><p>注：在<code>ISO 639</code>语言代码标准中，<code>sc</code>代表<code>撒丁语Sardinian</code>，<code>tc</code>则是不存在，因此会被识别成<code>未定 (und)</code>。严格来说，<code>chs</code>和<code>cht</code>在<code>ISO 639</code>标准中也不存在。在<code>IETF BCP 47/RFC 5646</code>语言标签标准中，常用<code>zh-Hans</code>表示简体中文，常用<code>zh-Hant</code>表示繁体中文，这两个标签对应<code>ISO 639</code>代码均为<code>chi</code>。因此制作MKV视频文件时，需要注意字幕轨道名称和对应的标识语言代码（轨道名称是可以自定义任意字符）。</p><h1 id="批量重命名工具：PowerRename">3 &nbsp&nbsp<a href="#批量重命名工具：PowerRename" class="headerlink" title="批量重命名工具：PowerRename"></a>批量重命名工具：<code>PowerRename</code></h1><p>文件管理自然少不了文件重命名，这里推荐一个工具<code>PowerRename</code>，该工具支持正则表达式。该工具是<code>PowerToys</code>的内置工具，仅适用于Windows平台。</p><p>安装方法一：</p><ol><li>打开Windows系统的微软商店。</li><li>搜索安装<code>PowerToys</code></li><li>打开<code>PowerToys</code>界面并确保启用<code>PowerRename</code>，这样Windows中的右键菜单上下文就出现<code>PowerRename</code>选项了。</li></ol><div class="flex-row"><div class="flex-column"><img data-src="/images/post-articles/2025-10/video-scraping-renaming-for-fnos/powertoys.webp">微软商店界面-PowerToys</div><div class="flex-column"><img data-src="/images/post-articles/2025-10/video-scraping-renaming-for-fnos/powertoys-enable-powerrename.webp">PowerToys启用PowerRename</div></div><div class="flex-column"><img data-src="/images/post-articles/2025-10/video-scraping-renaming-for-fnos/right-click-menu.webp">右键菜单-PowerRename</div><p>安装方法二：下载<code>PowerToys</code>离线包手动安装。启用<code>PowerRename</code>步骤同方法一，不再赘述。</p><p>PowerToys最新版安装包下载链接（v0.96.1）：<code>https://github.com/microsoft/PowerToys/releases/download/v0.96.1/PowerToysSetup-0.96.1-x64.exe</code></p><h1 id="PowerRename的命名规则">4 &nbsp&nbsp<a href="#PowerRename的命名规则" class="headerlink" title="PowerRename的命名规则"></a>PowerRename的命名规则</h1><p>示例编码：<code>夏目友人帐.S05.E${increment=1,padding=2,start=1}</code>，示例图片中的<code>.*</code>是正则表达式，代表匹配所有任意字符。</p><p>这里简单介绍自动编号的规则：<code>${}</code>是属于高级计数器语法，<code>increment=1</code>代表每次增长1；<code>padding=2</code>代表自动使用前导零数填充为两位，例如数字1自动填充为<code>01</code>，当增长超过两位数时，例如三位数则不受限于该规则；<code>start=1</code>代表从1开始。</p><p>PowerRename的详细使用方法和语法规则可参阅：<code>https://learn.microsoft.com/zh-cn/windows/powertoys/powerrename</code></p><div class="flex-column"><img data-src="/images/post-articles/2025-10/video-scraping-renaming-for-fnos/powerraname.webp">PowerRename示例编码</div><h1 id="内容延伸：影视文件常见命名缩写含义">5 &nbsp&nbsp<a href="#内容延伸：影视文件常见命名缩写含义" class="headerlink" title="内容延伸：影视文件常见命名缩写含义"></a>内容延伸：影视文件常见命名缩写含义</h1><ul><li>S1: season1, 第一季</li><li>E1&#x2F;EP1: episode1, 第一集</li><li>SP: special, 特别篇</li><li>OVA: Original Video Animation, 原创动画录影带</li><li>OAD: Original Animation Disc, 原创动画光碟</li><li>OST: Original Soundtrack, 影视原声集</li><li>HD: Hign Definition, 高清</li><li>BD: Blu-ray Disc, 蓝光</li><li>X264&#x2F;HEVC: h264&#x2F;h265视频编码</li><li>AAC: 音频编码</li><li>CHS&#x2F;CHT&#x2F;JPN: 简体中文&#x2F;繁体中文&#x2F;日文</li><li>Director&#39;s Cut: 导演剪辑版</li><li>On Air: TV版（电视节目或者动画播出时的版本）</li><li>Unrated: 未分级版</li><li>Extended: 加长版</li></ul><h1 id="第一版文章评论区问题解答">6 &nbsp&nbsp<a href="#第一版文章评论区问题解答" class="headerlink" title="第一版文章评论区问题解答"></a>第一版文章评论区问题解答</h1><p>《进击的巨人》的八个OAD的命名匹配规则如下：完成文件命名之后，再传入飞牛影视即可完成自动刮削，无需人工匹配干预。</p><p>示例：《进击的巨人》特别篇OAD+最终季完结篇（根据TMDB数据源，最终季完结篇也属于特别篇）。原则上仅需<code>S00.Exx</code>标识符即可，后面的中文注释添加与否，并不影响匹配结果。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">进击的巨人.S00.E07.伊尔泽的笔记.mkv</span><br><span class="line">进击的巨人.S00.E13.突如其来的访客.mkv</span><br><span class="line">进击的巨人.S00.E14.困难.mkv</span><br><span class="line">进击的巨人.S00.E15.无悔的选择-前篇-.mkv</span><br><span class="line">进击的巨人.S00.E16.无悔的选择-后篇-.mkv</span><br><span class="line">进击的巨人.S00.E17.再见，希娜之墙-前篇-.mkv</span><br><span class="line">进击的巨人.S00.E18.再见，希娜之墙-后篇-.mkv</span><br><span class="line">进击的巨人.S00.E19.迷失在残酷的世界里.mkv</span><br><span class="line">进击的巨人.S00.E36.最终季 完结篇（前篇）.mkv</span><br><span class="line">进击的巨人.S00.E37.最终季 完结篇（后篇）.mkv</span><br></pre></td></tr></table></figure><p>或者使用如下版本，这个版本是我个人使用的版本，A标识符用于标记总集片的剧集。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">进击的巨人.S00.E07.A3.5.伊尔泽的笔记.mkv</span><br><span class="line">进击的巨人.S00.E13.A3.25.突如其来的访客.mkv</span><br><span class="line">进击的巨人.S00.E14.A3.75.困难.mkv</span><br><span class="line">进击的巨人.S00.E15.A0.5A.无悔的选择-前篇-.mkv</span><br><span class="line">进击的巨人.S00.E16.A0.5B.无悔的选择-后篇-.mkv</span><br><span class="line">进击的巨人.S00.E17.A16.5A.再见，希娜之墙-前篇-.mkv</span><br><span class="line">进击的巨人.S00.E18.A16.5B.再见，希娜之墙-后篇-.mkv</span><br><span class="line">进击的巨人.S00.E19.迷失在残酷的世界里.mkv</span><br><span class="line">进击的巨人.S00.E36.最终季 完结篇（前篇）.mkv</span><br><span class="line">进击的巨人.S00.E37.最终季 完结篇（后篇）.mkv</span><br></pre></td></tr></table></figure><p>对应的TMDB数据源页面链接：<code>https://www.themoviedb.org/tv/1429/season/0</code></p><div class="flex-column"><img data-src="/images/post-articles/2025-12/video-scraping-renaming-for-fnos-v2/kyojin-sp-details.webp">进击的巨人-特别篇详情</div><h1 id="参考文献">7 &nbsp&nbsp<a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p>[1] 万剑归宗之刮削大法！史上最全从Emby命名规则到刮削设置一条龙图文教程！[EB&#x2F;OL]. <a href="https://post.smzdm.com/p/aox8wp36/">https://post.smzdm.com/p/aox8wp36/</a>.<br>[2] 电影电视剧动漫 标准命名规则，jellfin、emby、kodi都适用[EB&#x2F;OL]. <a href="https://www.shejibiji.com/archives/8295">https://www.shejibiji.com/archives/8295</a>.<br>[3] 不知道飞牛影视刮削是直连TMDB和IMDB？[EB&#x2F;OL]. <a href="https://club.fnnas.com/forum.php?mod=viewthread&tid=32333">https://club.fnnas.com/forum.php?mod=viewthread&amp;tid=32333</a>.<br>[4] Tags for Identifying Languages[EB&#x2F;OL]. <a href="https://www.ietf.org/rfc/rfc4646.txt">https://www.ietf.org/rfc/rfc4646.txt</a>.<br>[5] ISO 639 Language code[EB&#x2F;OL]. <a href="https://www.iso.org/iso-639-language-code">https://www.iso.org/iso-639-language-code</a>.</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;重新对飞牛影视的刮削数据功能进行探索后，我发现有必要对前段时间写的《&lt;a</summary>
        
      
    
    
    
    <category term="post-articles" scheme="https://mister-kin.github.io/categories/post-articles/"/>
    
    <category term="2025-12" scheme="https://mister-kin.github.io/categories/post-articles/2025-12/"/>
    
    
    <category term="fnOS" scheme="https://mister-kin.github.io/tags/fnOS/"/>
    
    <category term="飞牛" scheme="https://mister-kin.github.io/tags/%E9%A3%9E%E7%89%9B/"/>
    
    <category term="影视刮削" scheme="https://mister-kin.github.io/tags/%E5%BD%B1%E8%A7%86%E5%88%AE%E5%89%8A/"/>
    
    <category term="命名规则" scheme="https://mister-kin.github.io/tags/%E5%91%BD%E5%90%8D%E8%A7%84%E5%88%99/"/>
    
    <category term="技巧" scheme="https://mister-kin.github.io/tags/%E6%8A%80%E5%B7%A7/"/>
    
    <category term="教程" scheme="https://mister-kin.github.io/tags/%E6%95%99%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>飞牛fnOS | 飞牛影视刮削数据滞后的问题</title>
    <link href="https://mister-kin.github.io/post-articles/2025-12/video-scraping-data-delay-problem-for-fnos/"/>
    <id>https://mister-kin.github.io/post-articles/2025-12/video-scraping-data-delay-problem-for-fnos/</id>
    <published>2025-12-07T07:11:23.000Z</published>
    <updated>2025-12-11T11:37:30.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="刮削数据滞后的现象">1 &nbsp&nbsp<a href="#刮削数据滞后的现象" class="headerlink" title="刮削数据滞后的现象"></a>刮削数据滞后的现象</h1><p>经常使用飞牛影视的朋友们，应该有遇到过无法刮削到新番剧或者新影视的媒体数据，数据刮削存在滞后性，也无法自动刷新。</p><p>例如下图的情况，这是在以往番剧放映时期导入的《盾之勇者成名录 S4》，在导入之际，飞牛影视没法抓取到对应最新集数的媒体数据和封面，甚至于个别集数的封面都无法从视频中截取生成。</p><div class="flex-column"><img data-src="/images/post-articles/2025-12/video-scraping-data-delay-problem-for-fnos/tate-lack-of-meta.webp">刮削不全的《盾之勇者成名录 S4》</div><h1 id="重新匹配以解决刮削不全的问题">2 &nbsp&nbsp<a href="#重新匹配以解决刮削不全的问题" class="headerlink" title="重新匹配以解决刮削不全的问题"></a>重新匹配以解决刮削不全的问题</h1><p>针对这种影视数据刮削滞后的情况，可以尝试重新匹配以解决刮削不全的问题。而重新匹配，一般有如下方式：</p><ul><li>方式一：手动匹配</li><li>方式二：将视频移出媒体库文件夹，等确认飞牛影视检测到对应影视资源不存在时，再重新移入视频。如果手动匹配时搜索不到正确的剧集时，建议是用此方法，让飞牛影视自动帮你重新匹配。这种方式虽然在回收站会产生文件记录，但几乎不会增加存储空间的文件占用，放心操作。</li><li>方式三：解除匹配，再重新匹配（这种方式跟方式一类似，原理是一样，只是多了一步解除匹配。一般推荐使用方式一即可）</li></ul><p>以下针对方式一的手动匹配进行详细说明：<br>步骤1：进入手动匹配影片模式。点击<code>···</code>按钮，然后点击「手动匹配影片」按钮。</p><div class="flex-column"><img data-src="/images/post-articles/2025-12/video-scraping-data-delay-problem-for-fnos/tate-rematch1.webp">步骤1：进入手动匹配影片模式</div><p>步骤2：输入「影视关键词」搜索。示例输入的是「盾之勇者成名录」，当然也可以通过TMDB和IMDB的ID来搜索。<strong>注意这个步骤比较重要，一定要进行一次搜索选择，否则没法实现重新匹配的效果。</strong></p><div class="flex-column"><img data-src="/images/post-articles/2025-12/video-scraping-data-delay-problem-for-fnos/tate-rematch2.webp">步骤2：输入「影视关键词」搜索</div><p>步骤3：选择正确的剧集。点击选中正确的剧集即可。</p><div class="flex-column"><img data-src="/images/post-articles/2025-12/video-scraping-data-delay-problem-for-fnos/tate-rematch3.webp">步骤3：选择正确的剧集</div><p>步骤4：输入正确的季集。示例输入的是4，然后确定即可完成重新匹配。<strong>如果只有一季的话，可以输入1或者留空，这种情况一般识别不会存在问题。</strong></p><div class="flex-column"><img data-src="/images/post-articles/2025-12/video-scraping-data-delay-problem-for-fnos/tate-rematch4.webp">步骤4：输入正确的季集</div><p>以下是重新匹配之后的效果，此时飞牛影视已从TMDB数据源中抓取到正确的媒体数据和封面。</p><div class="flex-column"><img data-src="/images/post-articles/2025-12/video-scraping-data-delay-problem-for-fnos/tate-scraping-well.webp">重新匹配之后的《盾之勇者成名录 S4》</div>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h1 id=&quot;刮削数据滞后的现象&quot;&gt;1 &amp;nbsp&amp;nbsp&lt;a href=&quot;#刮削数据滞后的现象&quot; class=&quot;headerlink&quot;</summary>
        
      
    
    
    
    <category term="post-articles" scheme="https://mister-kin.github.io/categories/post-articles/"/>
    
    <category term="2025-12" scheme="https://mister-kin.github.io/categories/post-articles/2025-12/"/>
    
    
    <category term="fnOS" scheme="https://mister-kin.github.io/tags/fnOS/"/>
    
    <category term="飞牛" scheme="https://mister-kin.github.io/tags/%E9%A3%9E%E7%89%9B/"/>
    
    <category term="影视刮削" scheme="https://mister-kin.github.io/tags/%E5%BD%B1%E8%A7%86%E5%88%AE%E5%89%8A/"/>
    
    <category term="数据滞后" scheme="https://mister-kin.github.io/tags/%E6%95%B0%E6%8D%AE%E6%BB%9E%E5%90%8E/"/>
    
    <category term="问题" scheme="https://mister-kin.github.io/tags/%E9%97%AE%E9%A2%98/"/>
    
    <category term="教程" scheme="https://mister-kin.github.io/tags/%E6%95%99%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>WinPE系统封装排障总结</title>
    <link href="https://mister-kin.github.io/troubleshooting/winpe-troubleshooting/"/>
    <id>https://mister-kin.github.io/troubleshooting/winpe-troubleshooting/</id>
    <published>2025-12-04T01:19:02.000Z</published>
    <updated>2025-12-31T06:30:43.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="安装系统">1 &nbsp&nbsp<a href="#安装系统" class="headerlink" title="安装系统"></a>安装系统</h1><h2 id="关于引导类型和分区表类型的组合选择">1.1 &nbsp&nbsp<a href="#关于引导类型和分区表类型的组合选择" class="headerlink" title="关于引导类型和分区表类型的组合选择"></a>关于引导类型和分区表类型的组合选择</h2><table><thead><tr><th align="left">引导类型和分区表类型</th><th align="left">Windows原生镜像安装器(Setup.exe)支持性</th><th align="left">技术细节分析</th><th align="left">适用场景</th></tr></thead><tbody><tr><td align="left">UEFI + GPT</td><td align="left">WinXP：不支持<br>WinVista&#x2F;7：仅64位版本支持<br>Win8&#x2F;8.1&#x2F;10&#x2F;11：支持</td><td align="left">主流的现代组合、Windows11推荐标准、UEFI引导的Win7激活需要特殊工具</td><td align="left">现代NVMe固态硬盘、2TB以上大硬盘</td></tr><tr><td align="left">Legacy BIOS + MBR</td><td align="left">WinXP&#x2F;Vista&#x2F;7&#x2F;8&#x2F;8.1&#x2F;10：支持<br>Win11：不支持(安装器会报错)</td><td align="left">最万能的组合。PE三方工具(WinNTSetup等)可破解Win11的GPT限制，几乎所有Windows都能以此模式运行。</td><td align="left">老旧电脑、2TB 以下机械硬盘、追求极致启动兼容性</td></tr><tr><td align="left">UEFI + MBR</td><td align="left">均不支持(UEFI引导下安装器只能安装系统在GPT)</td><td align="left">非标组合。这种组合通常称为“混合引导”。需要主板支持CSM兼容模块开启，或者设置成Legacy模式（传统模式）。部分三方工具支持将EFI引导文件写入MBR上的FAT32分区，例如应用在U盘和移动硬盘上实现双模式启动。</td><td align="left">极少数特定平板设备，或不想转换分区表但想试用UEFI的场景。<br>没有特殊需求，无需考虑这种形式，纯属瞎折腾，效果和BIOS+MBR没啥区别</td></tr><tr><td align="left">Legacy BIOS + GPT</td><td align="left">均不支持(BIOS引导下无法识别GPT磁盘作为启动项)</td><td align="left">极度少见。Windows安装器改成纯UEFI形式才支持安装Win10在GPT硬盘。但可以使用特殊的Bootloader（如Clover或Grub）实现引导或者虚拟化MBR分区表或者虚拟化UEFI引导器</td><td align="left">仅限技术极客在不支持UEFI的老机器上使用2TB以上硬盘做系统盘</td></tr></tbody></table><h2 id="Windows分区布局">1.2 &nbsp&nbsp<a href="#Windows分区布局" class="headerlink" title="Windows分区布局"></a>Windows分区布局</h2><p>参阅资料：<a href="https://learn.microsoft.com/zh-cn/windows-hardware/manufacture/desktop/configure-uefigpt-based-hard-drive-partitions">基于 UEFI&#x2F;GPT 的硬盘驱动器分区</a>和<a href="https://learn.microsoft.com/zh-cn/windows-hardware/manufacture/desktop/configure-biosmbr-based-hard-drive-partitions">基于 BIOS&#x2F;MBR 的硬盘驱动器分区</a></p><pre><code class="highlight mermaid">block    columns 5    T2[&quot;UEFI引导类型&quot;]:1    block:Row2:4        columns 4        S2[&quot;【System】系统分区&lt;br&gt;又称为EFI系统分区 (ESP)&lt;br&gt;文件系统格式：FAT32&lt;br&gt;&lt;br&gt;推荐容量为300MB&lt;br&gt;安装器自动分配容量100MB&lt;br&gt;导引文件占用30.8MB&quot;]        M2[&quot;【MSR】保留分区&lt;br&gt;文件系统格式：&lt;br&gt;Microsoft Reserved Partition&lt;br&gt;&lt;br&gt;推荐容量为16MB&lt;br&gt;安装器自动分配容量16MB&lt;br&gt;可帮助分区管理，如动态磁盘转换&lt;br&gt;无此需求不用创建&quot;]        W2[&quot;【Windows】分区&lt;br&gt;文件系统格式：NTFS&lt;br&gt;&lt;br&gt;diskpart创建分区容量推荐整数+1&lt;br&gt;例如200G：size=204801&lt;br&gt;避免文件资源管理器显示199GB&quot;]        R2[&quot;【Recovery】恢复工具分区&lt;br&gt;文件系统格式：NTFS(隐藏)&lt;br&gt;&lt;br&gt;安装器自动分配容量569MB&lt;br&gt;文件占用480MB&lt;br&gt;Windows安装器自动创建&lt;br&gt;手动安装无需创建该分区&quot;]    end    T1[&quot;LegacyBIOS引导类型&quot;]:1    block:Row1:3        columns 3        S1[&quot;【System】系统分区&lt;br&gt;文件系统格式：NTFS(隐藏)&lt;br&gt;推荐文件系统格式：FAT32&lt;br&gt;FAT32方便未来转纯UEFI环境&lt;br&gt;&lt;br&gt;推荐容量为100MB&lt;br&gt;安装器自动分配容量50MB&lt;br&gt;导引文件占用26.5MB&quot;]        W1[&quot;【Windows】分区&lt;br&gt;文件系统格式：NTFS&lt;br&gt;&lt;br&gt;可以和【System】合并一个分区&lt;br&gt;引导文件仍在分区根目录&lt;br&gt;&lt;br&gt;diskpart创建分区容量推荐整数+1&lt;br&gt;例如200G：size=204801&lt;br&gt;避免文件资源管理器显示199GB&quot;]        R1[&quot;【Recovery】恢复工具分区&lt;br&gt;文件系统格式：NTFS(隐藏)&lt;br&gt;&lt;br&gt;安装器自动分配容量569MB&lt;br&gt;文件占用480MB&lt;br&gt;Windows安装器自动创建&lt;br&gt;手动安装无需创建该分区&quot;]    end    style Row2 fill:#E8F5E9,stroke:#2E7D32,stroke-dasharray: 5 5    style Row1 fill:#E3F2FD,stroke:#1565C0,stroke-dasharray: 5 5    %% 样式定义：建议将样式直接应用到节点 ID，避免在 Row 定义中混淆    classDef cls_App fill:#E8F5E9,stroke:#2E7D32,stroke-width:1px,color:#000    classDef cls_Trans fill:#E3F2FD,stroke:#1565C0,stroke-width:1px,color:#000    classDef cls_Net fill:#FFF3E0,stroke:#EF6C00,stroke-width:1px,color:#000    classDef cls_Link fill:#F3E5F5,stroke:#7B1FA2,stroke-width:1px,color:#000    class S1,S2,T2 cls_App    class M1,T1 cls_Trans    class W1,W2 cls_Net    class R1,R2 cls_Link</code></pre><h2 id="GPT和MBR分区表类型">1.3 &nbsp&nbsp<a href="#GPT和MBR分区表类型" class="headerlink" title="GPT和MBR分区表类型"></a>GPT和MBR分区表类型</h2><p>参阅资料：<a href="https://learn.microsoft.com/zh-cn/windows-hardware/manufacture/desktop/hard-drives-and-partitions?view=windows-11">硬盘驱动器和分区</a></p><ul><li>GPT分区表类型<ul><li>最大支持的硬盘容量理论限制为9.4ZB（94亿TB），现实场景中可应用于所有硬盘。</li><li>单个GPT硬盘允许几乎无限数量的分区，但Windows将分区数量限制为不超过128个。</li><li>每个分区的空间最大可为18EB（1EB&#x3D;1024PB&#x3D;1048576TB）。</li></ul></li><li>MBR分区表类型<ul><li>最大能支持4TB的硬盘，需保证每个分区的容量和起始偏移量都不大于2TB。<ul><li>需要三方分区工具完成（例如DG）；Win自带的磁盘管理工具只能识别和操作最初始的2048GB容量的区域，剩余容量无法寻址。</li></ul></li><li>单个MBR硬盘最多包含4个主分区。</li><li>扩展分区有且仅有一个，可以包含多个逻辑分区，但逻辑分区不能用作引导卷，不过Windows分区可以使用逻辑分区</li><li>每个分区的空间最大可为2TB。</li><li>MBR（Master Boot Record，主引导记录）数据结构由引导代码（负责寻找活动分区）+分区表+结束标志构成，记录在硬盘的第一个物理扇区（柱面0，磁头0，扇区1），大小固定为512字节。</li><li>PBR（Partition Boot Record，分区引导记录）记录在每个分区的第一个扇区，任务是去寻找并加载该分区根目录下的操作系统引导文件。逻辑分区也有PBR，可以安装如Linux等非Windows系统。</li><li>MBR和PBR均以扇区数据存储，不是常见文件系统的文件形式，使用底层磁盘编辑工具（如WinHex）才能访问编辑。</li></ul></li></ul><h2 id="WinOS启动过程">1.4 &nbsp&nbsp<a href="#WinOS启动过程" class="headerlink" title="WinOS启动过程"></a>WinOS启动过程</h2><p>WinOS基本启动过程：主板BIOS上电自检-&gt;查找启动设备-&gt;在NVRAM中查找引导项（第一启动项）-&gt;引导程序（LegacyBIOS&#x2F;UEFI）-&gt;加载OS内核和驱动-&gt;OS取得控制权</p><ul><li>UEFI<ul><li>第一优先级：EFI系统分区（FAT32格式的ESP分区）-&gt;\EFI\Microsoft\Boot\bootmgfw.efi-&gt;\EFI\Microsoft\Boot\BCD（操作系统选择菜单，单系统默认不显示）-&gt;Windows分区-&gt;\Windows\system32\winload.efi，写入Windows Boot Manager启动项</li><li>第二优先级（第一优先级启动失败时Fallback兜底）：EFI系统分区（FAT32格式的ESP分区）-&gt;\EFI\Boot\bootx64.efi，这是UEFI的标准预设路径，写入硬盘启动项</li><li>延伸内容：安全启动则是支持对如下文件进行签名检查。<ul><li>bootmgfw.efi：Boot Manager Firmware，UEFI环境下Windows的正式引导管理器Windows Boot Manager，应用场景：正常主板开机引导。Windows中的备份路径：<code>C:\Windows\Boot\EFI\bootmgfw.efi</code></li><li>bootmgr.efi：Windows Boot Manager的变体，备用辅助的启动文件，兜底处理一些非标准的、复杂的或者兼容性的启动情况。应用场景：安装系统、修复系统或特殊引导时使用。Windows中的备份路径：<code>C:\Windows\Boot\EFI\bootmgr.efi</code><ul><li>情况1：从光盘&#x2F;U盘启动Windows安装盘，为了那些不完全准勋UEFI规范固件通过文件名找到引导，Windows的ISO镜像或者安装介质中，bootmgr.efi被放置在根目录</li><li>情况2：当bootmgfw.efi找不到时，作为备用替代</li><li>情况3：Legacy转UEFI的过渡，该文件是为了让旧有的bootmgr逻辑在UEFI环境下也能运行而设计的</li></ul></li></ul></li></ul></li><li>Legacy BIOS<ul><li>MBR主引导记录-&gt;<strong>激活</strong>的主分区-&gt;读取分区引导记录PBR-&gt;主分区根目录下的bootmgr或者ntldr文件-&gt;\Boot\BCD（操作系统选择菜单，单系统默认不显示）-&gt;Windows分区-&gt;\Windows\system32\winload.exe</li><li>延伸内容：<ul><li>激活主分区：DiskGenius可以查看到激活的主分区的NTFS或者FAT32的文字标识是红色，代表激活</li><li>bootmgr：NT6内核vista之后，Windows中的备份路径：<code>C:\Windows\Boot\PCAT\bootmgr</code>，bcdboot命令修复引导的拷贝路径</li><li>ntldr：NT5内核xp、2003、2000</li></ul></li></ul></li></ul><h2 id="BCD文件">1.5 &nbsp&nbsp<a href="#BCD文件" class="headerlink" title="BCD文件"></a>BCD文件</h2><p>BCD的路径：</p><ul><li><p>UEFI：EFI系统分区（FAT32格式的ESP分区）-&gt;\EFI\Microsoft\Boot\BCD</p></li><li><p>Legacy BIOS：<strong>激活</strong>的主分区-&gt;\Boot\BCD</p></li><li><p>Windows中的备份路径：C:\Windows\Boot\DVD</p></li><li><p>编辑方式：BOOTICE</p></li><li><p>创建启动项：添加-&gt;设置「启动磁盘」「启动分区」「菜单标题」「启动文件」「系统路径」「系统语言」-&gt;「保存全局设置」「保存当前系统设置」</p><ul><li>「启用Win8 Metro启动界面」：metro启动界面的优点在于美观和支持触屏设备，但缺点是由于开机预加载了系统文件，导致启动其他操作系统时需要重启才行，对多系统启动的支持并不友好。取消勾选该选项，则会使用Win7的启动界面，任意选择操作系统菜单，不用经历重启。</li><li>「启动文件」<ul><li>Legacy BIOS：\Windows\system32\winload.exe</li><li>UEFI：\Windows\system32\winload.efi</li></ul></li><li>「系统路径」：\Windows</li><li>「系统语言」：zh-CN</li></ul></li></ul><h2 id="引导报错的排查思路">1.6 &nbsp&nbsp<a href="#引导报错的排查思路" class="headerlink" title="引导报错的排查思路"></a>引导报错的排查思路</h2><h3 id="MBR主引导记录丢失或者GPT分区表使用了Legacy-BIOS引导模式">1.6.1 &nbsp&nbsp<a href="#MBR主引导记录丢失或者GPT分区表使用了Legacy-BIOS引导模式" class="headerlink" title="MBR主引导记录丢失或者GPT分区表使用了Legacy BIOS引导模式"></a>MBR主引导记录丢失或者GPT分区表使用了Legacy BIOS引导模式</h3><p>现象：此故障没有任何报错，开机黑屏，左上角光标一直闪动。</p><p>解决方法：</p><ul><li>PE系统：DiskGenius分区工具-&gt;左键单击整个磁盘-&gt;菜单-&gt;磁盘-&gt;重建主引导记录(MBR)-&gt;保存更改</li><li>主板BIOS设置纯UEFI模式或者CSM兼容模式。</li></ul><h3 id="未设置激活主分区或者GPT分区表使用了Legacy-BIOS引导模式">1.6.2 &nbsp&nbsp<a href="#未设置激活主分区或者GPT分区表使用了Legacy-BIOS引导模式" class="headerlink" title="未设置激活主分区或者GPT分区表使用了Legacy BIOS引导模式"></a>未设置激活主分区或者GPT分区表使用了Legacy BIOS引导模式</h3><p>现象：报错<code>Reboot and Select proper Boot device or Insert Boot Media in selected Boot device and press a key</code></p><p>另外可能的原因：多硬盘的机器上，可能未能正确设置硬盘第一启动项（尤其是微星主板，其硬盘启动项优先于UEFI启动项）。</p><p>解决方法：</p><ul><li>PE系统：DiskGenius分区工具-&gt;左键单击整个分区-&gt;菜单-&gt;磁盘-&gt;激活当前分区-&gt;保存更改</li><li>主板BIOS设置纯UEFI模式或者CSM兼容模式。</li></ul><h3 id="分区引导记录丢失bootmgr-is-missing">1.6.3 &nbsp&nbsp<a href="#分区引导记录丢失bootmgr-is-missing" class="headerlink" title="分区引导记录丢失bootmgr is missing"></a>分区引导记录丢失bootmgr is missing</h3><p>现象：开机显示<code>bootmgr is missing</code></p><p>解决方法：从Windows中的备份路径：<code>C:\Windows\Boot\PCAT\bootmgr</code>拷贝到激活分区的根目录下。</p><h3 id="UEFI引导的相关故障现象">1.6.4 &nbsp&nbsp<a href="#UEFI引导的相关故障现象" class="headerlink" title="UEFI引导的相关故障现象"></a>UEFI引导的相关故障现象</h3><p>bootmgfw.efi或bootx64.efi丢失或损坏。报错如下：第一启动项Windows Boot Manager启动失败，第二第三硬盘启动项也启动失败。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">                                            unsuccessful.</span><br><span class="line">→ Windows Boot Manager... unsuccessful.</span><br><span class="line">→ EFI VMware Virtual SCSI Hard Drive (0.0) ... unsuccessful.</span><br><span class="line">→ EFI VMware Virtual SCSI Hard Drive (1.0) ... unsuccessful.</span><br><span class="line">→ EFI Network.</span><br></pre></td></tr></table></figure><p>原因：基本上是ESP分区文件损坏或者丢失。</p><p>解决方法：PE系统，查看ESP分区的情况，使用dism++或者其他工具修复UEFI引导。</p><h3 id="BCD文件配置错误或者winload文件损坏">1.6.5 &nbsp&nbsp<a href="#BCD文件配置错误或者winload文件损坏" class="headerlink" title="BCD文件配置错误或者winload文件损坏"></a>BCD文件配置错误或者winload文件损坏</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">文件：\Windows\system32\winload.efi</span><br><span class="line">状态：0xc000000f</span><br><span class="line">信息：无法加载应用程序或操作系统，原因是所需文件丢失或包含错误。</span><br></pre></td></tr></table></figure><p>解决方法：排查BCD文件和winload文件</p><h2 id="虚拟机将gho，esd、wim等系统镜像文件加载进pe">1.7 &nbsp&nbsp<a href="#虚拟机将gho，esd、wim等系统镜像文件加载进pe" class="headerlink" title="虚拟机将gho，esd、wim等系统镜像文件加载进pe"></a>虚拟机将gho，esd、wim等系统镜像文件加载进pe</h2><p>虚拟机中，pe系统无法安装扩展工具，因此无法通过启用共享文件夹功能和宿主机传递文件。以下方法可以给pe系统中传递文件</p><ul><li>将gho、esd、wim文件打包封装成iso文件，通过CD&#x2F;DVD虚拟机硬件加载iso文件</li><li>映射虚拟磁盘</li></ul><h2 id="使用系统镜像内部自带的Setup-exe安装">1.8 &nbsp&nbsp<a href="#使用系统镜像内部自带的Setup-exe安装" class="headerlink" title="使用系统镜像内部自带的Setup.exe安装"></a>使用系统镜像内部自带的Setup.exe安装</h2><div class="note danger no-icon"><p>WinPE不推荐用这个方法，既然都在pe中，有其他方能够更好实现，没必要使用这个。</p></div><p>一般常见于将镜像作为PE启动盘或者直接在系统内运行。</p><p>P.S.在win7-win11系统上都可以直接运行安装（一般我都是用这个方法进行大版本的更新），只不过在WinPE中我们可以删除和格式化系统分区。如果WinPE中无法运行Setup.exe，换一个未深度精简过的PE再尝试。</p><div class="note info no-icon"><p>注意：在WinPE中或者直接作为启动盘，GPT分区注意要启用BIOS的UEFI启动模式，MBR分区启用BIOS的Legacy启动模式。</p></div><h2 id="PE中使用Dism安装系统镜像">1.9 &nbsp&nbsp<a href="#PE中使用Dism安装系统镜像" class="headerlink" title="PE中使用Dism安装系统镜像"></a>PE中使用Dism安装系统镜像</h2><ol><li>使用分区工具分好区</li><li>查看镜像中专业版所对应的索引index：<code>Dism /Get-ImageInfo /ImageFile:H:\sources\install.wim</code></li><li>安装镜像：<code>Dism /apply-image /imagefile:H:\sources\install.wim /index:8 /ApplyDir:W:\</code></li><li>配置启动文件：<code>bcdboot W:\Windows /s S: /f ALL</code>。MBR分区使用这条命令安装bootmgr和更新mbr：<code>bootsect /nt60 W: /mbr</code></li><li>重启机器</li></ol><h2 id="win11-OOBE安装跳过强制登录帐号">1.10 &nbsp&nbsp<a href="#win11-OOBE安装跳过强制登录帐号" class="headerlink" title="win11 OOBE安装跳过强制登录帐号"></a>win11 OOBE安装跳过强制登录帐号</h2><ul><li>方案1：拔掉网线，Shift+F10调出cmd窗口，运行：<code>oobe\BypassNRO.cmd</code>，重启继续走OOBE流程，到登录账户页面时会多出一个暂时跳过的选项。<ul><li>bypassnro.cmd在26200.5516预览版更新已确认被移除，该方法在后期正式版将无法使用。</li></ul></li><li>方案2：方案1的衍生方法，通过注册表修改BypassNRO的值以激活方案1的功能。Shift+F10调出cmd窗口，运行：<code>reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\OOBE /v BypassNRO /t REG_DWORD /d 1 /f shutdown /r /t 0</code>。</li><li>方案3：输入<a href="mailto:&#110;&#111;&#64;&#x74;&#104;&#97;&#x6e;&#107;&#x79;&#x6f;&#x75;&#x2e;&#x63;&#x6f;&#109;">no@thankyou.com</a>触发账户锁定，在登录里输入此账户然后随便输入个字符当做密码点登录，此时系统会弹出错误提醒，然后点击下一步，创建本地账户。其他类似的账户有如下：<ul><li><a href="mailto:&#x31;&#64;&#49;&#46;&#99;&#111;&#x6d;">1@1.com</a></li><li><a href="mailto:&#56;&#x40;&#x38;&#x2e;&#99;&#111;&#109;">8@8.com</a></li><li><a href="mailto:&#110;&#x6f;&#64;&#x74;&#104;&#x61;&#x6e;&#x6b;&#x73;&#x2e;&#99;&#x6f;&#x6d;">no@thanks.com</a></li><li><a href="mailto:&#110;&#111;&#x40;&#116;&#x68;&#97;&#110;&#x6b;&#x79;&#x6f;&#117;&#x2e;&#99;&#111;&#109;">no@thankyou.com</a></li><li><a href="mailto:&#x65;&#120;&#x61;&#109;&#x70;&#108;&#x65;&#x40;&#101;&#x78;&#97;&#x6d;&#x70;&#108;&#x65;&#46;&#x63;&#x6f;&#x6d;">example@example.com</a></li></ul></li><li>方案4：拔掉网线，Shift+F10调出cmd窗口，运行<code>start ms-cxh:localonly</code>。系统会自动打开微软账户管理的窗口，在此窗口输入帐号的用户名称和密码即可。<ul><li>适用系统范围：Windows 11 家庭版和专业版系列 (包括专业版、专业工作站版和专业教育版)</li></ul></li><li>方案5：无人值守文件unattended.xml自动化脚本。</li></ul><h2 id="新主板安装win7启动报错蓝屏0x000000a5">1.11 &nbsp&nbsp<a href="#新主板安装win7启动报错蓝屏0x000000a5" class="headerlink" title="新主板安装win7启动报错蓝屏0x000000a5"></a>新主板安装win7启动报错蓝屏0x000000a5</h2><p>问题：理论上1-13代酷睿都可以安装，本质上就是驱动的支持问题（锐龙芯片也是一样）。intel酷睿芯片原生支持win7的是6代，789代可通过注入驱动方式安装（可稳定用），10代及10代以后的也可以装，十分麻烦，需要特别处理BIOS和驱动问题（否则就是无限的a5蓝屏），而且不知道能否稳定用。一般导致a5蓝屏常见也是acpi.sys驱动问题。</p><h2 id="WinNTSetup安装系统ESD镜像报错0x25D：指定的缓冲区中包含类型错误的数据">1.12 &nbsp&nbsp<a href="#WinNTSetup安装系统ESD镜像报错0x25D：指定的缓冲区中包含类型错误的数据" class="headerlink" title="WinNTSetup安装系统ESD镜像报错0x25D：指定的缓冲区中包含类型错误的数据"></a>WinNTSetup安装系统ESD镜像报错0x25D：指定的缓冲区中包含类型错误的数据</h2><p>问题现象：在使用WinNTSetup安装Windows系统时，安装进度达到17%~18%时，WinNTSetup会卡住，弹出报错弹窗：<code>wimhost wimgapi error 0x25D：指定的缓冲区中包含类型错误的数据</code>。</p><p>原因：未查明，该平台尝试更换同型号内存&#x2F;CPU&#x2F;硬盘，测试均能复现该报错，并且只出现Win11 23H2版本（UUP合成的ESD镜像），同为ESD版本的Win11 24H2版本却是安装正常。</p><p>解决方法：使用wim类型的镜像可以规避该问题。</p><h1 id="系统启动项">2 &nbsp&nbsp<a href="#系统启动项" class="headerlink" title="系统启动项"></a>系统启动项</h1><h2 id="EFI-NVRAM启动项">2.1 &nbsp&nbsp<a href="#EFI-NVRAM启动项" class="headerlink" title="EFI NVRAM启动项"></a>EFI NVRAM启动项</h2><p>具有EFI的硬件，启动项是存储在NVRAM介质中的，EFI固件类似于BIOS固件。在UEFI v2.3.1及之后的版本，可以使用这些工具编辑EFI启动项：</p><ul><li>EFI version 2 shell: 提供<code>bcfg</code>的命令</li><li>Windows<ul><li><a href="https://www.easyuefi.com/index-us.html">EasyUEFI</a>：支持GUI和<a href="https://www.easyuefi.com/faq/en-US/EasyUEFI-Command-Line.html">命令行操作</a></li><li><a href="http://bbs.wuyou.net/forum.php?mod=viewthread&tid=57675">Bootice</a></li><li><a href="https://www.diskgenius.cn/">DiskGenius</a>：<a href="https://www.diskgenius.cn/help/set-uefi-bios-options.php">设置UEFI BIOS启动项</a></li></ul></li><li>Linux: efibootmgr</li></ul><h2 id="Windows-Boot-Manager启动失败，硬盘Disk-0启动成功">2.2 &nbsp&nbsp<a href="#Windows-Boot-Manager启动失败，硬盘Disk-0启动成功" class="headerlink" title="Windows Boot Manager启动失败，硬盘Disk 0启动成功"></a>Windows Boot Manager启动失败，硬盘Disk 0启动成功</h2><p>故障原因：在操作重装uEFI系统之后，BCD（引导配置数据）条目未正确修改引起的故障。比如，重装系统之后，Windows Boot Manager中的&quot;device&quot;相关参数被删除，因此无法正确启动。</p><p>解决方法，有两种：</p><ul><li>重建引导：PE系统中，运行<code>%win_drive_letter%:\Windows\System32\bcdboot %win_drive_letter%:\Windows /s %efi_drive_letter%: /f BIOS /l zh-cn</code><ul><li><a href="https://learn.microsoft.com/en-us/windows-hardware/manufacture/desktop/bcdboot-command-line-options-techref-di?view=windows-11"><code>BCDBoot</code>命令行参数选项</a></li></ul></li><li>CSM模式下，设置第一启动项为硬盘启动项，而不是windows boot manager启动项。</li></ul><h2 id="多系统引导项的默认值设置">2.3 &nbsp&nbsp<a href="#多系统引导项的默认值设置" class="headerlink" title="多系统引导项的默认值设置"></a>多系统引导项的默认值设置</h2><ol><li>WIN+R：msconfig-&gt;「引导」-&gt;选中我们需要默认启动的操作系统-&gt;「设为默认值」</li><li>高级系统设置-&gt;高级-&gt;启动和故障恢复-&gt;设置-&gt;默认操作系统</li></ol><h1 id="无人值守部署系统">3 &nbsp&nbsp<a href="#无人值守部署系统" class="headerlink" title="无人值守部署系统"></a>无人值守部署系统</h1><h2 id="自动分区硬盘部署镜像">3.1 &nbsp&nbsp<a href="#自动分区硬盘部署镜像" class="headerlink" title="自动分区硬盘部署镜像"></a>自动分区硬盘部署镜像</h2><p><a href="https://www.tenforums.com/installation-upgrade/182945-automate-diskpart-clean-install.html">https://www.tenforums.com/installation-upgrade/182945-automate-diskpart-clean-install.html</a></p><h1 id="封装系统">4 &nbsp&nbsp<a href="#封装系统" class="headerlink" title="封装系统"></a>封装系统</h1><h2 id="关于IT天空论坛工具的锁定主页的行为">4.1 &nbsp&nbsp<a href="#关于IT天空论坛工具的锁定主页的行为" class="headerlink" title="关于IT天空论坛工具的锁定主页的行为"></a>关于IT天空论坛工具的锁定主页的行为</h2><p>锁定情况：EasyImageX2是优启通里面的系统安装器，在优启通里面是去广告的，但是换到另一个pe运行它又是带广告的；万能驱动用it天空的系统封装软件封装后可以去广告，移出来运行又会有广告。</p><p>实现原理：优启通启动的时候会在注册表生产一个当前机器的密钥字符串，然后EasyImageX2去解密判断，判断正确就免广告。同理万能驱动也是。注册表位置：<code>HKEY_LOCAL_MACHINE\SOFTWARE\EasyDrv7\</code>，但是仍然无法通过预先在系统中写入该注册表内容来去除推广包软件和主页绑定，因为是根据当前硬件信息生成一个key的。</p><h2 id="万能驱动的精简">4.2 &nbsp&nbsp<a href="#万能驱动的精简" class="headerlink" title="万能驱动的精简"></a>万能驱动的精简</h2><p>精简思路：softext文件夹内的几个安装包和驱动的压缩包是可删的，但所有e7e文件不可删（softext的e7e若删除，则会报错篡改；驱动压缩包对应的e7e若删除，则会导致卡100%的问题）。一般，驱动文件删除显卡驱动即可，oem和通用的。这种精简方式只适合在部署阶段中调用，无法在桌面环境下运行（会报错文件不完整或者软件被篡改）。如果想要精简并同时可以在桌面环境中运行的话，需要用老版的主程序替代。</p><h2 id="DISM的系统打包（备份）">4.3 &nbsp&nbsp<a href="#DISM的系统打包（备份）" class="headerlink" title="DISM的系统打包（备份）"></a>DISM的系统打包（备份）</h2><p>备份操作，会将驱动器的映像捕获到新的 .wim 文件中：</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Dism /Capture-Image /ImageFile:D:\Windows10Pro-<span class="number">2024</span>-<span class="number">04</span>-<span class="number">13</span>.wim /CaptureDir:C:\ /Name:Windows10Pro-<span class="number">2024</span>-<span class="number">04</span>-<span class="number">13</span> /compress:max</span><br></pre></td></tr></table></figure><p>可以同时指定使用配置文件来打包wim镜像，比如捕获文件时排除休眠文件<code>hiberfil.sys</code>等，参见「<a href="https://learn.microsoft.com/zh-cn/windows-hardware/manufacture/desktop/dism-configuration-list-and-wimscriptini-files-winnext?view=windows-11">DISM 配置列表文件</a>」：</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Dism /Capture-Image /ImageFile:D:\Windows10Pro-<span class="number">2024</span>-<span class="number">04</span>-<span class="number">13</span>.wim /CaptureDir:C:\ /Name:Windows10Pro-<span class="number">2024</span>-<span class="number">04</span>-<span class="number">13</span> /ConfigFile:config_list.ini /compress:max</span><br></pre></td></tr></table></figure><p>config_list.ini文件内容</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[ExclusionList]</span></span><br><span class="line">\$ntfs.log</span><br><span class="line">\hiberfil.sys</span><br><span class="line">\pagefile.sys</span><br><span class="line">\swapfile.sys</span><br><span class="line">\System Volume Information</span><br><span class="line">\RECYCLER</span><br><span class="line">\Windows\CSC</span><br><span class="line"></span><br><span class="line"><span class="section">[CompressionExclusionList]</span></span><br><span class="line">*.mp3</span><br><span class="line">*.zip</span><br><span class="line">*.cab</span><br><span class="line">\WINDOWS\inf\*.pnf</span><br></pre></td></tr></table></figure><h2 id="DISM的系统恢复（应用）">4.4 &nbsp&nbsp<a href="#DISM的系统恢复（应用）" class="headerlink" title="DISM的系统恢复（应用）"></a>DISM的系统恢复（应用）</h2><p>关于使用系统自带命令工具来操作格式化硬盘，恢复镜像等操作，实际用法可参见「<a href="https://learn.microsoft.com/zh-cn/windows-hardware/manufacture/desktop/oem-deployment-of-windows-desktop-editions-sample-scripts?view=windows-11">部署实验室示例脚本</a>」</p><p>恢复操作，此命令将对指定的分区应用 Windows 映像文件 (.wim)：</p><blockquote><p>一般推荐同时使用<code>/Verify</code>和<code>/NoRpFix</code>参数，但在我实际应用中，wim镜像打包都OK，但是还原会有概率导致出问题（<code>/NoRpFix</code>还没测试过，也可能是因为中文字符的缘故，以往测试时<code>/Name</code>参数使用中文字符<code>专业版</code>，而非<code>Pro</code>）。</p></blockquote><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dism /apply-image /imagefile:<span class="variable">%image_path%</span> /index:<span class="number">1</span> /applydir:<span class="variable">%win_drive_letter%</span>:\</span><br></pre></td></tr></table></figure><p>bcdboot重建系统引导（UEFI）：</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">%win_drive_letter%</span>:\Windows\System32\bcdboot <span class="variable">%win_drive_letter%</span>:\Windows /s <span class="variable">%efi_drive_letter%</span>: /f UEFI /l zh-cn</span><br></pre></td></tr></table></figure><h1 id="WinPE">5 &nbsp&nbsp<a href="#WinPE" class="headerlink" title="WinPE"></a>WinPE</h1><h2 id="WinPE的二次修改封装">5.1 &nbsp&nbsp<a href="#WinPE的二次修改封装" class="headerlink" title="WinPE的二次修改封装"></a>WinPE的二次修改封装</h2><h3 id="ISO镜像">5.1.1 &nbsp&nbsp<a href="#ISO镜像" class="headerlink" title="ISO镜像"></a>ISO镜像</h3><p>ISO镜像的二次修改和打包工具：<a href="http://www.anyburn.com/">AnyBurn</a>，使用软件中的「编辑镜像文件」功能即可，这样就可以完美保留原镜像的引导启动数据。（不推荐用UltraISO，界面老旧且难用，主要是ISO的引导信息不好弄）</p><h3 id="WIM镜像">5.1.2 &nbsp&nbsp<a href="#WIM镜像" class="headerlink" title="WIM镜像"></a>WIM镜像</h3><p>wim镜像的二次修改，dism使用命令参见「<a href="https://learn.microsoft.com/zh-cn/windows-hardware/manufacture/desktop/dism-image-management-command-line-options-s14?view=windows-11">DISM 映像管理命令行选项</a>」：</p><ul><li>单版本：解压后就是系统本身，这种直接解压进行二次修改，然后dism++重新打包即可，记得勾选「可启动镜像」的选项。</li><li>多版本（dism如何一直提示镜像已经被加载过，使用<code>dism /cleanup-wim</code>命令强制卸载所有镜像）<ol><li>加载wim镜像到特定的路径空文件夹：<code>dism /mount-wim /wimfile:G:\11pex64.wim /index:1 /mountdir:D:\GOF\mount</code></li><li>卸载镜像并保存更改到镜像中：<code>dism /unmount-wim /mountdir:D:\GOF\mount /commit</code></li><li>导出wim以优化镜像（如果修改映像，DISM将存储额外的资源文件，比如wim文件内新增一个目录<code>[DELETE]</code>，这会增大映像的总体大小。可以通过将映像导出到新的映像文件，实现优化该映像，即删除掉目录<code>[DELETE]</code>。）</li></ol>  <figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Dism /Export-Image /SourceImageFile:<span class="number">11</span>pex64.wim /SourceIndex:<span class="number">1</span> /DestinationImageFile:<span class="number">11</span>pex64.wim</span><br><span class="line">Dism /Export-Image /SourceImageFile:<span class="number">11</span>pex64.wim /SourceIndex:<span class="number">2</span> /DestinationImageFile:<span class="number">11</span>pex64.wim</span><br></pre></td></tr></table></figure></li></ul><h2 id="关于加载PE后出现「-windows-system32-drivers-cdrom-sys」驱动加载错误的分析">5.2 &nbsp&nbsp<a href="#关于加载PE后出现「-windows-system32-drivers-cdrom-sys」驱动加载错误的分析" class="headerlink" title="关于加载PE后出现「\windows\system32\drivers\cdrom.sys」驱动加载错误的分析"></a>关于加载PE后出现「\windows\system32\drivers\cdrom.sys」驱动加载错误的分析</h2><p>问题现象：无论是更换pe版本或者更换U盘亦或是用其他分区方案制作PE，当选择U盘PE引导项加载时，都会出现这个「\windows\system32\drivers\cdrom.sys」报错提示，无法进入系统。</p><p>问题原因：硬件稳定性引起系统层面的问题，一般是内存多一些，CPU或者硬盘有小概率可能会导致这样。</p><p>解决方法：从硬件排障手段入手排查，尝试拔插内存或者单根内存测试下是否会这样。</p><h2 id="PE内引导到特定设备">5.3 &nbsp&nbsp<a href="#PE内引导到特定设备" class="headerlink" title="PE内引导到特定设备"></a>PE内引导到特定设备</h2><p>关于自动化分区和还原系统之后，若想自动引导到硬盘系统，而非USB的PE系统，一般有如下几个方案：</p><ul><li>BIOS设置硬盘启动项：华硕主板实测无效，即使设置了BBS硬盘启动项（BBS还需要开启CSM选项保存重启），仍然是会引导至USB设备上。若设置关闭了USB的BBS，即使可以实现，但首次启动会报错提示找不到合适的启动设备。</li><li>PE通过BOOTICE工具的UEFI功能引导至BIOS界面或者修改<code>UEFI OS</code>指定为硬盘系统和引导位置（默认是指定到U盘的）</li><li>bcdedit修改引导启动项（BOOTICE好像也是通过bcdedit修改的）</li></ul><h2 id="获取特定硬盘分区的GUID">5.4 &nbsp&nbsp<a href="#获取特定硬盘分区的GUID" class="headerlink" title="获取特定硬盘分区的GUID"></a>获取特定硬盘分区的GUID</h2><ul><li>命令行程序：<code>mountvol</code></li><li>分区工具：<code>DiskGenius</code>，选择特定分区查看GUID（非分区类型GUID）</li></ul><h1 id="应答文件-unattend-xml-系统部署">6 &nbsp&nbsp<a href="#应答文件-unattend-xml-系统部署" class="headerlink" title="应答文件 (unattend.xml)系统部署"></a>应答文件 (unattend.xml)系统部署</h1><p>使用应答文件自动完成安装和部署系统，在联网的情况下，因为存在联网服务器检测系统版本和更新状态，因此比拔掉网线断网的情况会会多占用2-3分钟左右的时间。（倘若插上网线联网状态一直卡在这个阶段的话，即可能由于连接服务器失败，需手动拔掉网线，让它检测判断并跳过该阶段）</p><h1 id="参考文献">7 &nbsp&nbsp<a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p>[1] 支持win7的最后一代CPU?支持win7系统推荐(支持8&#x2F;9&#x2F;10&#x2F;11&#x2F;12&#x2F;13代cpu)[EB&#x2F;OL]. <a href="http://w7.dnxtc.net/zixun/zuzhuangjiaocheng/2023-04-16/11866.html">http://w7.dnxtc.net/zixun/zuzhuangjiaocheng/2023-04-16/11866.html</a>.<br>[2] 10代11代主板装win7开机蓝屏A5解决办法[EB&#x2F;OL]. <a href="https://www.yweihu.com/post/242.html">https://www.yweihu.com/post/242.html</a>.<br>[3] 微软又给Windows11增加了限制？[EB&#x2F;OL]. <a href="https://zhuanlan.zhihu.com/p/514063607">https://zhuanlan.zhihu.com/p/514063607</a>.<br>[4] 在虚拟机上安装gho、esd（wim）系统镜像文件[EB&#x2F;OL]. <a href="https://www.cnblogs.com/-mrl/p/9634227.html">https://www.cnblogs.com/-mrl/p/9634227.html</a>.<br>[5] Methods to install Windows from WinPE[EB&#x2F;OL]. <a href="https://www.aioboot.com/en/install-windows/">https://www.aioboot.com/en/install-windows/</a>.<br>[6] 万能驱动 v7.23.925.3（2023.11.08 发布）[EB&#x2F;OL]. <a href="https://www.puresys.net/1147.html">https://www.puresys.net/1147.html</a>.<br>[7] easyImageX2和万能驱动有种奇特的现象[EB&#x2F;OL]. <a href="http://wuyou.net/forum.php?mod=viewthread&tid=422066">http://wuyou.net/forum.php?mod=viewthread&amp;tid=422066</a>.<br>[8] Force DISM to unmount&#x2F;delete a mounted Windows WIM[EB&#x2F;OL]. <a href="https://superuser.com/questions/1091544/force-dism-to-unmount-delete-a-mounted-windows-wim">https://superuser.com/questions/1091544/force-dism-to-unmount-delete-a-mounted-windows-wim</a>.<br>[9] All In One 把该用到的都封到安装镜像中！[EB&#x2F;OL]. <a href="http://m.cfan.com.cn/pcarticle/128008">http://m.cfan.com.cn/pcarticle/128008</a>.<br>[10] Booting is unsuccessful from &quot;Windows Boot Manager&quot; on the top of boot order in EFI setup. The booting is successful from Disk 0.[EB&#x2F;OL]. <a href="https://www.veritas.com/support/en_US/article.100015603">https://www.veritas.com/support/en_US/article.100015603</a>.<br>[11] BOOTICE -&gt; UEFI -&gt; UEFI boot entry configuration file ? (management of UEFI startup items)[EB&#x2F;OL]. <a href="http://reboot.pro/index.php?showtopic=21508">http://reboot.pro/index.php?showtopic=21508</a>.<br>[12] Windows系统开机引导顺序简述及运维小结[EB&#x2F;OL]. <a href="https://zhuanlan.zhihu.com/p/355526135">https://zhuanlan.zhihu.com/p/355526135</a>.</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h1 id=&quot;安装系统&quot;&gt;1 &amp;nbsp&amp;nbsp&lt;a href=&quot;#安装系统&quot; class=&quot;headerlink&quot; title=&quot;安装系统&quot;&gt;&lt;/a&gt;安装系统&lt;/h1&gt;&lt;h2 id=&quot;关于引导类型和分区表类型的组合选择&quot;&gt;1.1 &amp;nbsp&amp;nbsp&lt;a</summary>
        
      
    
    
    
    <category term="troubleshooting" scheme="https://mister-kin.github.io/categories/troubleshooting/"/>
    
    
    <category term="总结" scheme="https://mister-kin.github.io/tags/%E6%80%BB%E7%BB%93/"/>
    
    <category term="windows" scheme="https://mister-kin.github.io/tags/windows/"/>
    
    <category term="排障" scheme="https://mister-kin.github.io/tags/%E6%8E%92%E9%9A%9C/"/>
    
    <category term="winpe" scheme="https://mister-kin.github.io/tags/winpe/"/>
    
    <category term="系统封装" scheme="https://mister-kin.github.io/tags/%E7%B3%BB%E7%BB%9F%E5%B0%81%E8%A3%85/"/>
    
    <category term="系统安装" scheme="https://mister-kin.github.io/tags/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/"/>
    
  </entry>
  
  <entry>
    <title>网络排障总结</title>
    <link href="https://mister-kin.github.io/troubleshooting/network-troubleshooting/"/>
    <id>https://mister-kin.github.io/troubleshooting/network-troubleshooting/</id>
    <published>2025-11-25T19:28:14.000Z</published>
    <updated>2026-01-09T10:56:01.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="网线线序">1 &nbsp&nbsp<a href="#网线线序" class="headerlink" title="网线线序"></a>网线线序</h1><ul><li>T568B：白橙&#x2F;橙&#x2F;白绿&#x2F;蓝&#x2F;白蓝&#x2F;绿&#x2F;白棕&#x2F;棕<ul><li>也有这样的口诀记忆顺序：橙白&#x2F;橙&#x2F;绿白&#x2F;蓝&#x2F;蓝白&#x2F;绿&#x2F;棕白&#x2F;棕</li></ul></li><li>T568A：白绿&#x2F;绿&#x2F;白橙&#x2F;蓝&#x2F;白蓝&#x2F;橙&#x2F;白棕&#x2F;棕</li><li>直通线（平行线）：网线2头都做成568B标准。（<strong>现在都是平行线做法，设备能够自己识别</strong>）用于双机器不同级连接，比如交换机连电脑。交换机连路由器。</li><li>交叉线：网线一头做成568B，另一头做成568A。用于双机器同级连接，比如电脑连电脑，交换机连交换机。</li></ul><pre><code class="highlight mermaid">block-beta  columns 8  %% 1. 标题块：通过 :8 让它横跨 8 列，避免被下方方块遮挡  Header[&quot;T568B：RJ45水晶头&lt;br/&gt;金手指朝上，从左到右&quot;]:8  %% 2. 定义 8 个针脚  P1[&quot;1.白橙&quot;] P2[&quot;2.橙&quot;] P3[&quot;3.白绿&quot;] P4[&quot;4.蓝&quot;]  P5[&quot;5.白蓝&quot;] P6[&quot;6.绿&quot;] P7[&quot;7.白棕&quot;] P8[&quot;8.棕&quot;]  %% 颜色样式定义  style P1 fill:#ffffff,stroke:#ff8c00,stroke-width:3px  style P2 fill:#ff8c00,stroke:#ff8c00,color:#fff  style P3 fill:#ffffff,stroke:#00c000,stroke-width:3px  style P4 fill:#0000ff,stroke:#0000ff,color:#fff  style P5 fill:#ffffff,stroke:#0000ff,stroke-width:3px  style P6 fill:#008000,stroke:#008000,color:#fff  style P7 fill:#ffffff,stroke:#8b4513,stroke-width:3px  style P8 fill:#8b4513,stroke:#8b4513,color:#fff  %% 标题块样式：去掉背景和边框，使其看起来像纯文本标题  style Header fill:none,stroke:none,font-weight:bold,font-size:18px</code></pre><pre><code class="highlight mermaid">block-beta  columns 8  %% 标题块  Header[&quot;T568A：RJ45水晶头&lt;br/&gt;金手指朝上，从左到右&quot;]:8  %% 定义 8 个针脚（T568A 线序）  P1[&quot;1.白绿&quot;] P2[&quot;2.绿&quot;] P3[&quot;3.白橙&quot;] P4[&quot;4.蓝&quot;]  P5[&quot;5.白蓝&quot;] P6[&quot;6.橙&quot;] P7[&quot;7.白棕&quot;] P8[&quot;8.棕&quot;]  %% 颜色样式定义  style P1 fill:#ffffff,stroke:#00c000,stroke-width:3px  style P2 fill:#008000,stroke:#008000,color:#fff  style P3 fill:#ffffff,stroke:#ff8c00,stroke-width:3px  style P4 fill:#0000ff,stroke:#0000ff,color:#fff  style P5 fill:#ffffff,stroke:#0000ff,stroke-width:3px  style P6 fill:#ff8c00,stroke:#ff8c00,color:#fff  style P7 fill:#ffffff,stroke:#8b4513,stroke-width:3px  style P8 fill:#8b4513,stroke:#8b4513,color:#fff  %% 标题样式  style Header fill:none,stroke:none,font-weight:bold,font-size:18px</code></pre><h1 id="网络IP地址划分（IPv4）">2 &nbsp&nbsp<a href="#网络IP地址划分（IPv4）" class="headerlink" title="网络IP地址划分（IPv4）"></a>网络IP地址划分（IPv4）</h1><ul><li>私有地址<ul><li>A类 10.0.0.1 ~ 10.255.255.254</li><li>B类 172.16.0.1 ~ 172.31.255.254</li><li>C类 192.168.0.1 ~ 192.168.255.254</li></ul></li><li>默认子网掩码<ul><li>A 类 255.0.0.0</li><li>B类 255.255.0.0</li><li>C 类 255.255.255.0</li></ul></li><li>ip地址划分<ul><li>A 1 ~ 127 网+主+主+主</li><li>B 128 ~ 191 网+网+主+主</li><li>C 192 ~ 223 网+网+网+主</li><li>D 224 ~ 239 组播(多播)</li><li>E 240 ~ 254 科研</li></ul></li><li>169.254.x.x：链路本地地址<ul><li>代表物理连接可能有问题，或者DHCP服务器（路由器）挂了</li><li>可以和局域网内同样处于 169.254.x.x 状态的设备进行简单的通讯</li></ul></li></ul><h1 id="浏览器键入网址到显示网页的过程">3 &nbsp&nbsp<a href="#浏览器键入网址到显示网页的过程" class="headerlink" title="浏览器键入网址到显示网页的过程"></a>浏览器键入网址到显示网页的过程</h1><h1 id="网络模型">4 &nbsp&nbsp<a href="#网络模型" class="headerlink" title="网络模型"></a>网络模型</h1><h2 id="OSI参考模型-TCP-IP分层模型">4.1 &nbsp&nbsp<a href="#OSI参考模型-TCP-IP分层模型" class="headerlink" title="OSI参考模型&amp;TCP&#x2F;IP分层模型"></a>OSI参考模型&amp;TCP&#x2F;IP分层模型</h2><pre><code class="highlight mermaid">%%&#123;init: &#123;&quot;flowchart&quot;: &#123;&quot;wrappingWidth&quot;: 450&#125;&#125;&#125;%%flowchart LR    %% 定义样式    classDef cls_App fill:#E8F5E9,stroke:#2E7D32,stroke-width:2px    classDef cls_Trans fill:#E3F2FD,stroke:#1565C0,stroke-width:2px    classDef cls_Net fill:#FFF3E0,stroke:#EF6C00,stroke-width:2px    classDef cls_Link fill:#F3E5F5,stroke:#7B1FA2,stroke-width:2px    %% 子图样式    style OSI fill:#FAF5FC,stroke:#7B1FA2,stroke-dasharray: 5 5    style TCPIP fill:#F5FAFC,stroke:#0288D1,stroke-dasharray: 5 5    style Detailed fill:#FAFAFA,stroke:#616161,stroke-dasharray: 5 5    subgraph OSI [OSI七层模型]        direction TB        L7[L7 应用层]:::cls_App        L6[L6 表示层]:::cls_App        L5[L5 会话层]:::cls_App        L4[L4 传输层]:::cls_Trans        L3[L3 网络层]:::cls_Net        L2[L2 数据链路层]:::cls_Link        L1[L1 物理层]:::cls_Link    end    subgraph TCPIP [TCP/IP四层模型]        direction TB        T4[应用层]:::cls_App        T3[传输层]:::cls_Trans        T2[网络层]:::cls_Net        T1[网络接口层]:::cls_Link    end    subgraph Detailed [详细协议栈与核心功能]        direction TB        D7[&quot;各种应用程序协议&lt;br&gt;【协议】HTTP, TELNET, FTP, DNS, NTP, SMTP, MQTT, SSH&lt;br&gt;【功能】业务逻辑、验证&quot;]:::cls_App        D6[&quot;【协议】SSL/TLS, JSON, XML&lt;br&gt;【功能】数据加密、压缩、编码、格式转换&quot;]:::cls_App        D5[&quot;【协议】RPC, NetBIOS, Sockets&lt;br&gt;【功能】建立、管理、终止会话&quot;]:::cls_App        D4[&quot;【协议】TCP, UDP, QUIC, SCTP&lt;br&gt;【功能】端口寻址、流控&quot;]:::cls_Trans        D3[&quot;【协议】IP(IPv4/IPv6), ICMP, OSPF&lt;br&gt;【功能】逻辑寻址、路由&quot;]:::cls_Net        D2[&quot;【协议】ARP, Frame-Relay, Token Ring&lt;br&gt;【功能】Wi-Fi、MAC寻址、成帧&quot;]:::cls_Link        D1[&quot;【协议】IEEE 802.2/802.3, Ethernet V.21/V.35, EIA/TIA-232/449&lt;br&gt;【功能】电缆、光纤、物理接口、比特流&quot;]:::cls_Link    end    %% 映射连线    L7 --- T4    L6 --- T4    L5 --- T4    L4 --- T3    L3 --- T2    L2 --- T1    L1 --- T1    T4 --- D7    T4 --- D6    T4 --- D5    T3 --- D4    T2 --- D3    T1 --- D2    T1 --- D1</code></pre><p>「科来网络通讯协议图」和「常见协议漏洞信息」：<a href="https://www.colasoft.com.cn/learnings/protocols-map">https://www.colasoft.com.cn/learnings/protocols-map</a></p><h2 id="TCP-IP四层模型的封装格式">4.2 &nbsp&nbsp<a href="#TCP-IP四层模型的封装格式" class="headerlink" title="TCP&#x2F;IP四层模型的封装格式"></a>TCP&#x2F;IP四层模型的封装格式</h2><pre><code class="highlight mermaid">block    columns 6    %% 第一行：应用层    space:4    block:Row4:1        columns 1        D4[&quot;应用数据&lt;br&gt;例如HTTP头部+消息体&lt;br&gt;假设MTU是1500byte，MSS是1460byte&quot;]    end    M4[&quot;应用层&lt;br&gt;传输单位是message&lt;br&gt;数据包分割为MSS：TCP最大报文段⻓度&quot;]:1    %% 第二行：传输层    space:3    block:Row3:2        columns 2        TCP3[&quot;TCP头&lt;br&gt;大小是20byte&quot;]        D3[&quot;应用数据&lt;br&gt;例如HTTP头部+消息体&lt;br&gt;假设MTU是1500byte，MSS是1460byte&quot;]    end    M3[&quot;传输层&lt;br&gt;传输单位是segment&quot;]:1    %% 第三行：网络层    space:2    block:Row2:3        columns 3        IP2[&quot;IP头&lt;br&gt;大小是20byte&quot;]        TCP2[&quot;TCP头&lt;br&gt;大小是20byte&quot;]        D2[&quot;应用数据&lt;br&gt;例如HTTP头部+消息体&lt;br&gt;假设MTU是1500byte，MSS是1460byte&quot;]    end    M2[&quot;网络层&lt;br&gt;传输单位是packet&lt;br&gt;数据包分割为MTU：最大传输单元&lt;br&gt;大小一般是1500byte&quot;]:1    %% 第四行：网络接口层    block:Row1:5        columns 5        FH1[&quot;帧头&lt;br&gt;MAC头部+类型&quot;]        IP1[&quot;IP头&lt;br&gt;大小是20byte&quot;]        TCP1[&quot;TCP头&lt;br&gt;大小是20byte&quot;]        D1[&quot;应用数据&lt;br&gt;例如HTTP头部+消息体&lt;br&gt;假设MTU是1500byte，MSS是1460byte&quot;]        FE1[&quot;帧尾&lt;br&gt;FCS (帧校验序列)&quot;]    end    M1[&quot;网络接口层&lt;br&gt;传输单位是frame&quot;]:1    style Row4 fill:#E8F5E9,stroke:#2E7D32,stroke-dasharray: 5 5    style Row3 fill:#E3F2FD,stroke:#1565C0,stroke-dasharray: 5 5    style Row2 fill:#FFF3E0,stroke:#EF6C00,stroke-dasharray: 5 5    style Row1 fill:#F3E5F5,stroke:#7B1FA2,stroke-dasharray: 5 5    %% 样式定义：建议将样式直接应用到节点 ID，避免在 Row 定义中混淆    classDef cls_App fill:#E8F5E9,stroke:#2E7D32,stroke-width:1px,color:#000    classDef cls_Trans fill:#E3F2FD,stroke:#1565C0,stroke-width:1px,color:#000    classDef cls_Net fill:#FFF3E0,stroke:#EF6C00,stroke-width:1px,color:#000    classDef cls_Link fill:#F3E5F5,stroke:#7B1FA2,stroke-width:1px,color:#000    class D4,D3,D2,D1,M4 cls_App    class TCP3,TCP2,TCP1,M3 cls_Trans    class IP2,IP1,M2 cls_Net    class FH1,FE1,M1,FE1 cls_Link</code></pre><h2 id="流程图：TCP连接">4.3 &nbsp&nbsp<a href="#流程图：TCP连接" class="headerlink" title="流程图：TCP连接"></a>流程图：TCP连接</h2><pre><code class="highlight mermaid">sequenceDiagram    participant C as 客户端 (Client)    participant S as 服务端 (Server)    Note over S: 状态: CLOSED    Note over C, S: --- 阶段 1：建立连接（三次握手） ---    Note over C: 状态: CLOSED    Note over S: 状态: LISTEN    C-&gt;&gt;S: SYN=1, Seq Num=client_isn&lt;br&gt;ISN（Initial Sequence Number，初始序列号）&lt;br&gt;报文不包含应用层数据    Note over C: 状态变为: SYN_SENT    S-&gt;&gt;C: SYN=1, ACK=1, Seq Num=server_isn, Ack Num=client_isn+1&lt;br&gt;报文不包含应用层数据    Note over S: 状态变为: SYN_RECEIVED    C-&gt;&gt;S: ACK=1, Seq Num=client_isn+1, Ack Num=server_isn+1&lt;br&gt;报文可以携带应用层数据，比如HTTP Get请求    Note left of C: 分配系统资源&lt;br&gt;建立连接    Note over C: 状态变为: ESTABLISHED    Note right of S: 分配系统资源&lt;br&gt;建立连接    Note over S: 收到ACK后变为: ESTABLISHED    Note over C, S: --- 阶段 2：数据传输 ---    Note over C, S: 双方维持 ESTABLISHED 状态&lt;br&gt;客户端和服务端之间可以自由交换数据    Note over C, S: --- 阶段 3：断开连接（四次挥手） ---    C-&gt;&gt;S: FIN=1, seq=u    Note left of C: 状态变为: FIN-WAIT-1    S-&gt;&gt;C: ACK=1, seq=v, ack=u+1    Note right of S: 状态变为: CLOSE-WAIT    Note left of C: 收到ACK后变为: FIN-WAIT-2    S-&gt;&gt;C: FIN=1, ACK=1, seq=w, ack=u+1    Note right of S: 状态变为: LAST-ACK    C-&gt;&gt;S: ACK=1, seq=u+1, ack=w+1    Note left of C: 状态变为: TIME-WAIT    Note right of S: 收到ACK后变为: CLOSED    Note over C: 等待 2MSL 时间    Note left of C: 最终状态: CLOSED</code></pre><h2 id="TCP连接状态（11种）">4.4 &nbsp&nbsp<a href="#TCP连接状态（11种）" class="headerlink" title="TCP连接状态（11种）"></a>TCP连接状态（11种）</h2><p>以下顺序按照TCP（传输控制协议）的三个阶段：建立连接（对应状态1-3，三次握手：<code>SYN报文-&gt;SYN+ACK报文-&gt;ACK报文</code>）、数据传输（对应状态4）、断开连接（对应5-10，四次挥手：<code>FIN-&gt;ACK-&gt;</code>）</p><ol><li><strong>LISTEN：监听等待接入</strong>。服务端打开一个SOCKET，监听远程机器的TCP端口的连接请求，状态为LISTEN。<ul><li>例如FTP服务端启动后处于LISTEN状态，端口开放，等待客户端连接，注意此时没有被连接。</li></ul></li><li><strong>SYN_SENT：主动发起连接</strong>。客户端发送连接请求（SYN报文）后，等待匹配，进入SYN_SENT状态。<ul><li>例如客户端通过TCP发送一个SYN报文以请求建立一个连接，此时状态为SYN_SENT。</li></ul></li><li><strong>SYN_RECEIVED：收到连接请求，待确认</strong>。服务端接收到SYN报文并发送了确认（SYN+ACK报文）后，进入SYN_RECEIVED状态，等待客户端的最后确认。<ul><li>服务端收到一个客户端发送的SYN报文同步信号时，会发送一个SYN+ACK报文给客户端，以确认建立连接，此时状态为SYN_RECEIVED。</li><li>如果发现有很多处于SYN_RECEIVED状态的链接，则机器很可能被SYN Flood的DoS（Denial of Service，拒绝服务攻击）攻击。攻击软件是随机伪造IP，服务端压根找不到机器发送SYN+ACK的标志位，服务端只能反复尝试执行握手的第二步（SYN Timeout重试超时会丢弃该连接），压根没法执行握手的第三步。</li></ul></li><li><strong>ESTABLISHED：数据传输正常</strong>。代表连接已经建立成功，计算机之间可以自由交换数据。<ul><li>客户端收到服务端的SYN+ACK报文后，发送一个ACK报文给服务端以确认建立连接，此时状态为ESTABLISHED。</li></ul></li><li><strong>FIN_WAIT_1：发出第一个FIN，等待ACK</strong>。主动关闭端发送了断开请求（FIN报文），正在等待对方的确认（ACK报文），此时状态从ESTABLISHED变为FIN_WAIT_1。<ul><li>假设主动关闭端（active close）就是客户端，客户端应用程序调用close，相关TCP发出FIN报文请求主动关闭，之后就会进入FIN_WAIT_1状态。</li></ul></li><li><strong>CLOSE_WAIT：等待程序关闭连接，即已收FIN，等应用层关闭</strong>。被动关闭端(passive close)接收FIN报文后，就发送ACK报文以回应，并进入CLOSE_WAIT状态。<ul><li>该状态一般是正在等待上层应用层确认关闭（比如清理缓存、发完剩余数据）。</li></ul></li><li><strong>FIN_WAIT_2：收到对方对FIN回应的ACK，即已收ACK，等待对方FIN</strong>。半关闭的状态，主动关闭端接收对方的ACK报文，进入FIN_WAIT_2状态，等待对方发送它的断开请求（FIN）。<ul><li>该状态下，应用程序仍可以接受数据，但无法发送数据。</li></ul></li><li><strong>CLOSING：双方同时发FIN</strong>。罕见状态，双方同时尝试关闭连接。<ul><li>主动关闭端发送FIN报文，但没收到ACK报文，反而收到了对方的FIN报文。</li></ul></li><li><strong>TIME_WAIT：确保对方收到ACK，防止旧包干扰，即2MSL（即两倍的分段最大生存期）等待，确保可靠关闭</strong>。主动关闭端收到了对方的Fin报文，并发送ACK报文以回应，进入TIME_WAIT状态。</li><li><strong>LAST_ACK：已发FIN，等最后ACK</strong>。被动关闭端也准备好关闭了，发送了自己的FIN报文，正在等待主动关闭端的最后一个确认（ACK）。</li><li><strong>CLOSED：无连接，即连接彻底释放后的最终状态或者初始状态</strong>。</li></ol><p>客户端和服务端的状态区别：</p><ul><li>客户端独有状态：<ol><li>SYN_SENT</li></ol></li><li>服务端独有状态：<ol><li>LISTEN</li><li>SYN_RECEIVED</li></ol></li><li>客户端和服务端共有状态：<ol><li>CLOSED</li><li>ESTABLISHED</li><li>FIN_WAIT_1：主动方（常为客户端）</li><li>FIN_WAIT_2：主动方（常为客户端）</li><li>TIME_WAIT：主动方（常为客户端）</li><li>CLOSING：主动方（常为客户端）</li><li>CLOSE_WAIT：被动方（常为服务端）</li><li>LAST_ACK：被动方（常为服务端）</li></ol></li></ul><h2 id="TCP总结">4.5 &nbsp&nbsp<a href="#TCP总结" class="headerlink" title="TCP总结"></a>TCP总结</h2><h3 id="TCP的定义">4.5.1 &nbsp&nbsp<a href="#TCP的定义" class="headerlink" title="TCP的定义"></a>TCP的定义</h3><p>TCP是面向连接的、可靠的、基于字节流的传输层通信协议。TCP是一个工作在传输层的可靠数据传输的服务，它能确保接收端接收的网络包是无损坏、无间隔、非冗余和按序的。</p><ul><li>面向连接：一定是「一对一」才能连接，无法像UDP协议可以一个主机同时向多个主机发送消息，也就是一对多是无法做到的。</li><li>可靠的：无论的网络链路中出现了怎样的链路变化，TCP都可以保证一个报文一定能够到达接收端。</li><li>字节流：用户消息通过TCP协议传输时，消息可能会被操作系统「分组」成多个的TCP报文，如果接收方的程序如果不知道「消息的边界」，是无法读出一个有效的用户消息的。并且TCP报文是「有序的」，当「前一个」TCP报文没有收到的时候，即使它先收到了后面的TCP报文，那么也不能扔给应用层去处理，同时对「重复」的TCP报文会自动丢弃。</li></ul><h3 id="TCP连接的定义">4.5.2 &nbsp&nbsp<a href="#TCP连接的定义" class="headerlink" title="TCP连接的定义"></a>TCP连接的定义</h3><p>用于保证可靠性和流量控制维护的某些状态信息，这些信息的组合，包括Socket、序列号和窗口大小称为连接。</p><ul><li>Socket：由IP地址和端口号组成</li><li>序列号：用来解决乱序问题等</li><li>窗口大小：用来做流量控制</li></ul><h3 id="唯一确定一个TCP连接的原理">4.5.3 &nbsp&nbsp<a href="#唯一确定一个TCP连接的原理" class="headerlink" title="唯一确定一个TCP连接的原理"></a>唯一确定一个TCP连接的原理</h3><p>TCP四元组可以唯一的确定一个连接，四元组包括如下：</p><ul><li>源IP地址：发送端设备的IP<ul><li>字段定义在IP头部，32位</li></ul></li><li>源端口号：发送端进程的端口（通常是客户端随机分配的）<ul><li>字段定义在IP头部，32位</li></ul></li><li>目的IP地址：接收端设备的IP<ul><li>字段定义在TCP头部，16位</li></ul></li><li>目的端口号：接收端进程的端口（如HTTP的80，HTTPS的443）<ul><li>字段定义在TCP头部，16位</li></ul></li></ul><h3 id="TCP三次握手的原因">4.5.4 &nbsp&nbsp<a href="#TCP三次握手的原因" class="headerlink" title="TCP三次握手的原因"></a>TCP三次握手的原因</h3><ul><li>三次握手才可以阻止重复历史连接的初始化（主要原因），比如宕机或者网络阻塞，若发现回复的报文和发送的报文上下文不匹配，则会发起RST报文中止连接</li><li>三次握手才可以同步双方的初始序列号</li><li>三次握手才可以避免资源浪费</li></ul><h2 id="流程图：TCP三次握手避免重复历史连接">4.6 &nbsp&nbsp<a href="#流程图：TCP三次握手避免重复历史连接" class="headerlink" title="流程图：TCP三次握手避免重复历史连接"></a>流程图：TCP三次握手避免重复历史连接</h2><pre><code class="highlight mermaid">sequenceDiagram    participant C as 客户端 (Client)    participant S as 服务端 (Server)    Note left of C: 首次发起&lt;br&gt;旧的SYN (seq=90)    C--xS: SYN=1, Seq Num=90&lt;br&gt;...网络阻塞，传输延迟...    Note left of C: 客户端宕机重启&lt;br&gt;重新发起连接&lt;br&gt;新的SYN (seq=200)    C--xS: SYN=1, Seq Num=200    C-&gt;&gt;S: SYN=1, Seq Num=90    Note right of S: 旧的SYN (seq=90)先抵达    S-&gt;&gt;C: SYN=1, ACK=1, Seq Num=500, Ack Num=91    Note left of C: 识别发现收到的Ack Num=91&lt;br&gt;不是期望收到的200+1&lt;br&gt;因此发送RST报文中止连接    C-&gt;&gt;S: RST=1, ACK=1, Seq Num=91, Ack Num=501    Note right of S: 收到RST，释放旧的SYN半连接资源    C-&gt;&gt;S: SYN=1, Seq Num=200    Note right of S: 不久后新的SYN (seq=200)终于抵达    S-&gt;&gt;C: SYN=1, ACK=1, Seq Num=800, Ack Num=201    Note left of C: 识别发现收到的Ack Num=201&lt;br&gt;是期望收到的200+1    C-&gt;&gt;S: ACK=1, Seq Num=201, Ack Num=801    Note over C, S: 连接成功建立 (ESTABLISHED)</code></pre><h1 id="网络数据包结构">5 &nbsp&nbsp<a href="#网络数据包结构" class="headerlink" title="网络数据包结构"></a>网络数据包结构</h1><h2 id="IPv4数据包结构">5.1 &nbsp&nbsp<a href="#IPv4数据包结构" class="headerlink" title="IPv4数据包结构"></a>IPv4数据包结构</h2><pre><code class="highlight mermaid">packettitle IPv4 Packet0-3: &quot;Version&quot;4-7: &quot;IHL (Header Length)&quot;8-13: &quot;DSCP (Type of Service)&quot;14-15: &quot;ECN&quot;16-31: &quot;Total Length&quot;32-47: &quot;Identification&quot;48-50: &quot;Flags&quot;51-63: &quot;Fragment Offset&quot;64-71: &quot;Time to Live (TTL)&quot;72-79: &quot;Protocol&quot;80-95: &quot;Header Checksum&quot;96-127: &quot;Source IP Address&quot;128-159: &quot;Destination IP Address&quot;160-191: &quot;Options (if any)&quot;192-223: &quot;Data (Payload)&quot;</code></pre><h2 id="TCP数据包结构">5.2 &nbsp&nbsp<a href="#TCP数据包结构" class="headerlink" title="TCP数据包结构"></a>TCP数据包结构</h2><pre><code class="highlight mermaid">---title: &quot;TCP Packet&quot;---packet0-15: &quot;Source Port&quot;16-31: &quot;Destination Port&quot;32-63: &quot;Sequence Number&quot;64-95: &quot;Acknowledgment Number&quot;96-99: &quot;Data Offset&quot;100-105: &quot;Reserved&quot;106: &quot;URG&quot;107: &quot;ACK&quot;108: &quot;PSH&quot;109: &quot;RST&quot;110: &quot;SYN&quot;111: &quot;FIN&quot;112-127: &quot;Window&quot;128-143: &quot;Checksum&quot;144-159: &quot;Urgent Pointer&quot;160-191: &quot;(Options and Padding)&quot;192-255: &quot;Data (variable length)&quot;</code></pre><ul><li>Sequence Number（序列号）：在建立连接时由计算机生成的随机数作为其初始值，通过SYN包传给接收端主机，每发送一次数据，就「累加」一次该「数据字节数」的大小。<strong>用来解决网络包乱序问题。</strong></li><li>Acknowledgment Number（确认应答号）：指下一次「期望」收到的数据的序列号（即期望对方发送使用该值发送Seq Num），发送端收到这个确认应答以后可以认为在这个序号以前的数据都已经被正常接收。<strong>用来解决丢包的问题。</strong></li><li>控制位：<ul><li>ACK：该位为<code>1</code>时，「确认应答号」的字段变为有效，TCP规定除了最初建立连接时的<code>SYN</code>包之外该位必须设置为<code>1</code>。</li><li>RST：该位为<code>1</code>时，表示TCP连接中出现异常必须强制断开连接。</li><li>SYN(Synchronize Sequence Numbers)：该位为<code>1</code>时，表示希望建立连接，并在其「序列号」的字段进行序列号初始值的设定。</li><li>FIN：该位为<code>1</code>时，表示今后不会再有数据发送，希望断开连接。当通信结束希望断开连接时，通信双方的主机之间就可以相互交换<code>FIN</code>位为<code>1</code>的TCP段。</li><li>PSH：该位为<code>1</code>时，表示有DATA数据传输。</li></ul></li></ul><h2 id="UDP数据包结构">5.3 &nbsp&nbsp<a href="#UDP数据包结构" class="headerlink" title="UDP数据包结构"></a>UDP数据包结构</h2><pre><code class="highlight mermaid">packettitle UDP Packet+16: &quot;Source Port&quot;+16: &quot;Destination Port&quot;32-47: &quot;Length&quot;48-63: &quot;Checksum&quot;64-95: &quot;Data (variable length)&quot;</code></pre><h1 id="sc工具（Windows）">6 &nbsp&nbsp<a href="#sc工具（Windows）" class="headerlink" title="sc工具（Windows）"></a>sc工具（Windows）</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询服务状态</span></span><br><span class="line">sc query <span class="string">&quot;Service Name&quot;</span></span><br><span class="line"><span class="comment"># 查询服务状态（含 PID）</span></span><br><span class="line">sc queryex <span class="string">&quot;Service Name&quot;</span></span><br><span class="line"><span class="comment"># 创建服务并将其添加到注册表中</span></span><br><span class="line">sc create <span class="string">&quot;Service Name&quot;</span></span><br><span class="line"><span class="comment"># 从注册表中删除服务</span></span><br><span class="line">sc delete <span class="string">&quot;Service Name&quot;</span></span><br><span class="line"><span class="comment"># 启动系统服务（异步，8不等待结果）</span></span><br><span class="line">sc start <span class="string">&quot;Service Name&quot;</span></span><br><span class="line"><span class="comment"># 暂停系统服务（需服务支持）</span></span><br><span class="line">sc pause <span class="string">&quot;Service Name&quot;</span></span><br><span class="line"><span class="comment"># 继续已暂停的服务</span></span><br><span class="line">sc <span class="built_in">continue</span> <span class="string">&quot;Service Name&quot;</span></span><br><span class="line"><span class="comment"># 停止系统服务</span></span><br><span class="line">sc stop <span class="string">&quot;Service Name&quot;</span></span><br><span class="line"><span class="comment"># 更改服务的配置(永久)</span></span><br><span class="line"><span class="comment"># 例如为NewService服务指定二进制路径</span></span><br><span class="line">sc config NewService binpath= c:\windows\system32\NewServ.exe</span><br></pre></td></tr></table></figure><h1 id="net工具（Windows）">7 &nbsp&nbsp<a href="#net工具（Windows）" class="headerlink" title="net工具（Windows）"></a>net工具（Windows）</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># SMB连接异常的重置方法：可解决SMB能访问远程计算机，但访问不了具体文件夹（提示文件名称不存在）</span></span><br><span class="line"><span class="comment"># LanmanWorkstation是一个核心网络服务，作用是系统能够连接到网络上的其他资源，例如访问局域网内的任何共享文件夹或打印机。</span></span><br><span class="line">net stop LanmanWorkstation</span><br><span class="line">net start LanmanWorkstation</span><br><span class="line"></span><br><span class="line"><span class="comment"># 系统服务相关</span></span><br><span class="line"><span class="comment"># 启动系统服务，sc start发送启动命令后会退出，不会阻塞等待是否启动启动</span></span><br><span class="line">net start <span class="string">&quot;Service Name&quot;</span></span><br><span class="line"><span class="comment"># 停止系统服务</span></span><br><span class="line">net stop <span class="string">&quot;Service Name&quot;</span></span><br><span class="line"><span class="comment"># 暂停系统服务（需服务支持）</span></span><br><span class="line">net pause <span class="string">&quot;Service Name&quot;</span></span><br><span class="line"><span class="comment"># 继续已暂停的服务</span></span><br><span class="line">net <span class="built_in">continue</span> <span class="string">&quot;Service Name&quot;</span></span><br></pre></td></tr></table></figure><h1 id="netxx工具（Windows）">8 &nbsp&nbsp<a href="#netxx工具（Windows）" class="headerlink" title="netxx工具（Windows）"></a>net<code>xx</code>工具（Windows）</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 网络重置，重置Windows的网络核心组件（Winsock目录）到初始状态</span></span><br><span class="line">netsh winsock reset</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重置TCP/IP协议栈</span></span><br><span class="line">netsh int ip reset</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分别针对IPv4或IPv6协议进行重置</span></span><br><span class="line">netsh interface ipv4 reset</span><br><span class="line">netsh interface ipv6 reset</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看Windows Defender防火墙状态</span></span><br><span class="line">netsh advfirewall show allprofiles</span><br><span class="line"><span class="comment"># 重置Windows Defender防火墙的所有策略</span></span><br><span class="line">netsh advfirewall reset</span><br><span class="line"><span class="comment"># 打开Windows Defender防火墙</span></span><br><span class="line">netsh advfirewall <span class="built_in">set</span> allprofiles state on</span><br><span class="line"><span class="comment"># 关闭Windows Defender防火墙</span></span><br><span class="line">netsh advfirewall <span class="built_in">set</span> allprofiles state off</span><br><span class="line"></span><br><span class="line"><span class="comment"># nbtstat关注的是局域网，NetBIOS是一种网络通信协议，用于在局域网中识别计算机，即局域网名称识别。清除NetBIOS名称缓存有助于解决与NetBIOS名称相关的问题。</span></span><br><span class="line"><span class="comment"># Reload，清除并重新加载远程名称缓存表</span></span><br><span class="line">nbtstat -R</span><br><span class="line"><span class="comment"># ReleaseRefresh，清除NetBIOS名称缓存，还释放并重建NetBIOS名称缓存，例如解决局域网内“网上邻居”看不到对方的问题</span></span><br><span class="line">nbtstat -RR</span><br></pre></td></tr></table></figure><h1 id="netstat工具">9 &nbsp&nbsp<a href="#netstat工具" class="headerlink" title="netstat工具"></a>netstat工具</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># netstat关注的是整体网络，例如所有基于TCP/IP的连接、端口监听状态和路由表</span></span><br><span class="line"><span class="comment"># netstat输出格式：Proto(协议)：通常是TCP或UDP；Local Address(本地地址，本机系统IP和端口)；Foreign Address(外部地址，远程主机的IP和端口)；State(状态)：指示TCP连接的状态</span></span><br><span class="line"><span class="comment"># 显示所有连接、不解析域名、带进程PID：常用于查找特定被占用端口，例如软件提示Port 8080 is already in use</span></span><br><span class="line">netstat -ano | findstr :8080 <span class="comment"># windows写法</span></span><br><span class="line">netstat -napt | grep :8080 <span class="comment"># linux写法</span></span><br><span class="line"><span class="comment"># 显示所有活动的TCP连接数以及计算机正在侦听的TCP和UDP端口。</span></span><br><span class="line">netstat -a</span><br><span class="line"><span class="comment"># 显示活动的TCP连接数，地址和端口号以数字表示，不会使用域名或者https/http代表443/80端口号这种名称表示。</span></span><br><span class="line"><span class="comment"># 操作系统中存在一个名为services的纯文本文件。类似于“端口字典”，记录了数字与名称的对应关系。Windows路径：C:\Windows\System32\drivers\etc\services；Linux/macOS路径：/etc/services</span></span><br><span class="line">netstat -n</span><br><span class="line"><span class="comment"># 显示活动的TCP连接数，并包括每个连接的进程ID(PID)。</span></span><br><span class="line">netstat -o</span><br><span class="line"><span class="comment"># 显示指定的协议的连接，可以指定tcp、udp、icmp、ip、tcpv6、udpv6、icmpv6或ipv6</span></span><br><span class="line">netstat -p tcp</span><br><span class="line"><span class="comment"># 显示IP路由表的内容。 这等效于route print命令。</span></span><br><span class="line">netstat -r</span><br><span class="line"><span class="comment"># 显示TCP连接统计信息</span></span><br><span class="line">netstat -s</span><br></pre></td></tr></table></figure><h1 id="ping工具">10 &nbsp&nbsp<a href="#ping工具" class="headerlink" title="ping工具"></a>ping工具</h1><p>ping命令是属于网络层的ICMP协议的，用于检查IP的连通性或网络连接速度，是无法用于检测IP的端口状态。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  验证本地计算机上TCP/IP协议栈是否正常工作，TCP/IP协议栈是一个整体基础套件，并非指单个协议</span></span><br><span class="line"><span class="comment"># localhost 是一个域名，在过去它指向 127.0.0.1 这个 IP 地址。在操作系统支持 ipv6 后，它同时还指向 ipv6 的地址 [::1]</span></span><br><span class="line">ping 127.0.0.1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证本机 IP 地址是否配置完成或者网卡物理属性是否完好，本机IP地址：192.168.1.55</span></span><br><span class="line">ping 192.168.1.55</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证从本机到网关的物理线路是否连通，网关地址：192.168.1.1</span></span><br><span class="line">ping 192.168.1.1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以用于测试特定时长的网络连通性，例如是否存在网卡断流</span></span><br><span class="line"><span class="comment"># ping 1800次，ping每秒进行一次，1800次相当于30分钟</span></span><br><span class="line">ping qq.com -n 1800</span><br><span class="line"></span><br><span class="line"><span class="comment"># -t 持续发送Ping请求，Linux系统中默认就是持续发送，不需要-t参数</span></span><br><span class="line"><span class="comment"># -l 1400，设置发送的 ICMP 回显请求数据包的大小 为 1400 字节。Windows 默认发送 32 字节</span></span><br><span class="line"><span class="comment"># -f，在数据包中设置 &quot;不分段&quot;（Don&#x27;t Fragment）标志。这指示数据包在传输路径中不允许被路由器分片。若路由器的MTU为1500字节，则不分段能设置最大数据为1472字节数据（1500-20字节IP头-8字节ICMP头）</span></span><br><span class="line">ping qq.com -t -l 1400 -f</span><br></pre></td></tr></table></figure><h1 id="tracert工具（Windows）">11 &nbsp&nbsp<a href="#tracert工具（Windows）" class="headerlink" title="tracert工具（Windows）"></a>tracert工具（Windows）</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示从本机到目标主机的路由信息</span></span><br><span class="line"><span class="comment"># 目标地址跟踪数据包到达目的主机的路径，可以探测网络故障是发生在哪一个位置</span></span><br><span class="line">tracert qq.com</span><br></pre></td></tr></table></figure><h1 id="traceroute工具（Linux）">12 &nbsp&nbsp<a href="#traceroute工具（Linux）" class="headerlink" title="traceroute工具（Linux）"></a>traceroute工具（Linux）</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示从本机到目标主机的路由信息</span></span><br><span class="line"><span class="comment"># 目标地址跟踪数据包到达目的主机的路径，可以探测网络故障是发生在哪一个位置</span></span><br><span class="line">traceroute qq.com</span><br></pre></td></tr></table></figure><h1 id="pathping">13 &nbsp&nbsp<a href="#pathping" class="headerlink" title="pathping"></a>pathping</h1><p>路由追踪工具，目标是路径+质量统计，类似于综合了tracert和ping的功能。</p><p>在压力测试阶段，这个工具会向路径上的每一个节点发送大量的包（默认每跳100个）。这种行为容易触发网关防火墙的频率限制，因此该命令容易跟丢</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pathping qq.com</span><br></pre></td></tr></table></figure><h1 id="telnet工具">14 &nbsp&nbsp<a href="#telnet工具" class="headerlink" title="telnet工具"></a>telnet工具</h1><ul><li>应用层协议命令，用于远程登录，也可用于检测IP的端口状态，但无法查看ping值和实现监控。</li><li>Windows系统有自带，但默认未启用，需要在「启用或关闭Windows功能」中勾选启用<code>Telnet Client</code>。</li></ul><h1 id="tcping工具">15 &nbsp&nbsp<a href="#tcping工具" class="headerlink" title="tcping工具"></a>tcping工具</h1><p>传输层协议命令。通过TCP的握手和挥手的时间差来判断端口的打开与延迟），可用于检测IP端口状态和查看ping值，即使源地址禁用ICMP协议的ping，也可以通过tcping来监控网络状态。</p><p>如下有一些三方实现的tcping仓库链接：</p><ul><li><a href="https://github.com/pouriyajamshidi/tcping">pouriyajamshidi&#x2F;tcping</a></li><li><a href="https://github.com/cloverstd/tcping">cloverstd&#x2F;tcping</a></li><li><a href="https://elifulkerson.com/projects/tcping.php">elifulkerson&#x2F;tcping</a></li></ul><h1 id="ipconfig工具（Windows）">16 &nbsp&nbsp<a href="#ipconfig工具（Windows）" class="headerlink" title="ipconfig工具（Windows）"></a>ipconfig工具（Windows）</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示本机网卡IP地址</span></span><br><span class="line">ipconfig</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示所有网络接口的配置参数</span></span><br><span class="line">ipconfig /all</span><br><span class="line"></span><br><span class="line"><span class="comment"># 刷新DNS缓存</span></span><br><span class="line">ipconfig /flushdns</span><br><span class="line"></span><br><span class="line"><span class="comment"># 释放当前网络适配器的IP地址，向DHCP服务器发送一个DHCPRELEASE报文，告知不再使用此IP</span></span><br><span class="line"><span class="comment"># 网络连接会中断，分配一个169.254.66.206的链路本地地址</span></span><br><span class="line">ipconfig /release</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新网络适配器的IP地址</span></span><br><span class="line"><span class="comment"># 触发DHCP租约过程。计算机发送DHCPDISCOVER或DHCPREQUEST广播，请求DHCP服务器分配或延长IP使用权</span></span><br><span class="line">ipconfig /renew</span><br></pre></td></tr></table></figure><h1 id="ifconfig工具（Linux）">17 &nbsp&nbsp<a href="#ifconfig工具（Linux）" class="headerlink" title="ifconfig工具（Linux）"></a>ifconfig工具（Linux）</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示本机网卡IP地址</span></span><br><span class="line">ifconfig</span><br><span class="line">ip addr show</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示所有网络接口的配置参数</span></span><br><span class="line">ifconfig -a</span><br><span class="line"></span><br><span class="line"><span class="comment"># 刷新DNS缓存</span></span><br><span class="line"><span class="built_in">sudo</span> systemd-resolve --flush-caches</span><br></pre></td></tr></table></figure><h1 id="nslookup工具">18 &nbsp&nbsp<a href="#nslookup工具" class="headerlink" title="nslookup工具"></a>nslookup工具</h1><p>查询域名系统（DNS）记录，该工具也会自动显示出当前系统的DNS服务器地址。</p><p>一般用来检测本机的DNS设置是否配置正确。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询qq.com的DNS记录的IP地址</span></span><br><span class="line">nslookup qq.com</span><br><span class="line"></span><br><span class="line"><span class="comment"># 反查IP对应的域名，该用法不常用</span></span><br><span class="line">nslookup 1.1.1.1</span><br></pre></td></tr></table></figure><h1 id="iperf3工具">19 &nbsp&nbsp<a href="#iperf3工具" class="headerlink" title="iperf3工具"></a>iperf3工具</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -c以客户端模式运行，后面接服务端地址，-p指定端口，-n指定传输数据量，1T代表1TB数据</span></span><br><span class="line">iperf3 -c 192.168.1.1 -p 5201 -n 1tb</span><br><span class="line"></span><br><span class="line"><span class="comment"># -s 以服务端模式运行，-p 指定端口</span></span><br><span class="line">iperf3 -s -p 5201</span><br></pre></td></tr></table></figure><h1 id="arp工具">20 &nbsp&nbsp<a href="#arp工具" class="headerlink" title="arp工具"></a>arp工具</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示本地ARP缓存表</span></span><br><span class="line"><span class="comment"># 显示当前局域网内所有已通信设备的IP与MAC地址对应关系</span></span><br><span class="line">arp -a</span><br></pre></td></tr></table></figure><h1 id="参考文献">21 &nbsp&nbsp<a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p>[1] TCP连接的11种状态[EB&#x2F;OL]. <a href="https://www.cnblogs.com/JCpeng/p/15016816.html">https://www.cnblogs.com/JCpeng/p/15016816.html</a>.</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h1 id=&quot;网线线序&quot;&gt;1 &amp;nbsp&amp;nbsp&lt;a href=&quot;#网线线序&quot; class=&quot;headerlink&quot;</summary>
        
      
    
    
    
    <category term="troubleshooting" scheme="https://mister-kin.github.io/categories/troubleshooting/"/>
    
    
    <category term="总结" scheme="https://mister-kin.github.io/tags/%E6%80%BB%E7%BB%93/"/>
    
    <category term="故障" scheme="https://mister-kin.github.io/tags/%E6%95%85%E9%9A%9C/"/>
    
    <category term="网络" scheme="https://mister-kin.github.io/tags/%E7%BD%91%E7%BB%9C/"/>
    
    <category term="排障" scheme="https://mister-kin.github.io/tags/%E6%8E%92%E9%9A%9C/"/>
    
    <category term="调试" scheme="https://mister-kin.github.io/tags/%E8%B0%83%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>飞牛fnOS | 二次修改AutoBangumi的RSS条目名称和URL</title>
    <link href="https://mister-kin.github.io/post-articles/2025-11/modify-autobangumi-rss-item-for-fnos/"/>
    <id>https://mister-kin.github.io/post-articles/2025-11/modify-autobangumi-rss-item-for-fnos/</id>
    <published>2025-11-24T12:30:32.000Z</published>
    <updated>2025-11-30T17:19:56.000Z</updated>
    
    <content type="html"><![CDATA[<p>一般RSS订阅链接导入到AutoBangumi之后，是无法二次修改RSS条目名称和URL的，正如AutoBangumi软件界面上没有任何UI可供用户操作修改。</p><p>但是某些情况下是想要实现二次修改，而非删除并重新导入。</p><p>以我的一个使用场景为例，以前在下载《仙逆》剧集时，使用的RSS订阅链接是基于mikan搜索结果的RSS链接<code>https://mikanime.tv/RSS/Search?searchstr=%E4%BB%99%E9%80%86</code>。因此<br>AutoBangumi自动识别该RSS条目的名称为「国漫」，而AutoBangumi会根据该名称创建创建对应名称的文件夹。</p><p>而我一直想要重命名这条RSS条目的名称和重新修改对应URL，如果考虑删除并重新导入RSS链接的话，后台qBittorrent需要重新同时接收处理一百多个下载任务。这么大量的处理任务，意味着qBittorrent将一段时间内都无法正常响应，这显然是不可接受的。</p><p>那还有没有其他办法能实现二次修改呢？其实有，从数据库角度入手即可。AutoBangumi数据库是基于SQLite，因此可以通过修改SQLite数据库文件来实现二次修改。</p><div class="flex-row"><div class="flex-column"><img data-src="/images/post-articles/2025-11/modify-autobangumi-rss-item-for-fnos/bangumi-list.webp">bangumi列表</div><div class="flex-column"><img data-src="/images/post-articles/2025-11/modify-autobangumi-rss-item-for-fnos/rss-item-change-before.webp">RSS条目</div></div><h1 id="测试平台">1 &nbsp&nbsp<a href="#测试平台" class="headerlink" title="测试平台"></a>测试平台</h1><ul><li>飞牛: fnOS 1.0.0</li><li>AutoBangumi: 3.1.18</li></ul><h1 id="准备工作">2 &nbsp&nbsp<a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><blockquote><p>当然，你也可以选择使用Navicat这类可视化工具来操作修改数据库，GUI操作比较简单，这里不再展开叙述。</p></blockquote><h2 id="SQLite命令行操作工具">2.1 &nbsp&nbsp<a href="#SQLite命令行操作工具" class="headerlink" title="SQLite命令行操作工具"></a>SQLite命令行操作工具</h2><p><code>sqlite-tools-win-x64</code>下载地址：<a href="https://www.sqlite.org/download.html">https://www.sqlite.org/download.html</a></p><p>解压<code>sqlite-tools-win-x64-3510000.zip</code>，其中的<code>sqlite3.exe</code>程序就是SQLite命令行操作工具。</p><h2 id="AutoBangumi的数据库文件">2.2 &nbsp&nbsp<a href="#AutoBangumi的数据库文件" class="headerlink" title="AutoBangumi的数据库文件"></a>AutoBangumi的数据库文件</h2><p>AutoBangumi数据库文件路径如下：</p><ul><li>文件管理路径：<code>应用文件-&gt;AutoBangumi-&gt;data-&gt;data.db</code></li><li>对应的系统原始路径：<code>/vol1/@appshare/AutoBangumi/data/data.db</code></li></ul><div class="flex-column"><img data-src="/images/post-articles/2025-11/modify-autobangumi-rss-item-for-fnos/database-path.webp">数据库文件路径</div><h2 id="AutoBangumi数据库的表结构">2.3 &nbsp&nbsp<a href="#AutoBangumi数据库的表结构" class="headerlink" title="AutoBangumi数据库的表结构"></a>AutoBangumi数据库的表结构</h2><p><code>bangumi</code>表结构和<code>rssitem</code>表结构如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; .schema bangumi</span><br><span class="line"><span class="comment"># bangumi表结构</span></span><br><span class="line">CREATE TABLE bangumi (</span><br><span class="line">        <span class="built_in">id</span> INTEGER NOT NULL,</span><br><span class="line">        official_title VARCHAR NOT NULL,</span><br><span class="line">        year VARCHAR,</span><br><span class="line">        title_raw VARCHAR NOT NULL,</span><br><span class="line">        season INTEGER NOT NULL,</span><br><span class="line">        season_raw VARCHAR,</span><br><span class="line">        group_name VARCHAR,</span><br><span class="line">        dpi VARCHAR,</span><br><span class="line">        <span class="built_in">source</span> VARCHAR,</span><br><span class="line">        subtitle VARCHAR,</span><br><span class="line">        eps_collect BOOLEAN NOT NULL,</span><br><span class="line">        <span class="string">&quot;offset&quot;</span> INTEGER NOT NULL,</span><br><span class="line">        filter VARCHAR NOT NULL,</span><br><span class="line">        rss_link VARCHAR NOT NULL,</span><br><span class="line">        poster_link VARCHAR,</span><br><span class="line">        added BOOLEAN NOT NULL,</span><br><span class="line">        rule_name VARCHAR,</span><br><span class="line">        save_path VARCHAR,</span><br><span class="line">        deleted BOOLEAN NOT NULL,</span><br><span class="line">        PRIMARY KEY (<span class="built_in">id</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">sqlite&gt; .schema rssitem</span><br><span class="line"><span class="comment"># rssitem表结构</span></span><br><span class="line">CREATE TABLE rssitem (</span><br><span class="line">        <span class="built_in">id</span> INTEGER NOT NULL,</span><br><span class="line">        name VARCHAR,</span><br><span class="line">        url VARCHAR NOT NULL,</span><br><span class="line">        aggregate BOOLEAN NOT NULL,</span><br><span class="line">        parser VARCHAR NOT NULL,</span><br><span class="line">        enabled BOOLEAN NOT NULL,</span><br><span class="line">        PRIMARY KEY (<span class="built_in">id</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h1 id="实操演示：修改RSS条目名称和URL">3 &nbsp&nbsp<a href="#实操演示：修改RSS条目名称和URL" class="headerlink" title="实操演示：修改RSS条目名称和URL"></a>实操演示：修改RSS条目名称和URL</h1><h2 id="停用应用并下载数据库文件">3.1 &nbsp&nbsp<a href="#停用应用并下载数据库文件" class="headerlink" title="停用应用并下载数据库文件"></a>停用应用并下载数据库文件</h2><p>在下载<code>data.db</code>文件之前，需要先在「应用中心」停用AutoBangumi应用，避免有新数据写入。</p><h2 id="修改数据库中的数据">3.2 &nbsp&nbsp<a href="#修改数据库中的数据" class="headerlink" title="修改数据库中的数据"></a>修改数据库中的数据</h2><blockquote><p>以下操作均为在Windows系统中使用Git Bash终端执行。</p></blockquote><p>接下来，以修改一条RSS条目的名称和URL为例，具体操作步骤：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打开data.db数据库文件</span></span><br><span class="line">./sqlite3 data.db</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列举所有表名</span></span><br><span class="line">sqlite&gt; .tables</span><br><span class="line">bangumi  rssitem  torrent  user</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询bangumi表中数据</span></span><br><span class="line">sqlite&gt; <span class="keyword">select</span> * from bangumi;</span><br><span class="line">3|仙逆||Renegade Immortal|1||GM-Team|1080P||GB|1|0|720,\d+-\d|https://mikanime.tv/RSS/Search?searchstr=%E4%BB%99%E9%80%86|posters/d7bfd97a.jpg|1||/vol1/1000/下载/仙逆/Season 1|0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询rssitem表中数据</span></span><br><span class="line">sqlite&gt; <span class="keyword">select</span> * from rssitem;</span><br><span class="line">3|国漫|https://mikanime.tv/RSS/Search?searchstr=%E4%BB%99%E9%80%86|0|mikan|1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改数据库中的数据</span></span><br><span class="line">sqlite&gt; update rssitem <span class="built_in">set</span> name=<span class="string">&#x27;仙逆&#x27;</span> <span class="built_in">where</span> <span class="built_in">id</span>=3;</span><br><span class="line">sqlite&gt; update rssitem <span class="built_in">set</span> url=<span class="string">&#x27;https://mikanime.tv/RSS/Search?searchstr=GM-Team+%E4%BB%99%E9%80%86&#x27;</span> <span class="built_in">where</span> <span class="built_in">id</span>=3;</span><br><span class="line">sqlite&gt; update bangumi <span class="built_in">set</span> rss_link =<span class="string">&#x27;https://mikanime.tv/RSS/Search?searchstr=GM-Team+%E4%BB%99%E9%80%86&#x27;</span> <span class="built_in">where</span> <span class="built_in">id</span>=3;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 二次查询表中数据，以确认查案最新数据</span></span><br><span class="line">sqlite&gt; <span class="keyword">select</span> * from bangumi;</span><br><span class="line">3|仙逆||Renegade Immortal|1||GM-Team|1080P||GB|1|0|720,\d+-\d|https://mikanime.tv/RSS/Search?searchstr=GM-Team+%E4%BB%99%E9%80%86|posters/d7bfd97a.jpg|1||/vol1/1000/下载/仙逆/Season 1|0</span><br><span class="line"></span><br><span class="line">sqlite&gt; <span class="keyword">select</span> * from rssitem;</span><br><span class="line">3|仙逆|https://mikanime.tv/RSS/Search?searchstr=GM-Team+%E4%BB%99%E9%80%86|0|mikan|1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 退出sqlite提示符</span></span><br><span class="line">sqlite&gt; .quit</span><br></pre></td></tr></table></figure><p>注：如果修改RSS条目中的URL字段的话，建议同时更新<code>rssitem</code>和<code>bangumi</code>两个表的对应数据，避免出现潜在问题。</p><h2 id="上传覆盖数据库文件并重启应用">3.3 &nbsp&nbsp<a href="#上传覆盖数据库文件并重启应用" class="headerlink" title="上传覆盖数据库文件并重启应用"></a>上传覆盖数据库文件并重启应用</h2><p>修改完成后，将修改后的<code>data.db</code>文件上传到<code>应用文件-&gt;AutoBangumi-&gt;data-&gt;data.db</code>，覆盖原始的<code>data.db</code>文件。</p><p>然后重新启用AutoBangumi应用，即可看到修改后的RSS条目名称和URL。</p><div class="flex-column"><img data-src="/images/post-articles/2025-11/modify-autobangumi-rss-item-for-fnos/rss-item-change-after.webp">修改后的RSS条目</div>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;一般RSS订阅链接导入到AutoBangumi之后，是无法二次修改RSS条目名称和URL的，正如AutoBangumi软件界面上没有任何UI可供用户操作修改。&lt;/p&gt;
&lt;p&gt;但是某些情况下是想要实现二次修改，而非删除并重新导入。&lt;/p&gt;
&lt;p&gt;以我的一个使用场景为例，以前在</summary>
        
      
    
    
    
    <category term="post-articles" scheme="https://mister-kin.github.io/categories/post-articles/"/>
    
    <category term="2025-11" scheme="https://mister-kin.github.io/categories/post-articles/2025-11/"/>
    
    
    <category term="fnOS" scheme="https://mister-kin.github.io/tags/fnOS/"/>
    
    <category term="飞牛" scheme="https://mister-kin.github.io/tags/%E9%A3%9E%E7%89%9B/"/>
    
    <category term="HomeLab" scheme="https://mister-kin.github.io/tags/HomeLab/"/>
    
    <category term="AutoBangumi" scheme="https://mister-kin.github.io/tags/AutoBangumi/"/>
    
    <category term="mikan" scheme="https://mister-kin.github.io/tags/mikan/"/>
    
    <category term="NAS" scheme="https://mister-kin.github.io/tags/NAS/"/>
    
  </entry>
  
  <entry>
    <title>三种方法屏蔽PVE虚拟化系统无有效订阅提示弹窗</title>
    <link href="https://mister-kin.github.io/post-articles/2025-11/three-ways-disable-subscribe-for-pve/"/>
    <id>https://mister-kin.github.io/post-articles/2025-11/three-ways-disable-subscribe-for-pve/</id>
    <published>2025-11-22T14:13:13.000Z</published>
    <updated>2025-11-23T16:19:04.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言">1 &nbsp&nbsp<a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>之前在探索<a href="/post-articles/2025-11/correct-way-disable-subscribe-for-pve9x/">正确屏蔽PVE 9.x版本系统无有效订阅提示弹窗的方法</a>时，浏览了网络上不少相关技术帖子，累计总结记录了三种方法。今天来聊聊这三种方法的原理和不同点。</p><h1 id="方法一：修改订阅状态检测逻辑">2 &nbsp&nbsp<a href="#方法一：修改订阅状态检测逻辑" class="headerlink" title="方法一：修改订阅状态检测逻辑"></a>方法一：修改订阅状态检测逻辑</h1><p>这是笔者自行探索总结出来的方法。</p><ul><li>原理：通过修改订阅状态检测的条件判断，将严格不等于<code>!==</code>改为严格等于<code>===</code>，本质上仅替换一个字符。当系统检测订阅状态时，原本需要状态为&quot;active&quot;才不显示警告，修改后只要状态不是&quot;active&quot;就不会触发警告弹窗，从而实现屏蔽了未订阅提示。</li><li>优缺点：<strong>完美适配PVE 9.x版本</strong>，不会导致PVE的WEB后台「软件包版本」按钮无法响应。</li><li>适用PVE版本范围：经测试PVE 8.x和PVE 9.x版本有效，理论上兼容PVE 7.x及以前版本。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js.bak</span><br><span class="line"></span><br><span class="line">line_num=$(grep -n <span class="string">&quot;res.data.status.toLowerCase() !== &#x27;active&#x27;&quot;</span> /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js | <span class="built_in">head</span> -1 | <span class="built_in">cut</span> -d: -f1)</span><br><span class="line">sed -i <span class="string">&quot;<span class="variable">$&#123;line_num&#125;</span>s/!==/===/&quot;</span> /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js</span><br><span class="line"></span><br><span class="line">systemctl restart pveproxy</span><br></pre></td></tr></table></figure><h1 id="方法二：禁用弹窗显示函数">3 &nbsp&nbsp<a href="#方法二：禁用弹窗显示函数" class="headerlink" title="方法二：禁用弹窗显示函数"></a>方法二：禁用弹窗显示函数</h1><p>该方法是从Github上<a href="https://github.com/Mapleawaa/PVE-Tools-9">PVE-Tools-9</a>项目中找到的。</p><ul><li>原理：通过将Ext.Msg.show函数调用替换为void表达式，使弹窗显示函数失效。void操作符会计算表达式但返回undefined，从而阻止了弹窗的实际显示。</li><li>优缺点：<strong>不能完美适配PVE 9.x版本</strong>，导致PVE的WEB后台「软件包版本」按钮无法响应。</li><li>适用PVE版本范围：理论上兼容所有版本。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js.bak</span><br><span class="line"></span><br><span class="line">sed -Ezi <span class="string">&quot;s/(Ext.Msg.show\(\&#123;\s+title: gettext\(&#x27;No valid sub)/void\(\&#123; \/\/\1/g&quot;</span> /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js</span><br><span class="line"></span><br><span class="line">systemctl restart pveproxy</span><br></pre></td></tr></table></figure><h1 id="方法三：重写条件判断表达式">4 &nbsp&nbsp<a href="#方法三：重写条件判断表达式" class="headerlink" title="方法三：重写条件判断表达式"></a>方法三：重写条件判断表达式</h1><p>这是网络上流传最广的方法，绝大部分教程都是基于此方法。</p><ul><li>原理：彻底重写订阅检测的条件判断逻辑，将复杂的条件检查替换为简单的false值。通过两个sed命令分别处理条件语句的起始部分和状态检测部分，使整个条件判断永远返回false，从而跳过弹窗显示代码。</li><li>优缺点：<strong>同方法二，不能完美适配PVE 9.x版本</strong>，会导致「软件包版本」按钮无法响应。</li><li>适用PVE版本范围：理论上兼容所有版本。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js.bak</span><br><span class="line"></span><br><span class="line">sed -i <span class="string">&quot;s/if (res === null || res === undefined || \!res || res/if(/g&quot;</span> /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js</span><br><span class="line">sed -i <span class="string">&quot;s/.data.status.toLowerCase() !== &#x27;active&#x27;/false/g&quot;</span> /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js</span><br><span class="line"></span><br><span class="line">systemctl restart pveproxy</span><br></pre></td></tr></table></figure><h1 id="后记">5 &nbsp&nbsp<a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>上述三种方法同样适用于屏蔽PBS备份系统的无有效订阅提示弹窗，即<code>Proxmox Backup Server</code>，修改文件操作完成之后重启PBS代理服务即可。</p><p>此外，对于PBS系统来说，这三种方法均能正确实现屏蔽作用，无其他影响。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart proxmox-backup-proxy</span><br></pre></td></tr></table></figure><h1 id="参考文献">6 &nbsp&nbsp<a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p>[1] PVE-Tools[EB&#x2F;OL]. <a href="https://github.com/Mapleawaa/PVE-Tools-9/blob/main/PVE-Tools.sh">https://github.com/Mapleawaa/PVE-Tools-9/blob/main/PVE-Tools.sh</a>.</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;1 &amp;nbsp&amp;nbsp&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;之前在探索&lt;a</summary>
        
      
    
    
    
    <category term="post-articles" scheme="https://mister-kin.github.io/categories/post-articles/"/>
    
    <category term="2025-11" scheme="https://mister-kin.github.io/categories/post-articles/2025-11/"/>
    
    
    <category term="虚拟化系统" scheme="https://mister-kin.github.io/tags/%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F/"/>
    
    <category term="HomeLab" scheme="https://mister-kin.github.io/tags/HomeLab/"/>
    
    <category term="PVE" scheme="https://mister-kin.github.io/tags/PVE/"/>
    
    <category term="Proxmox" scheme="https://mister-kin.github.io/tags/Proxmox/"/>
    
    <category term="服务器" scheme="https://mister-kin.github.io/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
    <category term="屏蔽订阅弹窗" scheme="https://mister-kin.github.io/tags/%E5%B1%8F%E8%94%BD%E8%AE%A2%E9%98%85%E5%BC%B9%E7%AA%97/"/>
    
    <category term="PBS" scheme="https://mister-kin.github.io/tags/PBS/"/>
    
  </entry>
  
  <entry>
    <title>正确屏蔽PVE 9.x版本系统无有效订阅提示弹窗的方法</title>
    <link href="https://mister-kin.github.io/post-articles/2025-11/correct-way-disable-subscribe-for-pve9x/"/>
    <id>https://mister-kin.github.io/post-articles/2025-11/correct-way-disable-subscribe-for-pve9x/</id>
    <published>2025-11-22T04:52:00.000Z</published>
    <updated>2025-11-23T16:19:04.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言">1 &nbsp&nbsp<a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>之前在<a href="/post-articles/2025-10/pve8to9/">PVE虚拟化系统升级小记（8.x-&gt;9.x）</a>中有提到过，PVE 9.x版本执行屏蔽无有效订阅提示弹窗的老方法之后，会导致PVE的WEB后台「软件包版本」按钮无法响应。</p><p>经过重新对<code>/usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js</code>文件代码的分析和修改测试，笔者总结出另一种可行的新方法。</p><h1 id="问题分析">2 &nbsp&nbsp<a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h1><p>PVE 9.x的版本，除了每次登录WEB后台会显示无有效订阅提示弹窗之外，在点击「软件包版本」按钮时，首先也会弹出「无有效订阅」的提示弹窗，然后再跳转到软件包版本页面。</p><p>以前版本没有这种逻辑。笔者推测应该是这个原因导致旧方法不能完美适配PVE 9.x版本。</p><div class="flex-column"><img data-src="/images/software/pve/pve9x-check-package-version.webp">PVE 9.x版本「软件包版本」按钮的逻辑</div><p>旧方法的命令操作步骤：该方法核心原理修改替换关系表达式条件，但无法完美适配PVE 9.x版本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js.bak</span><br><span class="line"></span><br><span class="line">sed -i <span class="string">&quot;s/if (res === null || res === undefined || \!res || res/if(/g&quot;</span> /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js</span><br><span class="line">sed -i <span class="string">&quot;s/.data.status.toLowerCase() !== &#x27;active&#x27;/false/g&quot;</span> /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js</span><br><span class="line"></span><br><span class="line">systemctl restart pveproxy</span><br></pre></td></tr></table></figure><h1 id="新方法：完美适配PVE-9-x版本">3 &nbsp&nbsp<a href="#新方法：完美适配PVE-9-x版本" class="headerlink" title="新方法：完美适配PVE 9.x版本"></a>新方法：完美适配PVE 9.x版本</h1><p>新方法的核心原理是替换关系表达式符号，其本质仅仅是替换一个字符而已，即将<code>!==</code>替换为<code>===</code>，不同于旧方法原理的修改替换关系表达式条件。</p><p>新方法的命令操作步骤：新方法完美适配PVE 9.x版本，不会导致PVE的WEB后台「软件包版本」按钮无法响应。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js.bak</span><br><span class="line"></span><br><span class="line">line_num=$(grep -n <span class="string">&quot;res.data.status.toLowerCase() !== &#x27;active&#x27;&quot;</span> /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js | <span class="built_in">head</span> -1 | <span class="built_in">cut</span> -d: -f1)</span><br><span class="line">sed -i <span class="string">&quot;<span class="variable">$&#123;line_num&#125;</span>s/!==/===/&quot;</span> /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js</span><br><span class="line"></span><br><span class="line">systemctl restart pveproxy</span><br></pre></td></tr></table></figure><div class="flex-column"><img data-src="/images/software/pve/pve9x-check-package-version-no-popup.webp">新方法的效果：完美适配PVE 9.x版本</div><h1 id="后记">4 &nbsp&nbsp<a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>这个新方法同样适用于屏蔽PBS备份系统的无有效订阅提示弹窗，即<code>Proxmox Backup Server</code>，修改文件操作完成之后重启PBS代理服务即可。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart proxmox-backup-proxy</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;1 &amp;nbsp&amp;nbsp&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;之前在&lt;a</summary>
        
      
    
    
    
    <category term="post-articles" scheme="https://mister-kin.github.io/categories/post-articles/"/>
    
    <category term="2025-11" scheme="https://mister-kin.github.io/categories/post-articles/2025-11/"/>
    
    
    <category term="虚拟化系统" scheme="https://mister-kin.github.io/tags/%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F/"/>
    
    <category term="HomeLab" scheme="https://mister-kin.github.io/tags/HomeLab/"/>
    
    <category term="PVE" scheme="https://mister-kin.github.io/tags/PVE/"/>
    
    <category term="Proxmox" scheme="https://mister-kin.github.io/tags/Proxmox/"/>
    
    <category term="服务器" scheme="https://mister-kin.github.io/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
    <category term="屏蔽订阅弹窗" scheme="https://mister-kin.github.io/tags/%E5%B1%8F%E8%94%BD%E8%AE%A2%E9%98%85%E5%BC%B9%E7%AA%97/"/>
    
    <category term="PBS" scheme="https://mister-kin.github.io/tags/PBS/"/>
    
  </entry>
  
  <entry>
    <title>著名激活工具MAS更新v3.8</title>
    <link href="https://mister-kin.github.io/post-articles/2025-11/mas-38/"/>
    <id>https://mister-kin.github.io/post-articles/2025-11/mas-38/</id>
    <published>2025-11-12T11:47:31.000Z</published>
    <updated>2025-11-12T15:26:54.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言">1 &nbsp&nbsp<a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>Gtihub上著名的Windows和Office激活工具Microsoft Activation Scripts (MAS)，最近更新到了v3.8版本。</p><p>本次更新移除了KMS38激活的功能，主要原因是26100.7019内部版本号开始，该激活方式已失效。推荐用户改用HWID或TSforge方式激活。</p><p>最新版MAS激活脚本文件获取方式见文章末尾。</p><h1 id="v3-8版本更新内容">2 &nbsp&nbsp<a href="#v3-8版本更新内容" class="headerlink" title="v3.8版本更新内容"></a>v3.8版本更新内容</h1><ul><li>HWID<ul><li>为WNC版本添加了激活支持。</li></ul></li><li>KMS38<ul><li>从内部版本26100.7019开始，Microsoft完全弃用了clip-based的KMS许可证迁移功能。结论是KMS38已失效。详细信息参阅「<a href="https://massgrave.dev/kms38">kms38</a>」。</li><li>KMS38现已从MAS脚本中删除。建议用户改用HWID或TSforge激活。</li><li>如果仍希望在旧的Windows版本上使用它或将其保留用于存档目的，可以从<a href="https://github.com/massgravel/Microsoft-Activation-Scripts/blob/ab6b572af940fa0ea4255b327eb6f69a274d6725/MAS/Separate-Files-Version/Activators/KMS38_Activation.cmd">此处</a>下载脚本。</li></ul></li><li>TSforge<ul><li>从内部版本26100.7019开始，如果实际的期限更长，Windows将始终显示并保持在180天剩余的KMS宽限期。KMS4k信息将根据此更改进行更新。</li><li>添加了对PPIPro的ESU支持（在19045.6388中添加）。</li><li>修复了筛选中ESUID未显示在手动选项中的问题。</li><li>添加了刷新ESU状态的命令。</li></ul></li><li>更改Windows版本<ul><li>更改了密钥首选项顺序，以便可以安装HWID密钥。</li><li>为“IoTEnterprise”版本添加了[GAC,notLTSC]信息，以避免与其LTSC版本“IoTEnterpriseS”混淆。</li></ul></li><li>解决问题<ul><li>该脚本现在将自动选择Office16.0C2R的“快速修复”选项。</li><li>在重建ClipSVC许可证之前添加了更多条件。</li></ul></li><li>检查激活状态<ul><li>修复了CAS中的一个问题，即当ADBA处于活动状态时，会显示KMS客户端信息。</li></ul></li><li>其他<ul><li>错误处理和信息方面的其他一些小改进。</li></ul></li></ul><h1 id="最新版MAS下载地址">3 &nbsp&nbsp<a href="#最新版MAS下载地址" class="headerlink" title="最新版MAS下载地址"></a>最新版MAS下载地址</h1><h2 id="PowerShell获取">3.1 &nbsp&nbsp<a href="#PowerShell获取" class="headerlink" title="PowerShell获取"></a>PowerShell获取</h2><ul><li>Windows 8, 10, 11：<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">irm</span> https://get.activated.win | <span class="built_in">iex</span></span><br></pre></td></tr></table></figure></li><li>如果上面一条的命令不生效，例如网络被阻断，可以尝试这条命令（适用于Windows10或者11）：<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">iex</span> (curl.exe <span class="literal">-s</span> <span class="literal">--doh-url</span> https://<span class="number">1.1</span>.<span class="number">1.1</span>/dns<span class="literal">-query</span> https://get.activated.win | <span class="built_in">Out-String</span>)</span><br></pre></td></tr></table></figure></li><li>Windows 7及之后版本：<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">iex</span> ((<span class="built_in">New-Object</span> Net.WebClient).DownloadString(<span class="string">&#x27;https://get.activated.win&#x27;</span>))</span><br></pre></td></tr></table></figure></li></ul><h2 id="传统下载方式">3.2 &nbsp&nbsp<a href="#传统下载方式" class="headerlink" title="传统下载方式"></a>传统下载方式</h2><ul><li><a href="https://dev.azure.com/massgrave/Microsoft-Activation-Scripts/_apis/git/repositories/Microsoft-Activation-Scripts/items?path=/MAS/All-In-One-Version-KL/MAS_AIO.cmd&download=true">MAS_AIO.cmd</a></li><li><a href="https://dev.azure.com/massgrave/Microsoft-Activation-Scripts/_apis/git/repositories/Microsoft-Activation-Scripts/items?format=zip">full ZIP</a></li></ul><h1 id="参考文献">4 &nbsp&nbsp<a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p>[1] v3.8 R.I.P. KMS38[EB&#x2F;OL]. <a href="https://github.com/massgravel/Microsoft-Activation-Scripts/releases/tag/3.8">https://github.com/massgravel/Microsoft-Activation-Scripts/releases/tag/3.8</a>.</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;1 &amp;nbsp&amp;nbsp&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;Gtihub上著名的Windows和Office激活工具Microsoft Activation Scripts</summary>
        
      
    
    
    
    <category term="post-articles" scheme="https://mister-kin.github.io/categories/post-articles/"/>
    
    <category term="2025-11" scheme="https://mister-kin.github.io/categories/post-articles/2025-11/"/>
    
    
    <category term="脚本" scheme="https://mister-kin.github.io/tags/%E8%84%9A%E6%9C%AC/"/>
    
    <category term="Windows" scheme="https://mister-kin.github.io/tags/Windows/"/>
    
    <category term="激活工具" scheme="https://mister-kin.github.io/tags/%E6%BF%80%E6%B4%BB%E5%B7%A5%E5%85%B7/"/>
    
    <category term="Office" scheme="https://mister-kin.github.io/tags/Office/"/>
    
    <category term="MAS" scheme="https://mister-kin.github.io/tags/MAS/"/>
    
    <category term="免费" scheme="https://mister-kin.github.io/tags/%E5%85%8D%E8%B4%B9/"/>
    
    <category term="开源" scheme="https://mister-kin.github.io/tags/%E5%BC%80%E6%BA%90/"/>
    
  </entry>
  
  <entry>
    <title>Windows累积更新KB5068861发布推送：修复「任务管理器」无法正常结束的BUG</title>
    <link href="https://mister-kin.github.io/post-articles/2025-11/windows-kb5068861/"/>
    <id>https://mister-kin.github.io/post-articles/2025-11/windows-kb5068861/</id>
    <published>2025-11-12T09:14:06.000Z</published>
    <updated>2025-11-12T10:32:16.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言">1 &nbsp&nbsp<a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>上月末，微软推送KB5067036累积更新后，引入了一个新BUG会导致「关闭任务管理器后，任务管理器进程可能会继续在后台运行」。</p><p>该KB5067036累积更新，适用于系统内部版本号26x00.7019，详细对应系统内部版本号26200.7019（即Windows 11 25H2）和26100.7019（即Windows 11 24H2）。</p><p>这些未能正确关闭的进程每个会占用系统内存资源，长期使用的情况下会导致整体系统性能受到影响，对于那些习惯使用睡眠或者休眠模式的用户来说，尤为明显。系统在长期未重启的情况下，日常使用任务管理器的过程中，累积了很多后台任务管理器进程，导致用户的内存资源在不知不觉中被吃掉。</p><h1 id="BUG确认被修复">2 &nbsp&nbsp<a href="#BUG确认被修复" class="headerlink" title="BUG确认被修复"></a>BUG确认被修复</h1><p>今日早些时候，微软终于推送了KB5068861累积更新，修复了这个BUG。</p><p><strong>笔者安装该累积更新后实测，确认该BUG确实已被修复了。强烈推荐26x00.7019版本的用户下载安装该累积更新。</strong></p><p>通过反复打开并关闭任务管理器，然后通过终端尝试查找关闭<code>taskmgr.exe</code>进程：</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">taskkill</span> /f /im taskmgr.exe</span><br></pre></td></tr></table></figure><p>系统提示无法找到<code>taskmgr.exe</code>进程：</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ERROR: <span class="title">The</span> <span class="title">process</span> &quot;<span class="title">taskmgr.exe</span>&quot; <span class="title">not</span> <span class="title">found</span>.</span></span><br></pre></td></tr></table></figure><h1 id="KB5068861累积更新内容">3 &nbsp&nbsp<a href="#KB5068861累积更新内容" class="headerlink" title="KB5068861累积更新内容"></a>KB5068861累积更新内容</h1><p>KB5068861累积更新，适用于系统内部版本号26x00.7171，详细对应系统内部版本号26200.7171（即Windows 11 25H2）和26100.7171（即Windows 11 24H2）。该版本大致更新内容如下：</p><ul><li>[游戏]<ul><li>已修复：此更新解决了影响游戏手持设备的问题。 这些设备无法保持低功耗状态，这导致电池消耗得更快。</li><li>已修复：此更新解决了某些手持游戏设备上的问题，即使用内置游戏板登录后，控制器可能在大约五秒钟内在应用中不响应，从而导致延迟。 提交密码或 PIN 后，登录屏幕上的触摸键盘会自动隐藏。</li></ul></li><li>[存储] 已修复：此更新解决了创建存储群集时可能导致某些存储空间不可访问或存储空间直通失败的问题。</li><li>[系统实用工具 (已知问题)] 已修复：此更新解决了以下问题：使用“关闭”按钮关闭任务管理器不会完全结束该过程，从而留下可能会随时间推移降低性能的后台实例。  安装 KB5067036 后可能会发生这种情况。</li><li>[语音访问] 已修复：此更新解决了未连接麦克风且未安装语音模型时，语音 访问 在初始设置期间失败的问题。</li><li>[窗口管理] 已修复：此更新解决了选择桌面可能会意外打开 任务视图的问题。</li><li>[网络]已修复：此更新修复了 HTTP.sys 请求分析器中的问题，这是一个读取和处理 HTTP 请求的 Windows 组件。 分析程序允许在 HTTP&#x2F;1.1 区块扩展内单行中断，其中 RFC 9112 标准要求回车和换行符 (CRLF) 序列终止每个区块。 当前端代理是设置的一部分时，这可能会导致分析差异。<br>若要关闭严格分析，请使用以下注册表项：<br>注册表项： [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Http\Parameters]<br>注册表值： &quot;HttpAllowLenientChunkExtParsing&quot;&#x3D;dword:00000001<br>要设置的数据：1</li></ul><h1 id="参考文献">4 &nbsp&nbsp<a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p>[1] November 11, 2025—KB5068861 (OS Builds 26200.7171 and 26100.7171)[EB&#x2F;OL]. <a href="https://support.microsoft.com/en-us/topic/november-11-2025-kb5068861-os-builds-26200-7171-and-26100-7171-2e0512e4-3ad4-4da6-958c-a468a1af949e">https://support.microsoft.com/en-us/topic/november-11-2025-kb5068861-os-builds-26200-7171-and-26100-7171-2e0512e4-3ad4-4da6-958c-a468a1af949e</a>.</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;1 &amp;nbsp&amp;nbsp&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot;</summary>
        
      
    
    
    
    <category term="post-articles" scheme="https://mister-kin.github.io/categories/post-articles/"/>
    
    <category term="2025-11" scheme="https://mister-kin.github.io/categories/post-articles/2025-11/"/>
    
    
    <category term="Windows" scheme="https://mister-kin.github.io/tags/Windows/"/>
    
    <category term="KB5068861" scheme="https://mister-kin.github.io/tags/KB5068861/"/>
    
    <category term="累积更新" scheme="https://mister-kin.github.io/tags/%E7%B4%AF%E7%A7%AF%E6%9B%B4%E6%96%B0/"/>
    
  </entry>
  
  <entry>
    <title>PVE清理旧内核</title>
    <link href="https://mister-kin.github.io/post-articles/2025-11/pve-kernel-cleaner/"/>
    <id>https://mister-kin.github.io/post-articles/2025-11/pve-kernel-cleaner/</id>
    <published>2025-11-11T12:08:55.000Z</published>
    <updated>2025-11-11T14:15:49.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言">1 &nbsp&nbsp<a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>家里HomeLab的PVE虚拟化系统服务器，历经几次小版本升级和一次大版本更新，系统上已经有不少个内核。</p><p>一般来说，<code>apt autoremove</code>命令可以完成清理卸载内核相关的文件，但dpkg数据库一般仍有保留相关包的记录。</p><p>今天来聊聊如何彻底清除PVE系统上的旧内核，包括从dpkg数据库中移除记录。</p><h1 id="查看PVE现有的内核">2 &nbsp&nbsp<a href="#查看PVE现有的内核" class="headerlink" title="查看PVE现有的内核"></a>查看PVE现有的内核</h1><p><code>proxmox-boot-tool</code>工具默认会配置当前运行的内核以及两个最新安装的内核，因此在保留最新两个内核的情况下，清理剩余的旧内核即可。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看当前内核版本</span></span><br><span class="line"><span class="built_in">uname</span> -r</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看proxmox-boot-tool工具配置选择的用于启动booting的内核</span></span><br><span class="line">proxmox-boot-tool kernel list</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询所有包含kernel关键词的包名及其状态（已安装/已卸载），输出格式为：&lt;包名&gt; &lt;状态&gt;</span></span><br><span class="line">dpkg --get-selections | grep kernel</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询PVE内核包并自动排序，排除当前内核版本，输出格式为：&lt;内核版本&gt;</span></span><br><span class="line">dpkg --list | grep <span class="string">&#x27;kernel-.*-pve&#x27;</span> | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span> | grep -v <span class="string">&quot;6.14.11-4-pve&quot;</span> | <span class="built_in">sort</span> -V</span><br></pre></td></tr></table></figure><p>以笔者的情况为例（上述命令输出如下结果），因此后续清理步骤中，保留输出结果中两个内核版本：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 当前内核版本</span></span><br><span class="line">6.14.11-4-pve</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用于启动booting的内核</span></span><br><span class="line">Manually selected kernels:</span><br><span class="line">None.</span><br><span class="line"></span><br><span class="line">Automatically selected kernels:</span><br><span class="line">6.14.11-4-pve</span><br><span class="line">6.8.12-16-pve</span><br><span class="line"></span><br><span class="line"><span class="comment"># 所有kernel包名及其状态</span></span><br><span class="line"><span class="comment"># 有些包状态显示为已卸载，像apt autoremove卸载清理之后就会这样，但dpkg数据库中还存在包的记录，dpkg会标记为已卸载</span></span><br><span class="line">proxmox-default-kernel                          install</span><br><span class="line">proxmox-kernel-6.14                             install</span><br><span class="line">proxmox-kernel-6.14.11-4-pve-signed             install</span><br><span class="line">proxmox-kernel-6.8                              install</span><br><span class="line">proxmox-kernel-6.8.12-10-pve-signed             deinstall</span><br><span class="line">proxmox-kernel-6.8.12-11-pve-signed             deinstall</span><br><span class="line">proxmox-kernel-6.8.12-16-pve-signed             install</span><br><span class="line">proxmox-kernel-6.8.12-9-pve-signed              deinstall</span><br><span class="line">proxmox-kernel-helper                           install</span><br><span class="line"></span><br><span class="line"><span class="comment"># 排除当前内核版本的所有内核包的排序结果</span></span><br><span class="line">proxmox-kernel-6.8.12-9-pve-signed</span><br><span class="line">proxmox-kernel-6.8.12-10-pve-signed</span><br><span class="line">proxmox-kernel-6.8.12-11-pve-signed</span><br><span class="line">proxmox-kernel-6.8.12-16-pve-signed</span><br></pre></td></tr></table></figure><h1 id="清理内核的方法">3 &nbsp&nbsp<a href="#清理内核的方法" class="headerlink" title="清理内核的方法"></a>清理内核的方法</h1><h2 id="方法一：使用社区的内核清理脚本kernel-clean-sh">3.1 &nbsp&nbsp<a href="#方法一：使用社区的内核清理脚本kernel-clean-sh" class="headerlink" title="方法一：使用社区的内核清理脚本kernel-clean.sh"></a>方法一：使用社区的内核清理脚本<code>kernel-clean.sh</code></h2><p>下载执行脚本<code>kernel-clean.sh</code>，输入想要卸载的内核版本序列号，有多个则用英文逗号<code>,</code>间隔</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget https://raw.githubusercontent.com/community-scripts/ProxmoxVE/main/tools/pve/kernel-clean.sh</span><br><span class="line"><span class="built_in">chmod</span> +x kernel-clean.sh</span><br><span class="line">./kernel-clean.sh</span><br></pre></td></tr></table></figure><div class="flex-column"><img data-src="/images/software/pve/kernel-cleaner.webp">kernel-clean.sh清理过程</div><h2 id="方法二：手动清理内核">3.2 &nbsp&nbsp<a href="#方法二：手动清理内核" class="headerlink" title="方法二：手动清理内核"></a>方法二：手动清理内核</h2><p>以卸载<code>proxmox-kernel-6.8.12-11-pve-signed</code>内核包为例，执行如下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt purge -y proxmox-kernel-6.8.12-11-pve-signed</span><br><span class="line">apt autoremove -y</span><br><span class="line">update-grub</span><br></pre></td></tr></table></figure><div class="flex-column"><img data-src="/images/software/pve/kernel-cleaner-manual.webp">手动清理内核过程</div>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;1 &amp;nbsp&amp;nbsp&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot;</summary>
        
      
    
    
    
    <category term="post-articles" scheme="https://mister-kin.github.io/categories/post-articles/"/>
    
    <category term="2025-11" scheme="https://mister-kin.github.io/categories/post-articles/2025-11/"/>
    
    
    <category term="虚拟化系统" scheme="https://mister-kin.github.io/tags/%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F/"/>
    
    <category term="HomeLab" scheme="https://mister-kin.github.io/tags/HomeLab/"/>
    
    <category term="PVE" scheme="https://mister-kin.github.io/tags/PVE/"/>
    
    <category term="Proxmox" scheme="https://mister-kin.github.io/tags/Proxmox/"/>
    
    <category term="服务器" scheme="https://mister-kin.github.io/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
    <category term="清理旧内核" scheme="https://mister-kin.github.io/tags/%E6%B8%85%E7%90%86%E6%97%A7%E5%86%85%E6%A0%B8/"/>
    
  </entry>
  
  <entry>
    <title>PVE备份服务器PBS升级小记（3.x-&gt;4.x）</title>
    <link href="https://mister-kin.github.io/post-articles/2025-11/pve-pbs3to4/"/>
    <id>https://mister-kin.github.io/post-articles/2025-11/pve-pbs3to4/</id>
    <published>2025-11-07T21:59:26.000Z</published>
    <updated>2025-11-09T14:48:13.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言">1 &nbsp&nbsp<a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>之前顺利完成了升级虚拟化系统<code>Proxmox VE</code>9.0版本及其相关的虚拟机LXC容器的系统版本，详情可参阅「<a href="/post-articles/2025-10/pve8to9">PVE虚拟化系统升级小记（8.x-&gt;9.x）</a>」和「<a href="/post-articles/2025-11/pve-lxc-debian12to13">PVE虚拟机LXC容器升级小记(Debian12-&gt;13)</a>」。</p><p>正巧企业软件开发商<code>Proxmox Server Solutions GmbH</code>在2025年8月6日发布了<code>Proxmox Backup Server</code>4.0版本，因此今天来聊聊如何将PVE的备份服务器<code>Proxmox Backup Server</code>从3.x版本升级到4.x版本。以下将<code>Proxmox Backup Server</code>简称为<code>PBS</code>。</p><h1 id="升级到PBS-3-x最新的版本">2 &nbsp&nbsp<a href="#升级到PBS-3-x最新的版本" class="headerlink" title="升级到PBS 3.x最新的版本"></a>升级到PBS 3.x最新的版本</h1><blockquote><p>开始正式升级前，请记得将PBS的部署机器环境的Debian系统也升级到Debian13（即<code>Trixie</code>），这里不再赘述，详情可参阅「<a href="/post-articles/2025-11/pve-lxc-debian12to13">PVE虚拟机LXC容器升级小记(Debian12-&gt;13)</a>」。</p></blockquote><p>输入如下命令完成升级并查看当前PBS版本：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt update &amp;&amp; apt dist-upgrade -y</span><br><span class="line">proxmox-backup-manager versions</span><br></pre></td></tr></table></figure><h1 id="检查版本升级的兼容性">3 &nbsp&nbsp<a href="#检查版本升级的兼容性" class="headerlink" title="检查版本升级的兼容性"></a>检查版本升级的兼容性</h1><p>输入如下命令检查PBS版本的兼容性，如果存在ERROR报错，解决报错信息再重新运行检查命令，直到没有报错为止：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pbs3to4</span><br></pre></td></tr></table></figure><h1 id="替换PBS-4-x的软件源">4 &nbsp&nbsp<a href="#替换PBS-4-x的软件源" class="headerlink" title="替换PBS 4.x的软件源"></a>替换PBS 4.x的软件源</h1><p>执行如下命令完成替换成中科大镜像源：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> deb http://mirrors.ustc.edu.cn/proxmox/debian/pbs trixie pbs-no-subscription &gt; /etc/apt/sources.list.d/pbs-enterprise.list</span><br></pre></td></tr></table></figure><h1 id="开始正式升级（3-x-4-x）">5 &nbsp&nbsp<a href="#开始正式升级（3-x-4-x）" class="headerlink" title="开始正式升级（3.x-&gt;4.x）"></a>开始正式升级（3.x-&gt;4.x）</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt update &amp;&amp; apt dist-upgrade -y</span><br></pre></td></tr></table></figure><p>升级中会出现一些交互界面，以下是实操选择的参数：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Configuration file <span class="string">&#x27;/etc/issue&#x27;</span></span><br><span class="line">==&gt; Modified (by you or by a script) since installation.</span><br><span class="line">==&gt; Package distributor has shipped an updated version.</span><br><span class="line">What would you like to <span class="keyword">do</span> about it ?  Your options are:</span><br><span class="line">    Y or I  : install the package maintainer<span class="string">&#x27;s version</span></span><br><span class="line"><span class="string">    N or O  : keep your currently-installed version</span></span><br><span class="line"><span class="string">    D     : show the differences between the versions</span></span><br><span class="line"><span class="string">    Z     : start a shell to examine the situation</span></span><br><span class="line"><span class="string">The default action is to keep your current version.</span></span><br><span class="line"><span class="string">*** issue (Y/I/N/O/D/Z) [default=N] ?</span></span><br><span class="line"><span class="string">输入N回车</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">┌────────────────────────────────────────────┤ Configuring libc6:amd64 ├────────────────────────────────────────────┐</span></span><br><span class="line"><span class="string">│                                                                                                                   │</span></span><br><span class="line"><span class="string">│ There are services installed on your system which need to be restarted when certain libraries, such as libpam,    │</span></span><br><span class="line"><span class="string">│ libc, and libssl, are upgraded. Since these restarts may cause interruptions of service for the system, you will  │</span></span><br><span class="line"><span class="string">│ normally be prompted on each upgrade for the list of services you wish to restart.  You can choose this option    │</span></span><br><span class="line"><span class="string">│ to avoid being prompted; instead, all necessary restarts will be done for you automatically so you can avoid      │</span></span><br><span class="line"><span class="string">│ being asked questions on each library upgrade.                                                                    │</span></span><br><span class="line"><span class="string">│                                                                                                                   │</span></span><br><span class="line"><span class="string">│ Restart services during package upgrades without asking?                                                          │</span></span><br><span class="line"><span class="string">│                                                                                                                   │</span></span><br><span class="line"><span class="string">│                                  &lt;Yes&gt;                                     &lt;No&gt;                                   │</span></span><br><span class="line"><span class="string">│                                                                                                                   │</span></span><br><span class="line"><span class="string">└───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘</span></span><br><span class="line"><span class="string">选择Yes回车</span></span><br></pre></td></tr></table></figure><h1 id="屏蔽PBS-4-x企业源pbs-enterprise-sources">6 &nbsp&nbsp<a href="#屏蔽PBS-4-x企业源pbs-enterprise-sources" class="headerlink" title="屏蔽PBS 4.x企业源pbs-enterprise.sources"></a>屏蔽PBS 4.x企业源<code>pbs-enterprise.sources</code></h1><p>成功升级至PBS 4.x之后，会自动生成一个<code>DEB822</code>格式的企业源<code>pbs-enterprise.sources</code>文件，需要手动屏蔽它，否则WEB后台和<code>apt update</code>会有提示。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> /etc/apt/sources.list.d/pbs-enterprise.sources /etc/apt/sources.list.d/pbs-enterprise.sources.bak</span><br><span class="line">apt update</span><br></pre></td></tr></table></figure><h1 id="去除PBS未订阅提示">7 &nbsp&nbsp<a href="#去除PBS未订阅提示" class="headerlink" title="去除PBS未订阅提示"></a>去除PBS未订阅提示</h1><p>Proxmox Backup Server和PVE操作类似，修改<code>/usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js</code>文件。</p><p>注销浏览器当前的PBS登录信息，并重新登录就没有提示弹窗了。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js.bak</span><br><span class="line"></span><br><span class="line">sed -i <span class="string">&quot;s/if (res === null || res === undefined || \!res || res/if(/g&quot;</span> /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js</span><br><span class="line">sed -i <span class="string">&quot;s/.data.status.toLowerCase() !== &#x27;active&#x27;/false/g&quot;</span> /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js</span><br><span class="line"></span><br><span class="line">systemctl restart proxmox-backup</span><br></pre></td></tr></table></figure><div class="flex-column"><img data-src="/images/software/pve/pbs-no-subscribe.webp">PBS「无有效订阅」的提示弹窗</div><h1 id="成功升级PBS-4-x">8 &nbsp&nbsp<a href="#成功升级PBS-4-x" class="headerlink" title="成功升级PBS 4.x"></a>成功升级PBS 4.x</h1><p>以下就是升级到最新的PBS 4.x版本的WEB后台界面了。</p><div class="flex-column"><img data-src="/images/software/pve/pbs4x-web-control.webp">PBS 4.x的WEB后台界面</div><h1 id="参考文献">9 &nbsp&nbsp<a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p>[1] Upgrade from 3 to 4[EB&#x2F;OL]. <a href="https://pbs.proxmox.com/wiki/Upgrade_from_3_to_4">https://pbs.proxmox.com/wiki/Upgrade_from_3_to_4</a>.</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;1 &amp;nbsp&amp;nbsp&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;之前顺利完成了升级虚拟化系统&lt;code&gt;Proxmox</summary>
        
      
    
    
    
    <category term="post-articles" scheme="https://mister-kin.github.io/categories/post-articles/"/>
    
    <category term="2025-11" scheme="https://mister-kin.github.io/categories/post-articles/2025-11/"/>
    
    
    <category term="虚拟化系统" scheme="https://mister-kin.github.io/tags/%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F/"/>
    
    <category term="HomeLab" scheme="https://mister-kin.github.io/tags/HomeLab/"/>
    
    <category term="PVE" scheme="https://mister-kin.github.io/tags/PVE/"/>
    
    <category term="升级" scheme="https://mister-kin.github.io/tags/%E5%8D%87%E7%BA%A7/"/>
    
    <category term="Proxmox" scheme="https://mister-kin.github.io/tags/Proxmox/"/>
    
    <category term="服务器" scheme="https://mister-kin.github.io/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
    <category term="PBS" scheme="https://mister-kin.github.io/tags/PBS/"/>
    
    <category term="备份服务器" scheme="https://mister-kin.github.io/tags/%E5%A4%87%E4%BB%BD%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>禁用飞牛fnOS的SSH密码登录，避免被爆破登录入侵</title>
    <link href="https://mister-kin.github.io/post-articles/2025-11/disable-ssh-password-for-fnos/"/>
    <id>https://mister-kin.github.io/post-articles/2025-11/disable-ssh-password-for-fnos/</id>
    <published>2025-11-06T14:56:24.000Z</published>
    <updated>2025-11-07T15:47:15.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言">1 &nbsp&nbsp<a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>之前写过一篇文章，介绍禁用Debian系统SSH服务端的密码登录功能，以防被不法分子爆破登录入侵。详情可以参阅「<a href="/post-articles/2025-10/disable-ssh-password">禁用SSH服务的密码登录功能以防被爆破</a>」</p><p>今天来介绍讲解一下如何为飞牛fnOS系统禁用SSH服务端的密码登录功能，改用SSH密钥登录方式，这样即使长期保持开启SSH服务，也不用害怕被爆破登录入侵。</p><p>如果飞牛fnOS系统是部署暴露在公网的话，推荐是禁用密码登录功能，改用密钥登录。如果仅部署在家里局域网的话，那可以不用担心这个问题。</p><h1 id="开启飞牛SSH服务端功能">2 &nbsp&nbsp<a href="#开启飞牛SSH服务端功能" class="headerlink" title="开启飞牛SSH服务端功能"></a>开启飞牛SSH服务端功能</h1><p>首先需要做的第一步，自然是打开飞牛fnOS的SSH服务端功能。</p><div class="flex-column"><img data-src="/images/post-articles/2025-10/auto-emtpy-bin-for-fnos/enable-ssh.webp">启用飞牛fnOS的SSH功能</div><h1 id="生成SSH密钥和公钥">3 &nbsp&nbsp<a href="#生成SSH密钥和公钥" class="headerlink" title="生成SSH密钥和公钥"></a>生成SSH密钥和公钥</h1><p>在任意机器上生成SSH密钥和公钥（若已有密钥可以跳过该步骤）：<code>-C</code>参数是设置密钥注释，就是备注字眼方便辨识，<code>outside</code>是代表在家庭局域网之外使用的含义，读者可以自定义其他注释;<code>-f</code>参数是将密钥和公钥生成到特定路径下的文件中，<code>~/.ssh/outside_id_ed25519</code>是代表是生成在<code>~/.ssh/</code>路径下。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建密钥和公钥时，若不输入密码直接回车创建的话，代表无密码。</span></span><br><span class="line">ssh-keygen -t ed25519 -C <span class="string">&quot;outside&quot;</span> -f ~/.ssh/outside_id_ed25519</span><br></pre></td></tr></table></figure><p>然后获取前面生成的密钥文件<code>outside_id_ed25519</code>和公钥文件<code>outside_id_ed25519.pub</code>。不同系统下<code>~/.ssh/</code>对应的路径如下：</p><ul><li>Windows：<code>%USERPROFILE%/.ssh</code>或者<code>C:/Users/[系统用户名]/.ssh</code></li><li>Linux：<code>~/</code>对应的是当前登录用户家目录的路径，如果是<code>root</code>用户就是在<code>/root/.ssh</code>中；普通用户就是在<code>/home/[系统用户名]/.ssh</code>，直接<code>cd</code>到该路径就行。</li></ul><h1 id="登入飞牛fnOS系统终端">4 &nbsp&nbsp<a href="#登入飞牛fnOS系统终端" class="headerlink" title="登入飞牛fnOS系统终端"></a>登入飞牛fnOS系统终端</h1><h2 id="方式一：使用其他平台的SSH客户端">4.1 &nbsp&nbsp<a href="#方式一：使用其他平台的SSH客户端" class="headerlink" title="方式一：使用其他平台的SSH客户端"></a>方式一：使用其他平台的SSH客户端</h2><p>开启SSH功能之后，可以在其他平台的终端，输入如下命令登录飞牛fnOS系统。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ssh 系统用户名@飞牛ip</span><br><span class="line"><span class="comment"># 例如 ssh admin@192.168.1.10</span></span><br><span class="line"><span class="comment"># admin是创建fnOS时的系统用户名称，请根据自己实际情况修改</span></span><br><span class="line"><span class="comment"># 然后输入用户密码完成验证即可登录</span></span><br></pre></td></tr></table></figure><h2 id="方式二：搜索安装FntermX-终端应用">4.2 &nbsp&nbsp<a href="#方式二：搜索安装FntermX-终端应用" class="headerlink" title="方式二：搜索安装FntermX 终端应用"></a>方式二：搜索安装<code>FntermX 终端</code>应用</h2><p>在飞牛fnOS的应用中心中搜索<code>FntermX 终端</code>关键字，找到应用并安装。</p><div class="flex-column"><img data-src="/images/post-articles/2025-11/fntermx-for-fnos/store-page.webp">应用中心页面-FntermX 终端</div><p>然后创建本地终端连接会话接入飞牛fnOS系统终端。</p><div class="flex-column"><img data-src="/images/post-articles/2025-11/fntermx-for-fnos/local-terminal.webp">本地终端连接</div><h1 id="上传公钥到飞牛fnOS系统">5 &nbsp&nbsp<a href="#上传公钥到飞牛fnOS系统" class="headerlink" title="上传公钥到飞牛fnOS系统"></a>上传公钥到飞牛fnOS系统</h1><p>在飞牛的终端上，编辑<code>authorized_keys</code>文件，并复制粘贴<code>outside_id_ed25519.pub</code>的内容到<code>authorized_keys</code>文件里面，有多个公钥的话，则分行输入。当然，也可以使用<code>ssh-copy-id</code>命令完成上传公钥，这里不再展开，以下介绍手动编辑的方式。<code>nano</code>编辑器保存快捷键是<code>Ctrl+O</code>或者<code>Ctrl+S</code>，退出编辑器快捷键是<code>Ctrl+X</code>。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 若不存在~/.ssh路径，则先创建该文件夹</span></span><br><span class="line"><span class="built_in">mkdir</span> -p ~/.ssh</span><br><span class="line"><span class="built_in">sudo</span> nano ~/.ssh/authorized_keys</span><br><span class="line"><span class="comment"># 将公钥文件内容复制到authorized_keys文件中</span></span><br></pre></td></tr></table></figure><div class="flex-column"><img data-src="/images/post-articles/2025-11/disable-ssh-password-for-fnos/authorized-keys.webp">authorized_keys配置文件</div><h1 id="设置禁用飞牛fnOS系统的SSH服务端密码登录">6 &nbsp&nbsp<a href="#设置禁用飞牛fnOS系统的SSH服务端密码登录" class="headerlink" title="设置禁用飞牛fnOS系统的SSH服务端密码登录"></a>设置禁用飞牛fnOS系统的SSH服务端密码登录</h1><p>在飞牛的终端上，编辑<code>sshd_config</code>文件。<code>nano</code>编辑器保存快捷键是<code>Ctrl+O</code>或者<code>Ctrl+S</code>，退出编辑器快捷键是<code>Ctrl+X</code>。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> nano /etc/ssh/sshd_config</span><br><span class="line"><span class="comment"># 找到如下字段修改成右边的值</span></span><br><span class="line">PasswordAuthentication no <span class="comment"># 代表禁用密码登录</span></span><br></pre></td></tr></table></figure><p>同时也能从配置中看到飞牛fnOS系统本身默认是禁用root用户登录SSH：<code>PermitRootLogin no</code>，安全性高。</p><div class="flex-column"><img data-src="/images/post-articles/2025-11/disable-ssh-password-for-fnos/sshd-config.webp">sshd_config配置文件</div><h1 id="重启飞牛fnOS系统SSH服务">7 &nbsp&nbsp<a href="#重启飞牛fnOS系统SSH服务" class="headerlink" title="重启飞牛fnOS系统SSH服务"></a>重启飞牛fnOS系统SSH服务</h1><p>飞牛fnOS系统上重启SSH服务命令及查看SSH服务状态命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl restart sshd.service</span><br><span class="line"><span class="built_in">sudo</span> systemctl status sshd.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果重启sshd.service服务名称提示报错，则改成ssh.service名称执行即可</span></span><br><span class="line"><span class="built_in">sudo</span> systemctl restart ssh.service</span><br></pre></td></tr></table></figure><div class="flex-column"><img data-src="/images/post-articles/2025-11/disable-ssh-password-for-fnos/sshd-service-status.webp">SSHD服务状态</div><h1 id="测试是否禁用成功">8 &nbsp&nbsp<a href="#测试是否禁用成功" class="headerlink" title="测试是否禁用成功"></a>测试是否禁用成功</h1><p>在任意平台的终端，尝试SSH登录飞牛fnOS系统，如果提示<code>Permission denied (publickey)</code>，则代表禁用密码登录成功。</p><div class="flex-column"><img data-src="/images/post-articles/2025-11/disable-ssh-password-for-fnos/disable-effect.webp">禁用密码登录的效果</div>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;1 &amp;nbsp&amp;nbsp&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot;</summary>
        
      
    
    
    
    <category term="post-articles" scheme="https://mister-kin.github.io/categories/post-articles/"/>
    
    <category term="2025-11" scheme="https://mister-kin.github.io/categories/post-articles/2025-11/"/>
    
    
    <category term="fnOS" scheme="https://mister-kin.github.io/tags/fnOS/"/>
    
    <category term="飞牛" scheme="https://mister-kin.github.io/tags/%E9%A3%9E%E7%89%9B/"/>
    
    <category term="SSH" scheme="https://mister-kin.github.io/tags/SSH/"/>
    
    <category term="公钥" scheme="https://mister-kin.github.io/tags/%E5%85%AC%E9%92%A5/"/>
    
    <category term="密钥" scheme="https://mister-kin.github.io/tags/%E5%AF%86%E9%92%A5/"/>
    
  </entry>
  
  <entry>
    <title>飞牛fnOS首款原生终端应用来了！！！</title>
    <link href="https://mister-kin.github.io/post-articles/2025-11/fntermx-for-fnos/"/>
    <id>https://mister-kin.github.io/post-articles/2025-11/fntermx-for-fnos/</id>
    <published>2025-11-06T13:55:24.000Z</published>
    <updated>2025-11-07T15:47:15.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言">1 &nbsp&nbsp<a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>本周四，飞牛fnOS「应用中心」更新上架了好些新应用，其中有一款比较值得推荐，就是由<code>EWEDL</code>开发的<code>FntermX 终端</code>应用，这是在应用中心上架的首款原生终端应用。</p><p>笔者简单使用实验了一下，在<code>FN Connect</code>官网服务器中继连接的条件下，该<code>FntermX 终端</code>应用也能正常使用，确实不错，赞！终归有一款提供终端功能的原生应用了。(ಡωಡ)</p><p>简单命令调试的需求，完全可以使用该应用连接调试，不再需要其他额外的SSH客户端工具了。</p><h1 id="以下简单介绍该应用的安装和使用">2 &nbsp&nbsp<a href="#以下简单介绍该应用的安装和使用" class="headerlink" title="以下简单介绍该应用的安装和使用"></a>以下简单介绍该应用的安装和使用</h1><h2 id="在应用中心中搜索并安装">2.1 &nbsp&nbsp<a href="#在应用中心中搜索并安装" class="headerlink" title="在应用中心中搜索并安装"></a>在应用中心中搜索并安装</h2><p>在应用中心中搜索<code>FntermX 终端</code>关键字，找到应用并安装。</p><div class="flex-column"><img data-src="/images/post-articles/2025-11/fntermx-for-fnos/store-page.webp">应用中心页面-FntermX 终端</div><h2 id="首次启动设置应用密码">2.2 &nbsp&nbsp<a href="#首次启动设置应用密码" class="headerlink" title="首次启动设置应用密码"></a>首次启动设置应用密码</h2><p>首次启动应用时，会弹出交互式窗口，提示创建应用的访问密码。建议创建一个不同于系统的密码，以增强和保证安全性。</p><div class="flex-column"><img data-src="/images/post-articles/2025-11/fntermx-for-fnos/first-setting-pw.webp">首次启用-创建密码</div><h2 id="应用界面">2.3 &nbsp&nbsp<a href="#应用界面" class="headerlink" title="应用界面"></a>应用界面</h2><p>完成首次创建密码之后，打开进入应用界面。</p><div class="flex-column"><img data-src="/images/post-articles/2025-11/fntermx-for-fnos/terminal-gui.webp">终端应用界面</div><h2 id="本地终端连接">2.4 &nbsp&nbsp<a href="#本地终端连接" class="headerlink" title="本地终端连接"></a>本地终端连接</h2><p>终端应用主要提供两种连接方式，一种是创建本地终端连接会话。</p><div class="flex-column"><img data-src="/images/post-articles/2025-11/fntermx-for-fnos/local-terminal.webp">本地终端连接</div><h2 id="远程终端连接">2.5 &nbsp&nbsp<a href="#远程终端连接" class="headerlink" title="远程终端连接"></a>远程终端连接</h2><p>另外一种连接方式则是创建远程终端连接会话。</p><div class="flex-column"><img data-src="/images/post-articles/2025-11/fntermx-for-fnos/remote-terminal.webp">远程终端连接</div><h2 id="应用设置入口">2.6 &nbsp&nbsp<a href="#应用设置入口" class="headerlink" title="应用设置入口"></a>应用设置入口</h2><p>目前终端应用<code>设置</code>入口在应用界面右上角，目前可自定义设置的选项只有「密码管理」。如果需要修改应用访问密码，可以进入<code>设置</code>界面，点击<code>密码管理</code>选项，修改密码。</p><div class="flex-column"><img data-src="/images/post-articles/2025-11/fntermx-for-fnos/setting-page.webp">应用设置界面</div><h1 id="参考文献">3 &nbsp&nbsp<a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p>[1] FntermX 终端——专为飞牛OS打造的原生终端应用[EB&#x2F;OL]. <a href="https://club.fnnas.com/forum.php?mod=viewthread&tid=40652">https://club.fnnas.com/forum.php?mod=viewthread&amp;tid=40652</a>.</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;1 &amp;nbsp&amp;nbsp&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot;</summary>
        
      
    
    
    
    <category term="post-articles" scheme="https://mister-kin.github.io/categories/post-articles/"/>
    
    <category term="2025-11" scheme="https://mister-kin.github.io/categories/post-articles/2025-11/"/>
    
    
    <category term="终端" scheme="https://mister-kin.github.io/tags/%E7%BB%88%E7%AB%AF/"/>
    
    <category term="fnOS" scheme="https://mister-kin.github.io/tags/fnOS/"/>
    
    <category term="飞牛" scheme="https://mister-kin.github.io/tags/%E9%A3%9E%E7%89%9B/"/>
    
    <category term="terminal" scheme="https://mister-kin.github.io/tags/terminal/"/>
    
    <category term="原生" scheme="https://mister-kin.github.io/tags/%E5%8E%9F%E7%94%9F/"/>
    
  </entry>
  
  <entry>
    <title>PVE虚拟机LXC容器升级小记(Debian12-&gt;13)</title>
    <link href="https://mister-kin.github.io/post-articles/2025-11/pve-lxc-debian12to13/"/>
    <id>https://mister-kin.github.io/post-articles/2025-11/pve-lxc-debian12to13/</id>
    <published>2025-11-02T10:11:09.000Z</published>
    <updated>2025-11-07T21:50:48.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言">1 &nbsp&nbsp<a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>之前完成升级了虚拟化系统<code>Proxmox VE</code>9.0版本，因此顺手将PVE系统中虚拟机LXC容器的Debian系统版本也一起从Debian12升级到Debian13版本。</p><p>关于PVE系统的升级步骤，详情可以参阅「<a href="/post-articles/2025-10/pve8to9/">PVE虚拟化系统升级小记（8.x-&gt;9.x）</a>」。</p><blockquote><p>P.S. 首先声明一点：虚拟机LXC容器系统版本即使不升级，其实也能正常运行在<code>Proxmox VE</code>9.0版本中，读者自行斟酌选择是否升级。</p></blockquote><p>LXC容器升级本身并不复杂，跟常规Debian升级类似。接下来介绍LXC容器从Debian12升级到Debian13的步骤。</p><h1 id="替换-Debian-系统软件源">2 &nbsp&nbsp<a href="#替换-Debian-系统软件源" class="headerlink" title="替换 Debian 系统软件源"></a>替换 Debian 系统软件源</h1><p>编辑<code>/etc/apt/sources.list</code>文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano /etc/apt/sources.list</span><br></pre></td></tr></table></figure><p>将文件内容替换为如下中科大镜像源：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># deb http://ftp.debian.org/debian trixie main contrib</span></span><br><span class="line">deb https://mirrors.ustc.edu.cn/debian/ trixie main contrib non-free non-free-firmware</span><br><span class="line"></span><br><span class="line"><span class="comment"># deb http://ftp.debian.org/debian trixie-updates main contrib</span></span><br><span class="line">deb https://mirrors.ustc.edu.cn/debian/ trixie-updates main contrib non-free non-free-firmware</span><br><span class="line"></span><br><span class="line">deb https://mirrors.ustc.edu.cn/debian/ trixie-backports main contrib non-free non-free-firmware</span><br><span class="line"><span class="comment"># security updates</span></span><br><span class="line"><span class="comment"># deb http://security.debian.org trixie-security main contrib</span></span><br><span class="line">deb https://mirrors.ustc.edu.cn/debian-security trixie-security main contrib non-free non-free-firmware</span><br></pre></td></tr></table></figure><h1 id="替换Docker源">3 &nbsp&nbsp<a href="#替换Docker源" class="headerlink" title="替换Docker源"></a>替换Docker源</h1><p>如果LXC容器中有部署docker的话，需要操作替换Docker源。如果没有的话，可以跳过此步骤。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nano /etc/apt/sources.list.d/docker.list</span><br><span class="line"></span><br><span class="line"><span class="comment"># 替换为如下内容</span></span><br><span class="line">deb [<span class="built_in">arch</span>=amd64 signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/debian   trixie stable</span><br></pre></td></tr></table></figure><h1 id="开始正式升级（debian12-debian13）">4 &nbsp&nbsp<a href="#开始正式升级（debian12-debian13）" class="headerlink" title="开始正式升级（debian12-&gt;debian13）"></a>开始正式升级（debian12-&gt;debian13）</h1><p>输入如下命令完成升级：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt update &amp;&amp; apt dist-upgrade -y</span><br></pre></td></tr></table></figure><p>升级中会出现一些交互界面，以下是实操选择的参数：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">┌────────────────────────────────────────────┤ Configuring libc6:amd64 ├────────────────────────────────────────────┐</span><br><span class="line">│                                                                                                                   │</span><br><span class="line">│ There are services installed on your system <span class="built_in">which</span> need to be restarted when certain libraries, such as libpam,    │</span><br><span class="line">│ libc, and libssl, are upgraded. Since these restarts may cause interruptions of service <span class="keyword">for</span> the system, you will  │</span><br><span class="line">│ normally be prompted on each upgrade <span class="keyword">for</span> the list of services you wish to restart.  You can choose this option    │</span><br><span class="line">│ to avoid being prompted; instead, all necessary restarts will be <span class="keyword">done</span> <span class="keyword">for</span> you automatically so you can avoid      │</span><br><span class="line">│ being asked questions on each library upgrade.                                                                    │</span><br><span class="line">│                                                                                                                   │</span><br><span class="line">│ Restart services during package upgrades without asking?                                                          │</span><br><span class="line">│                                                                                                                   │</span><br><span class="line">│                                  &lt;Yes&gt;                                     &lt;No&gt;                                   │</span><br><span class="line">│                                                                                                                   │</span><br><span class="line">└───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘</span><br><span class="line">选择Yes回车</span><br><span class="line"></span><br><span class="line">Configuration file <span class="string">&#x27;/etc/crontab&#x27;</span></span><br><span class="line"> ==&gt; Modified (by you or by a script) since installation.</span><br><span class="line"> ==&gt; Package distributor has shipped an updated version.</span><br><span class="line">   What would you like to <span class="keyword">do</span> about it ?  Your options are:</span><br><span class="line">    Y or I  : install the package maintainer<span class="string">&#x27;s version</span></span><br><span class="line"><span class="string">    N or O  : keep your currently-installed version</span></span><br><span class="line"><span class="string">      D     : show the differences between the versions</span></span><br><span class="line"><span class="string">      Z     : start a shell to examine the situation</span></span><br><span class="line"><span class="string"> The default action is to keep your current version.</span></span><br><span class="line"><span class="string">*** crontab (Y/I/N/O/D/Z) [default=N] ?</span></span><br><span class="line"><span class="string">输入y，根据自己情况来，有使用到crontab定时计划任务的，输入n保留</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Configuration file &#x27;</span>/etc/cron.d/e2scrub_all<span class="string">&#x27;</span></span><br><span class="line"><span class="string"> ==&gt; Modified (by you or by a script) since installation.</span></span><br><span class="line"><span class="string"> ==&gt; Package distributor has shipped an updated version.</span></span><br><span class="line"><span class="string">   What would you like to do about it ?  Your options are:</span></span><br><span class="line"><span class="string">    Y or I  : install the package maintainer&#x27;</span>s version</span><br><span class="line">    N or O  : keep your currently-installed version</span><br><span class="line">      D     : show the differences between the versions</span><br><span class="line">      Z     : start a shell to examine the situation</span><br><span class="line"> The default action is to keep your current version.</span><br><span class="line">*** e2scrub_all (Y/I/N/O/D/Z) [default=N] ?</span><br><span class="line">输入y，和/etc/crontab情况相同</span><br><span class="line"></span><br><span class="line">┌─────────────────────────────────────────┤ Configuring openssh-server ├─────────────────────────────────────────┐</span><br><span class="line">│ A new version (/tmp/tmp.hKOeEqLlCv) of configuration file /etc/ssh/sshd_config is available, but the version   │</span><br><span class="line">│ installed currently has been locally modified.                                                                 │</span><br><span class="line">│                                                                                                                │</span><br><span class="line">│ What <span class="keyword">do</span> you want to <span class="keyword">do</span> about modified configuration file sshd_config?                                          │</span><br><span class="line">│                                                                                                                │</span><br><span class="line">│                              install the package maintainer<span class="string">&#x27;s version                                          │</span></span><br><span class="line"><span class="string">│                              keep the local version currently installed                                        │</span></span><br><span class="line"><span class="string">│                              show the differences between the versions                                         │</span></span><br><span class="line"><span class="string">│                              show a side-by-side difference between the versions                               │</span></span><br><span class="line"><span class="string">│                              show a 3-way difference between available versions                                │</span></span><br><span class="line"><span class="string">│                              do a 3-way merge between available versions                                       │</span></span><br><span class="line"><span class="string">│                              start a new shell to examine the situation                                        │</span></span><br><span class="line"><span class="string">│                                                                                                                │</span></span><br><span class="line"><span class="string">│                                                                                                                │</span></span><br><span class="line"><span class="string">│                                                     &lt;Ok&gt;                                                       │</span></span><br><span class="line"><span class="string">│                                                                                                                │</span></span><br><span class="line"><span class="string">└────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘</span></span><br><span class="line"><span class="string">选择install the package maintainer&#x27;</span>s version，根据自己情况来</span><br></pre></td></tr></table></figure><h1 id="移除无用的包">5 &nbsp&nbsp<a href="#移除无用的包" class="headerlink" title="移除无用的包"></a>移除无用的包</h1><p>运行如下如下命令，移除无用的包，节省服务器空间：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt autoremove</span><br></pre></td></tr></table></figure><h1 id="升级前后的版本记录">6 &nbsp&nbsp<a href="#升级前后的版本记录" class="headerlink" title="升级前后的版本记录"></a>升级前后的版本记录</h1><div class="flex-row"><div class="flex-column"><img data-src="/images/software/pve/debian12.webp">升级前：Debian12</div><div class="flex-column"><img data-src="/images/software/pve/debian13.webp">升级后：Debian13</div></div>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;1 &amp;nbsp&amp;nbsp&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;之前完成升级了虚拟化系统&lt;code&gt;Proxmox</summary>
        
      
    
    
    
    <category term="post-articles" scheme="https://mister-kin.github.io/categories/post-articles/"/>
    
    <category term="2025-11" scheme="https://mister-kin.github.io/categories/post-articles/2025-11/"/>
    
    
    <category term="虚拟化系统" scheme="https://mister-kin.github.io/tags/%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F/"/>
    
    <category term="HomeLab" scheme="https://mister-kin.github.io/tags/HomeLab/"/>
    
    <category term="PVE" scheme="https://mister-kin.github.io/tags/PVE/"/>
    
    <category term="升级" scheme="https://mister-kin.github.io/tags/%E5%8D%87%E7%BA%A7/"/>
    
    <category term="Proxmox" scheme="https://mister-kin.github.io/tags/Proxmox/"/>
    
    <category term="服务器" scheme="https://mister-kin.github.io/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
    <category term="LXC" scheme="https://mister-kin.github.io/tags/LXC/"/>
    
    <category term="Debian" scheme="https://mister-kin.github.io/tags/Debian/"/>
    
  </entry>
  
  <entry>
    <title>PVE虚拟化系统升级小记（8.x-&gt;9.x）</title>
    <link href="https://mister-kin.github.io/post-articles/2025-10/pve8to9/"/>
    <id>https://mister-kin.github.io/post-articles/2025-10/pve8to9/</id>
    <published>2025-10-31T13:03:42.000Z</published>
    <updated>2025-11-09T14:48:13.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言">1 &nbsp&nbsp<a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>企业软件开发商<code>Proxmox Server Solutions GmbH</code>在2025年8月5日发布了<code>Proxmox VE</code>9.0版本，这两天终于得空给家里的HomeLab机器操作升级，因此记录一下从PVE 8.x升级到PVE 9.x步骤。</p><p>为了方便软件包下载，一般需要将linux系统的替换成国内镜像源。这样操作更新时，系统访问的是国内镜像服务器，网络速率就不会受限于每秒几十KB。以下内容替换使用的镜像源均为中科大源。</p><h1 id="升级到PVE-8-x最新的版本">2 &nbsp&nbsp<a href="#升级到PVE-8-x最新的版本" class="headerlink" title="升级到PVE 8.x最新的版本"></a>升级到PVE 8.x最新的版本</h1><p><strong>一般更新操作，都是推荐替换国内镜像源再操作。由于本文主要阐述升级步骤，这里不再赘述如何替换PVE 8.x版本系统的软件源，如想了解可参阅我的博客。</strong></p><p>输入如下命令完成升级并查看当前PVE版本：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt update &amp;&amp; apt dist-upgrade -y</span><br><span class="line">pveversion</span><br></pre></td></tr></table></figure><div class="flex-row"><div class="flex-column"><img data-src="/images/software/pve/pve8x-update-to-lateset.webp">执行apt命令升级</div><div class="flex-column"><img data-src="/images/software/pve/pve8x-lastest-check-version.webp">pveversion查看当前版本</div></div><h1 id="检查版本升级的兼容性">3 &nbsp&nbsp<a href="#检查版本升级的兼容性" class="headerlink" title="检查版本升级的兼容性"></a>检查版本升级的兼容性</h1><p>输入如下命令调用升级检查脚本命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pve8to9</span><br></pre></td></tr></table></figure><p>笔者遇到两个警告WARN和一个失败FAIL。</p><p>警告1：提示有正在运行的客户端，检查程序推荐考虑迁移或者关闭。这个警告笔者是无视的，毕竟HomeLab的主路由和DNS递归查询等服务都是部署在这些虚拟机上，若是关闭，笔者还得额外调整网络参数才能联网。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WARN: 9 running guest(s) detected - consider migrating or stopping them.</span><br></pre></td></tr></table></figure><div class="flex-column"><img data-src="/images/software/pve/pve8to9-warning1.webp">pve8to9警告信息1</div><p>警告2：提示本系统缺乏Intel微码，可无视该警告。想要消除警告，就使用命令安装微码<code>apt install intel-microcode</code>。AMD的CPU机器的微码安装命令为<code>apt install amd64-microcode</code>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">WARN: The matching CPU microcode package &#x27;intel-microcode&#x27; could not be found! Consider installing it to receive the latest security and bug fixes for your CPU.</span><br><span class="line">        Ensure you enable the &#x27;non-free-firmware&#x27; component in the apt sources and run:</span><br><span class="line">        apt install intel-microcode</span><br></pre></td></tr></table></figure><div class="flex-row"><div class="flex-column"><img data-src="/images/software/pve/pve8to9-warning2.webp">pve8to9警告信息2</div><div class="flex-column"><img data-src="/images/software/pve/apt-install-intel-microcode.webp">安装Intel处理器微码</div></div><p>失败：这是因为PVE 9.x版本是基于<code>Debian Trixie</code>版本开发的，这个版本中<code>systemd-boot</code>已经被拆分成三个包<code>systemd-boot-efi</code>、<code>systemd-boot-tools</code>和<code>systemd-boot</code>，因此检查脚本若提示要卸载移除，最好是移除它。解决方法是运行卸载命令<code>apt remove systemd-boot</code>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FAIL: systemd-boot meta-package installed. This will cause problems on upgrades of other boot-related packages. Remove &#x27;systemd-boot&#x27; See https://pve.proxmox.com/wiki/Upgrade_from_8_to_9#sd-boot-warning for more information.</span><br></pre></td></tr></table></figure><div class="flex-row"><div class="flex-column"><img data-src="/images/software/pve/pve8to9-fail.webp">pve8to9失败信息</div><div class="flex-column"><img data-src="/images/software/pve/apt-remove-systemd-boot.webp">移除systemd-boot</div></div><p>注意解在决警告和失败之后，请重新运行检查脚本程序<code>pve8to9</code>，检查没有问题则进行下一步替换PVE 9.x镜像源。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pve8to9</span><br></pre></td></tr></table></figure><div class="flex-column"><img data-src="/images/software/pve/rerun-pve8to9.webp">重新运行检查脚本程序pve8to9</div><h1 id="替换PVE-9-x的软件源">4 &nbsp&nbsp<a href="#替换PVE-9-x的软件源" class="headerlink" title="替换PVE 9.x的软件源"></a>替换PVE 9.x的软件源</h1><h2 id="替换Debian系统软件源">4.1 &nbsp&nbsp<a href="#替换Debian系统软件源" class="headerlink" title="替换Debian系统软件源"></a>替换Debian系统软件源</h2><p>修改&#x2F;etc&#x2F;apt&#x2F;sources.list文件内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> /etc/apt/sources.list /etc/apt/sources.list.bak</span><br><span class="line">nano /etc/apt/sources.list</span><br></pre></td></tr></table></figure><p>使用如下内容覆盖文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># deb http://ftp.debian.org/debian trixie main contrib</span></span><br><span class="line">deb https://mirrors.ustc.edu.cn/debian/ trixie main contrib non-free non-free-firmware</span><br><span class="line"></span><br><span class="line"><span class="comment"># deb http://ftp.debian.org/debian trixie-updates main contrib</span></span><br><span class="line">deb https://mirrors.ustc.edu.cn/debian/ trixie-updates main contrib non-free non-free-firmware</span><br><span class="line"></span><br><span class="line">deb https://mirrors.ustc.edu.cn/debian/ trixie-backports main contrib non-free non-free-firmware</span><br><span class="line"><span class="comment"># security updates</span></span><br><span class="line"><span class="comment"># deb http://security.debian.org trixie-security main contrib</span></span><br><span class="line">deb https://mirrors.ustc.edu.cn/debian-security trixie-security main contrib non-free non-free-firmware</span><br></pre></td></tr></table></figure><h2 id="替换PVE软件源">4.2 &nbsp&nbsp<a href="#替换PVE软件源" class="headerlink" title="替换PVE软件源"></a>替换PVE软件源</h2><p>删除pve-enterprise.list，新建pve-no-subscription.list，参照如下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> /etc/apt/sources.list.d/pve-enterprise.list /etc/apt/sources.list.d/pve-enterprise.list.bak</span><br><span class="line"><span class="built_in">echo</span> deb https://mirrors.ustc.edu.cn/proxmox/debian/pve trixie pve-no-subscription &gt; /etc/apt/sources.list.d/pve-no-subscription.list</span><br></pre></td></tr></table></figure><h2 id="替换CEPH分布式源">4.3 &nbsp&nbsp<a href="#替换CEPH分布式源" class="headerlink" title="替换CEPH分布式源"></a>替换CEPH分布式源</h2><p>修改<code>/etc/apt/sources.list.d/ceph.list</code>和<code>/usr/share/perl5/PVE/CLI/pveceph.pm</code>文件内容。<code>pveceph.pm</code>推荐是更新系统之后再操作，否则更新系统之后<code>pveceph.pm</code>会覆盖回默认的域名<code>http://download.proxmox.com</code>。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> /etc/apt/sources.list.d/ceph.list /etc/apt/sources.list.d/ceph.list.bak</span><br><span class="line"><span class="built_in">echo</span> deb https://mirrors.ustc.edu.cn/proxmox/debian/ceph-squid trixie no-subscription &gt; /etc/apt/sources.list.d/ceph.list</span><br><span class="line"></span><br><span class="line"><span class="built_in">cp</span> /usr/share/perl5/PVE/CLI/pveceph.pm /usr/share/perl5/PVE/CLI/pveceph.pm.bak</span><br><span class="line">sed -i <span class="string">&quot;s#http://download.proxmox.com#https://mirrors.ustc.edu.cn/proxmox#g&quot;</span> /usr/share/perl5/PVE/CLI/pveceph.pm</span><br></pre></td></tr></table></figure><h1 id="开始正式升级（8-x-9-x）">5 &nbsp&nbsp<a href="#开始正式升级（8-x-9-x）" class="headerlink" title="开始正式升级（8.x-&gt;9.x）"></a>开始正式升级（8.x-&gt;9.x）</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt update &amp;&amp; apt dist-upgrade -y</span><br></pre></td></tr></table></figure><div class="note info no-icon"><p>升级若遇到提示<code>Upgrade wants to remove package &#39;proxmox-ve&#39;</code>的话，在升级前尝试执行<code>apt remove linux-image-amd64</code>。</p></div><p>升级中会出现一些交互界面，下面是官网的建议（不清楚的选项，可以选择推荐参数）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">/etc/issue -&gt; Proxmox VE will auto-generate this file on boot, and it has only cosmetic effects on the login console.</span><br><span class="line">Using the default <span class="string">&quot;No&quot;</span> (keep your currently-installed version) is safe here.</span><br><span class="line"></span><br><span class="line">/etc/lvm/lvm.conf -&gt; Changes relevant <span class="keyword">for</span> Proxmox VE will be updated, and a newer config version might be useful.</span><br><span class="line">If you did not make extra changes yourself and are unsure it<span class="string">&#x27;s suggested to choose &quot;Yes&quot; (install the package maintainer&#x27;</span>s version) here.</span><br><span class="line"></span><br><span class="line">/etc/ssh/sshd_config -&gt; If you have not changed this file manually, the only differences should be a replacement of ChallengeResponseAuthentication no with KbdInteractiveAuthentication no and some irrelevant changes <span class="keyword">in</span> comments (lines starting with <span class="comment">#).</span></span><br><span class="line">If this is the <span class="keyword">case</span>, both options are safe, though we would recommend installing the package maintainer<span class="string">&#x27;s version in order to move away from the deprecated ChallengeResponseAuthentication option. If there are other changes, we suggest to inspect them closely and decide accordingly.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/etc/default/grub -&gt; Here you may want to take special care, as this is normally only asked for if you changed it manually, e.g., for adding some kernel command line option.</span></span><br><span class="line"><span class="string">It&#x27;</span>s recommended to check the difference <span class="keyword">for</span> any relevant change, note that changes <span class="keyword">in</span> comments (lines starting with <span class="comment">#) are not relevant.</span></span><br><span class="line">If unsure, we suggested to selected <span class="string">&quot;No&quot;</span> (keep your currently-installed version)</span><br><span class="line"></span><br><span class="line">/etc/chrony/chrony.conf -&gt; If you made <span class="built_in">local</span> changes you might want to move them out of the global config into the conf.d or, <span class="keyword">for</span> custom <span class="keyword">time</span> sources, the sources.d folder.</span><br><span class="line">See the /etc/chrony/conf.d/README and /etc/chrony/sources.d/README files on your system <span class="keyword">for</span> detaily.</span><br><span class="line">If you did not make extra changes yourself and are unsure it<span class="string">&#x27;s suggested to choose &quot;Yes&quot; (install the package maintainer&#x27;</span>s version) here.</span><br></pre></td></tr></table></figure><p>以下是实操选择的参数：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">Configuration file <span class="string">&#x27;/etc/issue&#x27;</span></span><br><span class="line"> ==&gt; Modified (by you or by a script) since installation.</span><br><span class="line"> ==&gt; Package distributor has shipped an updated version.</span><br><span class="line">   What would you like to <span class="keyword">do</span> about it ?  Your options are:</span><br><span class="line">    Y or I  : install the package maintainer<span class="string">&#x27;s version</span></span><br><span class="line"><span class="string">    N or O  : keep your currently-installed version</span></span><br><span class="line"><span class="string">      D     : show the differences between the versions</span></span><br><span class="line"><span class="string">      Z     : start a shell to examine the situation</span></span><br><span class="line"><span class="string"> The default action is to keep your current version.</span></span><br><span class="line"><span class="string">*** issue (Y/I/N/O/D/Z) [default=N] ?</span></span><br><span class="line"><span class="string">输入N回车</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Configuring libc6:amd64 ├────────────────────────────────────────────┐</span></span><br><span class="line"><span class="string"> │                                                                                                                   │</span></span><br><span class="line"><span class="string"> │ There are services installed on your system which need to be restarted when certain libraries, such as libpam,    │</span></span><br><span class="line"><span class="string"> │ libc, and libssl, are upgraded. Since these restarts may cause interruptions of service for the system, you will  │</span></span><br><span class="line"><span class="string"> │ normally be prompted on each upgrade for the list of services you wish to restart.  You can choose this option    │</span></span><br><span class="line"><span class="string"> │ to avoid being prompted; instead, all necessary restarts will be done for you automatically so you can avoid      │</span></span><br><span class="line"><span class="string"> │ being asked questions on each library upgrade.                                                                    │</span></span><br><span class="line"><span class="string"> │                                                                                                                   │</span></span><br><span class="line"><span class="string"> │ Restart services during package upgrades without asking?                                                          │</span></span><br><span class="line"><span class="string"> │                                                                                                                   │</span></span><br><span class="line"><span class="string"> │                                  &lt;Yes&gt;                                     &lt;No&gt;                                   │</span></span><br><span class="line"><span class="string"> │                                                                                                                   │</span></span><br><span class="line"><span class="string"> └───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘</span></span><br><span class="line"><span class="string">选择Yes回车</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Configuration file &#x27;</span>/etc/lvm/lvm.conf<span class="string">&#x27;</span></span><br><span class="line"><span class="string"> ==&gt; Modified (by you or by a script) since installation.</span></span><br><span class="line"><span class="string"> ==&gt; Package distributor has shipped an updated version.</span></span><br><span class="line"><span class="string">   What would you like to do about it ?  Your options are:</span></span><br><span class="line"><span class="string">    Y or I  : install the package maintainer&#x27;</span>s version</span><br><span class="line">    N or O  : keep your currently-installed version</span><br><span class="line">      D     : show the differences between the versions</span><br><span class="line">      Z     : start a shell to examine the situation</span><br><span class="line"> The default action is to keep your current version.</span><br><span class="line">*** lvm.conf (Y/I/N/O/D/Z) [default=N] ?</span><br><span class="line">输入Y回车</span><br></pre></td></tr></table></figure><h1 id="屏蔽PVE-9-x企业源pve-enterprise-sources">6 &nbsp&nbsp<a href="#屏蔽PVE-9-x企业源pve-enterprise-sources" class="headerlink" title="屏蔽PVE 9.x企业源pve-enterprise.sources"></a>屏蔽PVE 9.x企业源<code>pve-enterprise.sources</code></h1><p>成功升级至PVE 9.x之后，会自动生成一个<code>DEB822</code>格式的企业源<code>pve-enterprise.sources</code>文件，需要手动屏蔽它，否则WEB后台和<code>apt update</code>会有提示。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> /etc/apt/sources.list.d/pve-enterprise.sources /etc/apt/sources.list.d/pve-enterprise.sources.bak</span><br><span class="line">apt update</span><br></pre></td></tr></table></figure><h1 id="移除无用的包">7 &nbsp&nbsp<a href="#移除无用的包" class="headerlink" title="移除无用的包"></a>移除无用的包</h1><p>运行如下如下命令，移除无用的包，节省服务器空间：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt autoremove</span><br></pre></td></tr></table></figure><div class="flex-column"><img data-src="/images/software/pve/apt-auto-remove.webp">移除无用的包</div><h1 id="替换LXC模板（CT-Templates）镜像源">8 &nbsp&nbsp<a href="#替换LXC模板（CT-Templates）镜像源" class="headerlink" title="替换LXC模板（CT Templates）镜像源"></a>替换LXC模板（CT Templates）镜像源</h1><p>修改<code>/usr/share/perl5/PVE/APLInfo.pm</code>文件内容，<strong>针对 <code>/usr/share/perl5/PVE/APLInfo.pm</code> 文件的修改，执行<code>systemctl restart pvedaemon</code>后生效。</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> /usr/share/perl5/PVE/APLInfo.pm /usr/share/perl5/PVE/APLInfo.pm.bak</span><br><span class="line">sed -i <span class="string">&quot;s#http://download.proxmox.com/images#https://mirrors.ustc.edu.cn/proxmox/images#g&quot;</span> /usr/share/perl5/PVE/APLInfo.pm</span><br></pre></td></tr></table></figure><h1 id="去除PVE未订阅提示">9 &nbsp&nbsp<a href="#去除PVE未订阅提示" class="headerlink" title="去除PVE未订阅提示"></a>去除PVE未订阅提示</h1><p><strong>完成如下文件内容修改后，注销浏览器当前的PVE登录信息，并重新登录就没有提示弹窗了。实测PVE 9.x版本执行该方法之后，WEB后台的「软件包版本」按钮无法响应，暂未排查到问题，后面有时间再跟进。</strong></p><ul><li><code>/usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js</code></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js.bak</span><br><span class="line">sed -i <span class="string">&quot;s/if (res === null || res === undefined || \!res || res/if(/g&quot;</span> /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js</span><br><span class="line">sed -i <span class="string">&quot;s/.data.status.toLowerCase() !== &#x27;active&#x27;/false/g&quot;</span> /usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js</span><br><span class="line">systemctl restart pveproxy</span><br></pre></td></tr></table></figure><div class="flex-column"><img data-src="/images/software/pve/pve-no-subscribe.webp">「无有效订阅」的提示弹窗</div><h1 id="后续PVE系统日常更新：">10 &nbsp&nbsp<a href="#后续PVE系统日常更新：" class="headerlink" title="后续PVE系统日常更新："></a>后续PVE系统日常更新：</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt update &amp;&amp; apt dist-upgrade -y</span><br></pre></td></tr></table></figure><h1 id="后记">11 &nbsp&nbsp<a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>以下就是升级到最新的PVE 9.x版本的WEB后台界面了。</p><div class="flex-column"><img data-src="/images/software/pve/pve9x-web-control.webp">PVE 9.x的WEB后台界面</div><h1 id="参考文献">12 &nbsp&nbsp<a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p>[1] Upgrade from 8 to 9[EB&#x2F;OL]. <a href="https://pve.proxmox.com/wiki/Upgrade_from_8_to_9">https://pve.proxmox.com/wiki/Upgrade_from_8_to_9</a>.<br>[2] Proxmox[EB&#x2F;OL]. <a href="https://mirrors.ustc.edu.cn/help/proxmox.html">https://mirrors.ustc.edu.cn/help/proxmox.html</a>.</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;1 &amp;nbsp&amp;nbsp&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;企业软件开发商&lt;code&gt;Proxmox Server Solutions</summary>
        
      
    
    
    
    <category term="post-articles" scheme="https://mister-kin.github.io/categories/post-articles/"/>
    
    <category term="2025-10" scheme="https://mister-kin.github.io/categories/post-articles/2025-10/"/>
    
    
    <category term="虚拟化系统" scheme="https://mister-kin.github.io/tags/%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F/"/>
    
    <category term="HomeLab" scheme="https://mister-kin.github.io/tags/HomeLab/"/>
    
    <category term="PVE" scheme="https://mister-kin.github.io/tags/PVE/"/>
    
    <category term="升级" scheme="https://mister-kin.github.io/tags/%E5%8D%87%E7%BA%A7/"/>
    
    <category term="Proxmox" scheme="https://mister-kin.github.io/tags/Proxmox/"/>
    
    <category term="服务器" scheme="https://mister-kin.github.io/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>飞牛fnOS影视刮削的文件命名技巧</title>
    <link href="https://mister-kin.github.io/post-articles/2025-10/video-scraping-renaming-for-fnos/"/>
    <id>https://mister-kin.github.io/post-articles/2025-10/video-scraping-renaming-for-fnos/</id>
    <published>2025-10-29T13:46:47.000Z</published>
    <updated>2025-10-30T08:52:56.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言">1 &nbsp&nbsp<a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>使用飞牛影视有一段日子了，整体感觉上还行，数据刮削算是比较省心，今天抽空来聊聊我在这方面的经验。</p><h1 id="一般的影视刮削的文件命名规则">2 &nbsp&nbsp<a href="#一般的影视刮削的文件命名规则" class="headerlink" title="一般的影视刮削的文件命名规则"></a>一般的影视刮削的文件命名规则</h1><p><strong>以下规则不仅适用于飞牛影视，同样可应用于Emby、Jellyfin等媒体系统工具。</strong></p><h2 id="电影类型">2.1 &nbsp&nbsp<a href="#电影类型" class="headerlink" title="电影类型"></a>电影类型</h2><p>一般电影本身就是单个文件，文件命名规则：影视名称+年份。像这样保留原有的电影名称和对应年份时，即使遇到同名的电影，刮削上基本不会出现问题。示例：<code>星际穿越Interstellar.2014.mkv</code>。</p><h2 id="动漫番剧和电视剧类型">2.2 &nbsp&nbsp<a href="#动漫番剧和电视剧类型" class="headerlink" title="动漫番剧和电视剧类型"></a>动漫番剧和电视剧类型</h2><p>动漫番剧和电视剧，这种可能存在多季多集的情况，推荐按<code>季</code>分别创建一个文件夹存放每一季的文件。文件命名规则：影视名称+对应的每季每集。示例<code>夏目友人帐.S01.E01.mkv</code>或者<code>夏目友人帐.S01E01.mkv</code>。父文件夹命名为：<code>夏目友人帐.S01</code>。</p><p>我个人是喜欢使用<code>.</code>符号作为分隔符，方便快速阅览辨识。</p><h2 id="动漫番剧的特别篇">2.3 &nbsp&nbsp<a href="#动漫番剧的特别篇" class="headerlink" title="动漫番剧的特别篇"></a>动漫番剧的特别篇</h2><p>特别篇比较特殊，大部分情况可能需要人工校正刮削的数据。</p><p>目前我是将<code>SP</code>、<code>OVA</code>、<code>OAD</code>这些全都归入为特别篇类型，然后根据<code>季</code>的数量来判断使用不同的命名规则。为什么这样处理呢？因为飞牛影视的手动匹配逻辑，特别篇就只能输入<code>0</code>作为一个季。而多季多集的特别篇就不适用于这种逻辑。</p><div class="flex-column"><img data-src="/images/post-articles/2025-10/video-scraping-renaming-for-fnos/manual-scraping.webp">手动刮削匹配界面-影视匹配</div><h3 id="特别篇只有一季的情况">2.3.1 &nbsp&nbsp<a href="#特别篇只有一季的情况" class="headerlink" title="特别篇只有一季的情况"></a>特别篇只有一季的情况</h3><p>只有一季时，命名时就无需带入<code>季</code>的编号，只保留番剧名称和特别篇标识缩写即可，示例：<code>紫罗兰永恒花园.OVA.mp4</code>或者<code>紫罗兰永恒花园.OVA.一定会理解「爱」的真谛.mp4</code>。</p><div class="flex-row"><div class="flex-column"><img data-src="/images/post-articles/2025-10/video-scraping-renaming-for-fnos/voilet.webp">紫罗兰永恒花园-刮削效果</div><div class="flex-column"><img data-src="/images/post-articles/2025-10/video-scraping-renaming-for-fnos/voilet-details.webp">紫罗兰永恒花园-特别篇详情</div></div><h3 id="特别篇有多季的情况">2.3.2 &nbsp&nbsp<a href="#特别篇有多季的情况" class="headerlink" title="特别篇有多季的情况"></a>特别篇有多季的情况</h3><p>因为我个人喜欢按季存放对应的特别篇文件，每季的特别篇的文件集数编号都是按最后一集顺延+1编号，例如夏目友人帐第五季的特别篇，示例命名：<code>夏目友人帐.S05.E12.OVA1.mkv</code>。</p><p>其实IMDB网站上的数据，特别篇也是按最后一集顺延+1编号。</p><div class="flex-row"><div class="flex-column"><img data-src="/images/post-articles/2025-10/video-scraping-renaming-for-fnos/natsume.webp">夏目友人帐第五季-刮削效果</div><div class="flex-column"><img data-src="/images/post-articles/2025-10/video-scraping-renaming-for-fnos/natsume-details.webp">夏目友人帐第五季-特别篇1详情</div></div><div class="flex-column"><img data-src="/images/post-articles/2025-10/video-scraping-renaming-for-fnos/natsume-imdb.webp">IMDB网站数据-夏目友人帐第五季</div><h2 id="外挂字幕文件类型">2.4 &nbsp&nbsp<a href="#外挂字幕文件类型" class="headerlink" title="外挂字幕文件类型"></a>外挂字幕文件类型</h2><p>文件命名规则：字幕文件名保持与视频文件同名，最后加上分隔符和字幕语言类型。以下简单介绍几种语言类型：</p><ul><li>简体中文：推荐<code>chs</code>，不推荐<code>sc</code>，可能被识别成撒丁语，示例：<code>夏目友人帐.S01.E01.chs.ass</code></li><li>繁体中文：推荐<code>cht</code>，不推荐<code>tc</code>，可能被识别成und，示例：<code>夏目友人帐.S01.E01.cht.ass</code></li><li>日文：推荐<code>jap</code>，示例：<code>夏目友人帐.S01.E01.jap.ass</code></li><li>简中日文双语：示例：<code>夏目友人帐.S01.E01.chs&amp;jap.ass</code></li></ul><h1 id="批量重命名工具：PowerRename">3 &nbsp&nbsp<a href="#批量重命名工具：PowerRename" class="headerlink" title="批量重命名工具：PowerRename"></a>批量重命名工具：PowerRename</h1><p>文件管理少不了文件重命名，这里推荐一个工具<code>PowerRename</code>，该工具支持正则表达式。该工具是<code>PowerToys</code>的内置工具，仅适用于Windows平台。</p><p>安装方法：</p><ol><li>打开Windows系统的微软商店。</li><li>搜索安装<code>PowerToys</code></li><li>打开<code>PowerToys</code>界面并确保启用<code>PowerRename</code>，这样Windows中的右键菜单上下文就出现<code>PowerRename</code>选项了。</li></ol><div class="flex-row"><div class="flex-column"><img data-src="/images/post-articles/2025-10/video-scraping-renaming-for-fnos/powertoys.webp">微软商店界面-PowerToys</div><div class="flex-column"><img data-src="/images/post-articles/2025-10/video-scraping-renaming-for-fnos/powertoys-enable-powerrename.webp">PowerToys启用PowerRename</div></div><div class="flex-column"><img data-src="/images/post-articles/2025-10/video-scraping-renaming-for-fnos/right-click-menu.webp">右键菜单-PowerRename</div><h1 id="PowerRename的命名规则">4 &nbsp&nbsp<a href="#PowerRename的命名规则" class="headerlink" title="PowerRename的命名规则"></a>PowerRename的命名规则</h1><p>示例编码：<code>夏目友人帐.S05.E${increment=1,padding=2,start=1}</code>，示例图片中的<code>.*</code>是正则表达式，代表匹配所有任意字符。</p><p>这里简单介绍自动编号的规则：<code>${}</code>是属于高级计数器语法，<code>increment=1</code>代表每次增长1；<code>padding=2</code>代表自动使用前导零数填充为两位，例如数字1自动填充为<code>01</code>，当增长超过两位数时，例如三位数则不受限于该规则；<code>start=1</code>代表从1开始。</p><p>PowerRename的详细使用方法和语法规则可参阅：<a href="https://learn.microsoft.com/zh-cn/windows/powertoys/powerrename">PowerRename 实用工具 Windows</a></p><div class="flex-column"><img data-src="/images/post-articles/2025-10/video-scraping-renaming-for-fnos/powerraname.webp">PowerRename示例编码</div><h1 id="内容延伸：影视文件常见命名缩写含义">5 &nbsp&nbsp<a href="#内容延伸：影视文件常见命名缩写含义" class="headerlink" title="内容延伸：影视文件常见命名缩写含义"></a>内容延伸：影视文件常见命名缩写含义</h1><ul><li>S1: season1, 第一季</li><li>E1&#x2F;EP1: episode1, 第一集</li><li>SP: special, 特别篇</li><li>OVA: Original Video Animation, 原创动画录影带</li><li>OAD: Original Animation Disc, 原创动画光碟</li><li>OST: Original Soundtrack, 影视原声集</li><li>HD: Hign Definition, 高清</li><li>BD: Blu-ray Disc, 蓝光</li><li>X264&#x2F;HEVC: h264&#x2F;h265视频编码</li><li>AAC: 音频编码</li><li>CHS&#x2F;CHT&#x2F;JAP: 简体中文&#x2F;繁体中文字幕&#x2F;日文字幕</li><li>Director’s Cut: 导演剪辑版</li><li>On Air: TV版（电视节目或者动画播出时的版本）</li><li>Unrated: 未分级版</li><li>Extended: 加长版</li></ul><h1 id="参考文献">6 &nbsp&nbsp<a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p>[1] 万剑归宗之刮削大法！史上最全从Emby命名规则到刮削设置一条龙图文教程！[EB&#x2F;OL]. <a href="https://post.smzdm.com/p/aox8wp36/">https://post.smzdm.com/p/aox8wp36/</a>.<br>[2] 电影电视剧动漫 标准命名规则，jellfin、emby、kodi都适用[EB&#x2F;OL]. <a href="https://www.shejibiji.com/archives/8295">https://www.shejibiji.com/archives/8295</a>.</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;1 &amp;nbsp&amp;nbsp&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;使用飞牛影视有一段日子了，整体感觉上还行，数据刮削算是比较省心，今天抽空来聊聊我在这方面的经验。&lt;/p&gt;
&lt;h1</summary>
        
      
    
    
    
    <category term="post-articles" scheme="https://mister-kin.github.io/categories/post-articles/"/>
    
    <category term="2025-10" scheme="https://mister-kin.github.io/categories/post-articles/2025-10/"/>
    
    
    <category term="fnOS" scheme="https://mister-kin.github.io/tags/fnOS/"/>
    
    <category term="飞牛" scheme="https://mister-kin.github.io/tags/%E9%A3%9E%E7%89%9B/"/>
    
    <category term="影视刮削" scheme="https://mister-kin.github.io/tags/%E5%BD%B1%E8%A7%86%E5%88%AE%E5%89%8A/"/>
    
    <category term="命名规则" scheme="https://mister-kin.github.io/tags/%E5%91%BD%E5%90%8D%E8%A7%84%E5%88%99/"/>
    
    <category term="技巧" scheme="https://mister-kin.github.io/tags/%E6%8A%80%E5%B7%A7/"/>
    
  </entry>
  
  <entry>
    <title>USB千兆网卡评测-Airsky USB-C/USB-A外置网卡</title>
    <link href="https://mister-kin.github.io/post-articles/2025-10/airsky-usb-c-usb-a-gigabit-ethernet-adapter-review/"/>
    <id>https://mister-kin.github.io/post-articles/2025-10/airsky-usb-c-usb-a-gigabit-ethernet-adapter-review/</id>
    <published>2025-10-27T15:14:58.000Z</published>
    <updated>2025-10-27T18:41:26.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言">1 &nbsp&nbsp<a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>前段时间从某宝上淘了一个USB外置网卡（USB C&#x2F;USB A二合一接口），整体使用体验还行，因此抽空写一下评测。</p><h1 id="产品包装">2 &nbsp&nbsp<a href="#产品包装" class="headerlink" title="产品包装"></a>产品包装</h1><p>外包装盒子比较简单，全英文描述。Made in China，中国生产，但商品编码是非国内常见69码，我推测这个商品原计划是用于出口的，不知道为啥在某宝上流通这个商品。</p><div class="flex-row"><div class="flex-column"><img data-src="/images/post-articles/2025-10/airsky-usb-c-usb-a-gigabit-ethernet-adapter-review/packaging-box-front.webp">包装盒正面</div><div class="flex-column"><img data-src="/images/post-articles/2025-10/airsky-usb-c-usb-a-gigabit-ethernet-adapter-review/packaging-box-back.webp">包装盒背面</div></div><h1 id="产品外观">3 &nbsp&nbsp<a href="#产品外观" class="headerlink" title="产品外观"></a>产品外观</h1><p>该网卡总共有3个接口：RJ45接口+USB-C (Type-C)接口+USB-A接口。RJ45接口另一头默认是USB-C接口，该接口可以作为中间接口，拼接USB-A接口，即二合一。</p><p>USB-C (Type-C)接口和USB-A接口，塑料外壳设计上就是相连起来，这点好评。如果是分离接口设计的话，日常使用过程中可能会丢失。</p><p>产品中间线长大约为12厘米，二合一拼接起来产品全长约为21.5厘米。</p><div class="flex-row"><div class="flex-column"><img data-src="/images/post-articles/2025-10/airsky-usb-c-usb-a-gigabit-ethernet-adapter-review/product.webp">产品外观</div><div class="flex-column"><img data-src="/images/post-articles/2025-10/airsky-usb-c-usb-a-gigabit-ethernet-adapter-review/product-length.webp">产品长度</div></div><h1 id="网卡芯片">4 &nbsp&nbsp<a href="#网卡芯片" class="headerlink" title="网卡芯片"></a>网卡芯片</h1><p>将网卡接入Windows系统中，通过设备管理器可以查询到硬件ID为<code>USB\VID_0BDA&amp;PID_8153&amp;REV_3100</code>。通过硬件ID网站查询可知，该网卡内置芯片为瑞昱Realtek的RTL8153芯片。</p><p>在瑞昱Realtek官网查询可知，该芯片是一个千兆以太网适配器，可以自适应协商速率<code>10/100/1000M</code>。</p><div class="flex-row"><div class="flex-column"><img data-src="/images/post-articles/2025-10/airsky-usb-c-usb-a-gigabit-ethernet-adapter-review/hardware-id.webp">硬件ID</div><div class="flex-column"><img data-src="/images/post-articles/2025-10/airsky-usb-c-usb-a-gigabit-ethernet-adapter-review/hardware-id-result.webp">硬件ID查询结果</div><div class="flex-column"><img data-src="/images/post-articles/2025-10/airsky-usb-c-usb-a-gigabit-ethernet-adapter-review/realtek-website.webp">realtek网站说明</div></div><h1 id="测试性能">5 &nbsp&nbsp<a href="#测试性能" class="headerlink" title="测试性能"></a>测试性能</h1><h2 id="Windows平台测试">5.1 &nbsp&nbsp<a href="#Windows平台测试" class="headerlink" title="Windows平台测试"></a>Windows平台测试</h2><p>测试平台：</p><ul><li>Windows 11 Pro 25H2：26200.6901</li><li>iperf3：3.19.1</li></ul><p>Windows中使用<code>iperf3</code>工具测试局域网速率，分别对USB-C接口和USB-A接口进行测试，结果一致为<code>950Mbps</code>，可见转接使用USB-A接口时也不会影响速率。考虑网络传输的开销（例如IP头部信息，TCP头部信息等），<code>950Mbps</code>算是发挥了RTL8153芯片原有的性能。</p><p>其他配置项目跟普通网卡一致，没啥区别。</p><div class="flex-row"><div class="flex-column"><img data-src="/images/post-articles/2025-10/airsky-usb-c-usb-a-gigabit-ethernet-adapter-review/iperf3-windows-usbc.webp">iperf3测速(USB-C接口)</div><div class="flex-column"><img data-src="/images/post-articles/2025-10/airsky-usb-c-usb-a-gigabit-ethernet-adapter-review/iperf3-windows-usba.webp">iperf3测速(USB-A接口)</div></div><h2 id="Android手机平台">5.2 &nbsp&nbsp<a href="#Android手机平台" class="headerlink" title="Android手机平台"></a>Android手机平台</h2><p>测试平台：</p><ul><li>手机：GT NEO 3 RMX3560</li><li>Android：14</li><li>iperf3：CloudCampus APP内置的iperf3工具</li></ul><p>关闭移动数据和WiFi，将网卡通过USB-C接口接入到手机中，打开开发者选项查看可知，手机是通过<code>RNDIS</code>方式（USB以太网，通过USB设备模拟为以太网接口）完成驱动适配的。通过<code>termux</code>应用查看IP，可看到该USB网卡也正常获取分配下来的IP。</p><p>但手机的<code>realme UI 5.0</code>系统本身并未提供修改USB网卡的IP分配方式的入口，这点比较可惜，这意味着没法设置为手动固定IP。因为手机也并未解锁BL获取ROOT权限，因此也没法通过<code>termux</code>设置IP这种系统相关参数。</p><div class="flex-row"><div class="flex-column"><img data-src="/images/post-articles/2025-10/airsky-usb-c-usb-a-gigabit-ethernet-adapter-review/test-phone.webp">手机版本</div><div class="flex-column"><img data-src="/images/post-articles/2025-10/airsky-usb-c-usb-a-gigabit-ethernet-adapter-review/test-phone-driver.webp">手机USB网卡驱动方式</div><div class="flex-column"><img data-src="/images/post-articles/2025-10/airsky-usb-c-usb-a-gigabit-ethernet-adapter-review/test-phone-ip.webp">手机USB网卡IP</div></div><p>Android手机测速结果为<code>304Mbps</code>。</p><p>对的，你没看错，测试用的<code>GT NEO 3</code>手机就只能跑到这个速率，不知道是系统上的限制还是联发科芯片的问题。为什么这样说呢？因为我额外找过朋友拿一个高通芯片的手机测试，网卡测速是能上到九百兆的。以后买手机，还是尽量买高通芯片吧。</p><div class="flex-column"><img data-src="/images/post-articles/2025-10/airsky-usb-c-usb-a-gigabit-ethernet-adapter-review/iperf3-android.webp">iperf3测速-Android</div><h1 id="总结">6 &nbsp&nbsp<a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>经常有调试网络设备的需求的朋友，可以考虑入手一个这样的USB网卡产品。</p><p>大部分普通的调试需求，只需要带个手机+USB网卡就行，十分地轻松便捷。</p><p>若手机有ROOT权限更佳，完全可以替代电脑进行调试工作，包括可以调整IP分配方式。</p><p>手机若没有ROOT，调试场景就比较受限，只推荐接入到已开启DHCP服务器的局域网中，这样也能避开手机无法手动设置固定IP的问题。</p><h1 id="参考文献">7 &nbsp&nbsp<a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p>[1] Realtek USB FE &#x2F; GbE &#x2F; 2.5GbE &#x2F; 5G &#x2F; 10G Family Controller Software[EB&#x2F;OL]. <a href="https://www.realtek.com/Download/List?cate_id=585">https://www.realtek.com/Download/List?cate_id=585</a>.<br>[2] devicehunt[EB&#x2F;OL]. <a href="https://devicehunt.com/view/type/usb/vendor/0BDA/device/8153">https://devicehunt.com/view/type/usb/vendor/0BDA/device/8153</a>.</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;1 &amp;nbsp&amp;nbsp&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;前段时间从某宝上淘了一个USB外置网卡（USB C&amp;#x2F;USB</summary>
        
      
    
    
    
    <category term="post-articles" scheme="https://mister-kin.github.io/categories/post-articles/"/>
    
    <category term="2025-10" scheme="https://mister-kin.github.io/categories/post-articles/2025-10/"/>
    
    
    <category term="Airsky" scheme="https://mister-kin.github.io/tags/Airsky/"/>
    
    <category term="USB网卡" scheme="https://mister-kin.github.io/tags/USB%E7%BD%91%E5%8D%A1/"/>
    
    <category term="外置网卡" scheme="https://mister-kin.github.io/tags/%E5%A4%96%E7%BD%AE%E7%BD%91%E5%8D%A1/"/>
    
    <category term="评测" scheme="https://mister-kin.github.io/tags/%E8%AF%84%E6%B5%8B/"/>
    
    <category term="千兆" scheme="https://mister-kin.github.io/tags/%E5%8D%83%E5%85%86/"/>
    
  </entry>
  
  <entry>
    <title>飞牛fnOS调整AutoBangumi参数，以适配国内直连域名订阅mikanime.tv</title>
    <link href="https://mister-kin.github.io/post-articles/2025-10/auto-bangumi-set-mikanimetv-for-fnos/"/>
    <id>https://mister-kin.github.io/post-articles/2025-10/auto-bangumi-set-mikanimetv-for-fnos/</id>
    <published>2025-10-26T10:33:33.000Z</published>
    <updated>2025-10-26T19:54:39.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言">1 &nbsp&nbsp<a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>mikan站点目前是根据访问IP地区跳转域名，大陆IP是访问<code>mikanime.tv</code>域名，其他IP是访问<code>mikanani.me</code>域名。</p><p>在飞牛fnOS的应用中心上安装<code>AutoBangumi</code>，使用<code>mikanime.tv</code>域名的订阅链接进行下载时，会发现在<code>AutoBangumi</code>的日志中发现这样的警告信息<code>[Network] Failed to get torrents: https://mikanani.me/RSS/xxxxxx</code>。</p><p>很奇怪对吧！明明填写的是<code>mikanime.tv</code>域名的订阅链接，但是日志却是提示无法从<code>mikanani.me</code>域名链接中获取磁力呢？</p><p>原因是<code>AutoBangumi</code>的磁力搜索功能是根据<code>config/search_provider.json</code>中的url参数实现的，而该配置文件的参数默认为<code>mikanani.me</code>域名的url。</p><h1 id="配置方法">2 &nbsp&nbsp<a href="#配置方法" class="headerlink" title="配置方法"></a>配置方法</h1><p>测试版本：</p><ul><li>飞牛版本：fnOS 0.9.32</li><li>AutoBangumi版本：3.1.18</li></ul><p>在<code>文件管理</code>应用中找到<code>AutoBangumi</code>的应用配置文件：<code>存储空间1/应用文件/AutoBangumi/config/search_provider.json</code>，对应的原始路径是<code>/vol1/@appshare/AutoBangumi/config/search_provider.json</code>。</p><p>使用<code>文本编辑器</code>应用打开并编辑文件内容（确保已经提前在<code>应用中心</code>安装<code>文本编辑器</code>）：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;mikan&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://mikanani.me/RSS/Search?searchstr=%s&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;nyaa&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://nyaa.si/?page=rss&amp;q=%s&amp;c=0_0&amp;f=0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;dmhy&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://dmhy.org/topics/rss/rss.xml?keyword=%s&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>将<code>mikan</code>的域名从<code>mikanani.me</code>更改为<code>mikanime.tv</code>：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;mikan&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://mikanime.tv/RSS/Search?searchstr=%s&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;nyaa&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://nyaa.si/?page=rss&amp;q=%s&amp;c=0_0&amp;f=0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;dmhy&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://dmhy.org/topics/rss/rss.xml?keyword=%s&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><div class="flex-row"><div class="flex-column"><img data-src="/images/post-articles/2025-10/auto-bangumi-set-mikanimetv-for-fnos/config-path.webp">配置路径</div><div class="flex-column"><img data-src="/images/post-articles/2025-10/auto-bangumi-set-mikanimetv-for-fnos/config-file.webp">配置文件</div></div><p>P.S. 如果局域网网络整体被梯子代理的话，记得将飞牛fnOS的系统IP分流出去，不然处于代理状态下，配置了<code>mikanime.tv</code>也会自动跳转到<code>mikanani.me</code>。</p><h1 id="参考文献">3 &nbsp&nbsp<a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p>[1] [错误报告]RSS订阅为国内域名(mikanime.tv)，但torrent获取仍为mikanime.me，以致出现网络连接失败问题[EB&#x2F;OL]. <a href="https://github.com/EstrellaXD/Auto_Bangumi/issues/804">https://github.com/EstrellaXD/Auto_Bangumi/issues/804</a>.<br>[2] 网络问题[EB&#x2F;OL]. <a href="https://www.autobangumi.org/faq/network.html">https://www.autobangumi.org/faq/network.html</a>.</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;1 &amp;nbsp&amp;nbsp&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot;</summary>
        
      
    
    
    
    <category term="post-articles" scheme="https://mister-kin.github.io/categories/post-articles/"/>
    
    <category term="2025-10" scheme="https://mister-kin.github.io/categories/post-articles/2025-10/"/>
    
    
    <category term="fnOS" scheme="https://mister-kin.github.io/tags/fnOS/"/>
    
    <category term="飞牛" scheme="https://mister-kin.github.io/tags/%E9%A3%9E%E7%89%9B/"/>
    
    <category term="AutoBangumi" scheme="https://mister-kin.github.io/tags/AutoBangumi/"/>
    
    <category term="mikan" scheme="https://mister-kin.github.io/tags/mikan/"/>
    
  </entry>
  
</feed>
